bug_report_id,bug_report_desc,bug_report_time
WFCORE-2015,"*Description of problem:*
CLI is unable to connect to EAP with undefined security-realm

This is regression against EAP 7.0.0, 6.4.0 and 7.1.0.DR7.

*How reproducible:*
Always

*Steps to Reproduce:*
# /core-service=management/management-interface=http-interface:undefine-attribute(name=security-realm)
# reload

*Actual results:*
{noformat}
[mkopecky@dhcp-10-40-4-180 bin]$ ./jboss-cli.sh -c
[standalone@localhost:9990 /] /core-service=management/management-interface=http-interface:undefine-attribute(name=security-realm)
{
    ""outcome"" => ""success"",
    ""response-headers"" => {
        ""operation-requires-reload"" => true,
        ""process-state"" => ""reload-required""
    }
}
[standalone@localhost:9990 /] reload
Interrupted while pausing before reconnecting.: sleep interrupted
[disconnected /] 
[mkopecky@dhcp-10-40-4-180 bin]$ ./jboss-cli.sh -c
Failed to connect to the controller: Unable to authenticate against controller at localhost:9990: Authentication failed: none of the mechanisms presented by the server are supported
[mkopecky@dhcp-10-40-4-180 bin]$ 
{noformat}",2016/11/18 8:31 AM
WFCORE-2013,"When http management interface is secured with legacy security realm using ldap, user is not prompted to provide credentials as should be in case of BASIC http authentication mechanism. Instead {{403}} http status is returned directly.

Users won't be able to migrate their current (6.4, 7.0) configuration to 7.1 without change.",2016/11/18 4:47 AM
WFCORE-2009,"When configuring SSL/TLS for the management interfaces, you need to specify an (ssl-context or security-realm) and secure-socket-binding. When using ssl-context and secure-socket-binding, it fails with:

{code}
""WFLYCTL0380: Attribute 'security-realm' needs to be set or passed before attribute 'secure-socket-binding' can be correctly set""
{code}

failing operations:


{code:java}
batch

/subsystem=elytron/key-store=httpsKS:add(path=keystore.jks,relative-to=jboss.server.config.dir,credential-reference={clear-text=secret},type=JKS)

/subsystem=elytron/key-managers=httpsKM:add(key-store=httpsKS,algorithm=""SunX509"",credential-reference={clear-text=secret})

/subsystem=elytron/server-ssl-context=httpsSSC:add(key-managers=httpsKM,protocols=[""TLSv1.1""])

/core-service=management/management-interface=http-interface:write-attribute(name=ssl-context, value=httpsSSC)

/core-service=management/management-interface=http-interface:write-attribute(name=secure-socket-binding, value=management-https)

run-batch

reload
{code}


Oddly, this will pass (specifying BOTH ssl-context and security-realm):


{code:java}
batch

/subsystem=elytron/key-store=httpsKS:add(path=keystore.jks,relative-to=jboss.server.config.dir,credential-reference={clear-text=secret},type=JKS)

/subsystem=elytron/key-managers=httpsKM:add(key-store=httpsKS,algorithm=""SunX509"",credential-reference={clear-text=secret})

/subsystem=elytron/server-ssl-context=httpsSSC:add(key-managers=httpsKM,protocols=[""TLSv1.1""])

/core-service=management/management-interface=http-interface:write-attribute(name=ssl-context, value=httpsSSC)

/core-service=management/management-interface=http-interface:write-attribute(name=security-realm, value=ManagementDomain)

/core-service=management/management-interface=http-interface:write-attribute(name=secure-socket-binding, value=management-https)

run-batch

reload
{code}

",2016/11/17 3:50 PM
WFCORE-2007,"gc.log.*.current enclosed with double quotes in the following line (line 265) in standalone.sh is not evaluated as a wildcard by bash,
{code:java}
mv ""$JBOSS_LOG_DIR/gc.log.*.current"" ""$JBOSS_LOG_DIR/backupgc.log.current"" >/dev/null 2>&1
{code}
therefore standalone.sh fails to move an existing gc.log.<number>.current file to backupgc.log.current silently.",2016/11/17 8:54 AM
WFCORE-2006,PatchMerger when merging content modification for a module copies all of the module slots instead of the one actually modified. This may lead to undesired content overwrite.,2016/11/17 8:37 AM
WFCORE-2005,"Completion doesn't work properly for:
- ~XXX
- quoted paths
- paths that contain escaped white spaces
",2016/11/17 5:41 AM
WFCORE-2002,"All file options are impacted --file and --properties
",2016/11/16 12:56 PM
WFCORE-1993,"{code}
/core-service=platform-mbean:read-resource-description 
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""description"" => ""Provides the management interface for monitoring and management of the Java virtual machine as well as the operating system on which the Java virtual machine is running. Exposes the JDK-provided JMX MBeans in the java.lang, java.nio and java.util.logging JMX domains."", ...
{code}
but java.util.logging JMX domain is not available in this service.
Not exposing those mbeans is deliberate, so change the description.",2016/11/15 11:36 AM
WFCORE-1992,"CLI interprets {} as blank object in resource attribute (correct), but as UNDEFINED in object attribute. (in model parameter of *performRuntime* of ADD operation)

{code:java}
/subsystem=elytron/properties-realm=realm:add(users-properties={path=$SOME_PATH},groups-properties={})
=> groups-properties = OBJECT {}
{code}

{code:java}
/subsystem=elytron/ldap-realm=ldap-realm8:add(dir-context=local-ldap,identity-mapping={rdn-identifier=uid,otp-credential-mapper={}})
=> otp-credential-mapper=UNDEFINED
{code}",2016/11/15 9:35 AM
WFCORE-2186,"Password encryption/hash mechanisms which contain {{salt}} attribute for filesystem-realm identity cannot be added through CLI. {{set-password}} operation fails and finishes with failure-description ""WFLYCTL0155: password may not be null"" even if password was set. It seems when {{salt}} attribute with {{bytes}} value is used then {{password}} attribute is ignored by CLI.

Following password encryption/hash mechanisms from filesystem-realm identity are affected by issue:
- {{bcrypt}}
- {{salted-simple-digest}}",2016/11/15 2:19 AM
WFCORE-1985,"While {{:read-resource-description}} returns an ordered list of resources with their descriptions for most resources, some resources do not return result consistent with this (resources ordered by alphabet).

Affected resources:
* {{/subsystem=iiop-openjdk:read-resource-description()}} returns unordered list of resources and their descriptions, while {{/subsystem=iiop-openjdk:read-resource()}} returns ordered list",2016/11/14 6:25 PM
WFCORE-1983,"It happens that the CLI does a custom parsing of the value in case ModelNode.fromString fails (whatever the exception).
The issue is that the custom parsing doesn't follow the ModelNode parsing syntax and parse everything as String. So the resulting ModelNode that is serialised and sent to the server has been transformed.

I am surprised that we don't have more of such failures. For example, when numbers are located inside custom complex structure such as: {mynumber=9999} that will be sent as an OBJECT containing a STRING although the valid DMR syntax {""my number""=>999} would be sent as an OBJECT containing an INT.

Some server side subsystems are smart enough to call into asXXX methods and not check the type?



",2016/11/14 1:56 PM
WFCORE-1982,NoData,2016/11/14 11:21 AM
WFCORE-1980,"Property file passed via CLI with --properties option does not resolve expressions in EAP 7, where in EAP 6 it works fine. ",2016/11/14 6:38 AM
WFCORE-1976,"I'm running a fresh RHEL7.3 server subscribed to the current jboss eap7 repository [1] using the rpm package. [2]

[1] subscription-manager repos --enable=jb-eap-7-for-rhel-RHEL_VERSION-server-rpms
[2] https://access.redhat.com/documentation/en/red-hat-jboss-enterprise-application-platform/version-7.0/installation-guide/#rpm_installation",2016/11/11 3:44 PM
WFCORE-1975,"The {{modulePath}} parameters passed to the {{org.wildfly.core.embedded.EmbeddedProcessFactory}} methods are are rejected if they they are actual paths with multiple directories. Only single directory names are accepted.

This is inconsistent with the normal operation of the server, with the naming of the parameter, as well as with the semantics of the {{module.path}} system property that it ultimately sets.",2016/11/11 3:22 PM
WFCORE-1971,"Autocompletition of command in CLI does not work properly when starts writing quotes {{""}} right after equal sign {{=}} and then pressing {{<TAB>}}.

I write
{{/subsystem=transactions/log-store=""}}
and then press {{TAB}}
the autocompletion finishes the name but replaces the fist letter for the existing quotes. That leads to have command like
{{/subsystem=transactions/log-store=""og-store}}
which is obviously invalid as {{""og-store}} does not exists.",2016/11/09 12:46 PM
WFCORE-1970,NoData,2016/11/09 9:21 AM
WFCORE-1968,NoData,2016/11/09 3:51 AM
WFCORE-1967,There are some HTML tags in help text when adding new path. I think these should be either removed at all or should be made working so the text is formatted properly.,2016/11/09 3:41 AM
WFCORE-1961,NoData,2016/11/08 11:46 AM
WFCORE-1951,Allows the use of the GET method to obtain the binary stream to a content in the content repository.,2016/11/07 12:52 PM
WFCORE-1949,"{code}""logging-profile"" => {
                ""description"" => ""A profile that can be assigned to a deployment for it's logging configuration."",{code}
The description should instead read {quote}A profile that can be assigned to a deployment for its logging configuration.{quote}
{code}""use-parent-handlers"" => {
                            ""type"" => BOOLEAN,
                            ""description"" => ""Specifies whether or not this logger should send its output to it's parent Logger."",{code}
The description should instead read {quote}Specifies whether or not this logger should send its output to its parent Logger.{quote}",2016/11/07 10:00 AM
WFCORE-1943,"When working on the management models we first need to check the last final release so that we can identify if we do need to increment the versions or not.

I had already added a clean version 4 ready for ongoing development.

Also on a related point it would be better if we can add the new version in one commit and then make changes in a subsequent commit - this way we can use various git tools to see the changes made otherwise the first set of changes are never visible.",2016/11/06 8:59 AM
WFCORE-1937,"For some part of Elytron subsystem some unneeded part of message is printed in failure-description - messages with prefix {{WFLYCTL0412}} and {{WFLYCTL0180}} should not be part of failure-description since they are unneeded and confusing for this kind of failures (see example).

Example:
Adding permission, but non existing module is used:
{code}
/subsystem=elytron/simple-permission-mapper=mapper:add(permission-mappings=[{permissions=[{action=read,class-name=org.wildfly.security.auth.permission.LoginPermission,target-name=someName,module=some.nonexist.module}]}])
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {
        ""WFLYCTL0080: Failed services"" => {""org.wildfly.security.permission-mapper.mapper"" => ""org.jboss.msc.service.StartException in service org.wildfly.security.permission-mapper.mapper: org.jboss.modules.ModuleNotFoundException: some.nonexist.module:main
    Caused by: org.jboss.modules.ModuleNotFoundException: some.nonexist.module:main""},
        ""WFLYCTL0412: Required services that are not installed:"" => [""org.wildfly.security.permission-mapper.mapper""],
        ""WFLYCTL0180: Services with missing/unavailable dependencies"" => undefined
    },
    ""rolled-back"" => true
}
{code}

Base on comment [1] we are assigning this Jira to Brian. Could you please clarify whether WildFly Core or Elytron subsystem are responsible for printing this message to failure-description?

[1] https://issues.jboss.org/browse/JBEAP-6886?focusedCommentId=13317330&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13317330",2016/11/04 8:04 AM
WFCORE-2427,"Credential store has configuration in ""uri"" attribute. All parameters are in one string. It can be confusing and there is risk of typo (e.g. delimiter typo)
In my opinion the main intention for it is to have general solution for custom implementation.

*Current state*
{code}
/subsystem=elytron/credential-store=cs001:add(uri=""cr-store://test/cs/keystore.jceks?store.password=pass123;create.storage=true"")
{code}

*Suggestion for improvement:*
Better solution to achieve this could be use a map.
e.g. some like that:
{code}
/subsystem=elytron/credential-store=credStore:add(cs-map={store.password=pass123, create.storage=true, store.file=path/to/cred/file})
{code}

Now credential store name is in URI too, it can be get from resource name.
",2016/11/04 7:51 AM
WFCORE-1936,"{{fixed-port}} attribute of {{socket-binding}} and {{fixed-source-port}} attributes of {{*-destination-outbound-socket-binding}} define in its description that there is not necessary to do {{reload}} or {{restart}} for any of them. But reality is different. If you tries to change such attributes you are informed that {{reload}} is necessary.

The attributes are defined as {{""restart-required"" => ""no-services""}}, see {{/socket-binding-group=standard-sockets:read-resource-description(recursive=true)}}",2016/11/04 6:57 AM
WFCORE-1926,"Operation {{:validate-address}} produces IllegalArgumentException with wrong parameters instead of well formed failure description:
{{jboss-cli}}:
{code}[standalone@localhost:9990 /] :validate-address(value=nonsense)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.IllegalArgumentException"",
    ""rolled-back"" => true
}
{code}
{{server.log}}:
{code}13:14:39,102 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 15) WFLYCTL0013: Operation (""validate-address"") failed - address: ([]): java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.asList(ModelValue.java:143)
	at org.jboss.dmr.ModelNode.asList(ModelNode.java:1389)
	at org.jboss.as.controller.PathAddress.pathAddress(PathAddress.java:72)
	at org.jboss.as.controller.operations.common.ValidateAddressOperationHandler.execute(ValidateAddressOperationHandler.java:77)
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:940)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:683)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:382)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1363)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:410)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:232)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:213)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$300(ModelControllerClientOperationHandler.java:136)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:153)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:149)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:153)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}
{{jboss-cli}}:
{code}[standalone@localhost:9990 /] :validate-address(value=(nonsense))
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.IllegalArgumentException"",
    ""rolled-back"" => true
}
{code}
{{server.log}}:
{code}13:16:25,040 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 17) WFLYCTL0013: Operation (""validate-address"") failed - address: ([]): java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.asList(ModelValue.java:143)
	at org.jboss.dmr.ModelNode.asList(ModelNode.java:1389)
	at org.jboss.as.controller.PathAddress.pathAddress(PathAddress.java:72)
	at org.jboss.as.controller.operations.common.ValidateAddressOperationHandler.execute(ValidateAddressOperationHandler.java:77)
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:940)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:683)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:382)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1363)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:410)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:232)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:213)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$300(ModelControllerClientOperationHandler.java:136)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:153)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:149)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:153)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}
However, the following erroneous input does not pollute server.log with warning:
{code}[standalone@localhost:9990 /] :validate-address(value={""nonsense""=>""nonsense""})
Failed to handle ':validate-address(value={""nonsense""=>""nonsense""})': java.lang.IllegalArgumentException
{code}",2016/11/02 5:05 PM
WFCORE-1922,"Currently configuration-changes are managed as a part of the 'kernel' of WildFly Core. Moving this feature to a proper subsystem is more appropriate  as it would provide a nice way to deploy on managed servers according to a profile instead of a host.
Making this subsystem host-enabled we could also just configure it at a host level.",2016/11/02 8:57 AM
WFCORE-2034,"Description of the attribute {{date-format}} in

{code}
/core-service=management/access=audit/json-formatter=json-formatter
{code}

has following description:

{panel}
The date format to use as understood by \{@link java.text.SimpleDateFormat}. Will be ignored if include-date=\""false\"".
{panel}

The description string shouldn't contain javadoc style &#64;link ",2016/11/02 8:18 AM
WFCORE-1920,"Tab completion for LIST attribute is broken, it doesn't add end bracket ""]"".

I process this CLI command
{code}
/subsystem=elytron/aggregate-role-mapper=aggregateRoleMapper:add(role-mappers=[prefMapper001,prefMapper002<TAB>
{code}

*Actual result*
{code}
/subsystem=elytron/aggregate-role-mapper=aggregateRoleMapper:add(role-mappers=[prefMapper001,prefMapper002)

{code}

*Expected result*
{code}
/subsystem=elytron/aggregate-role-mapper=aggregateRoleMapper:add(role-mappers=[prefMapper001,prefMapper002])
{code}",2016/11/02 7:29 AM
WFCORE-1919,"*Steps to Reproduce:*
# ./standalone.sh
# ./jboss-cli.sh -c
# /core-service=management/security-realm=ManagementRealm/authentication=local:remove
# reload
# <Ctrl+C>

The client is already connected, Management realm is removed, client is reloaded. 
The user is prompted for UserName (local-auth has been disabled).
Ctrl-C is typed.
During Ctrl-C handling, the client is closed although it is ""reconnecting"" and has kept a lock. This lock is required to close the client. Lock that will never been released.

",2016/11/02 7:21 AM
WFCORE-1918,"The fix for WFCORE-1804 was committed [here|https://github.com/wildfly/wildfly-core/commit/027bfe959988b25e45771491e494ca61c19a986b#diff-c929deeb25b1e0886f6c256907ea7c44].
It has a side-effect that it disables quote parsing. Now the [another fix|https://github.com/aeshell/aesh/commit/0e8aa5cf514d5af81b16f7741c92a6547f4be0a1] which does not have the side-effect was committed in [aesh|https://github.com/aeshell/aesh]. The following line in the [previous fix|ttps://github.com/wildfly/wildfly-core/commit/027bfe959988b25e45771491e494ca61c19a986b#diff-c929deeb25b1e0886f6c256907ea7c44] should be removed, when the new aesh version is released (0.66.11 or 12?).

??cli/src/main/java/org/jboss/as/cli/impl/CommandContextImpl.java:495??
{code}
        settings.parsingQuotes(false);
{code}",2016/11/01 10:59 PM
WFCORE-1915,"The task of ParseUtils.parseAttributeValue is to convert a string into a ModelNode. The type of the ModelNode is not particularly important, as later code will do type conversion. And, it is *not* the job of this method to do validation; there is other code that does that. So, the type conversion this method does should not be allowed to produce failures. Continuing to try the conversion is ok, although not required, but if a conversion can't succeed the pre-conversion ModelType.STRING node should be returned.",2016/10/31 3:24 PM
WFCORE-2452,"In EAP7.1.0.DR7 Elytron key-store uses credential-reference with clear-text attribute for password instead of password attribute.
But there is problem with credential-reference element which is wrongly marked as optional.

Please set this element on mandatory with respect to this issue https://issues.jboss.org/browse/WFLY-7125
",2016/10/31 11:38 AM
WFCORE-1908,"CLI tab completion suggests attributes that are not writable and their access-type is {{metric}}
Example {code}
/subsystem=messaging-activemq/server=default/jms-queue=DLQ:write-attribute(name=<TAB>
consumer-count  delivering-count  entries  legacy-entries  message-count  messages-added  scheduled-count  
{code}

From executing {{:read-resource-description}} we can see, attributes consumer-count, delivering-count, message-count, messages-added, scheduled-count are of type metric.

On attempt to write metric attribute, for example message-count, non writable error is printed {code}
[standalone@localhost:9990 jms-queue=q] :write-attribute(name=message-count, value=5)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0048: Attribute message-count is not writable"",
    ""rolled-back"" => true
}
{code}

CLI should not suggest writing attributes that are not writable.
",2016/10/31 4:13 AM
WFCORE-1906,"standalone.bat is unable to start from directory ""jboss(eap)"" on Windows

This is regression against EAP 7.1.0.DR3.

Actual results:
{noformat}
C:\Users\Administrator\playground\7.1.0.DR5\jboss(eap)\bin>standalone.bat
Calling ""C:\Users\Administrator\playground\7.1.0.DR5\jboss(eap)\bin\standalone.conf.bat""
""JAVA_OPTS already set in environment; overriding default settings with values: -Dprogram.name=standalone.bat -Xms1G -Xmx1G -XX:Me
taspaceSize=96M -XX:MaxMetaspaceSize=256m -Djava.net.preferIPv4Stack=true -Djboss.modules.system.pkgs=org.jboss.byteman""
""GC_LOG set in environment to true""
Setting JAVA property to ""C:\jdk1.8.0_45\bin\java""
\standalone\log\gc.log"" -XX:-TraceClassUnloading -Dprogram.name=standalone.bat -Dprogram.name=standalone.bat -Xms1G -Xmx1G -XX:Met
aspaceSize=96M -XX:MaxMetaspaceSize=256m -Djava.net.preferIPv4Stack=true -Djboss.modules.system.pkgs=org.jboss.byteman"" was unexpe
cted at this time.
C:\Users\Administrator\playground\7.1.0.DR5\jboss(eap)\bin>
{noformat}",2016/10/28 10:32 AM
WFCORE-1909,"I noticed while testing my subsystem that sometimes using tab-complete on an attribute causes NUL ('\0') characters to be injected into the input.  These characters are invisible on the screen but cause XML marshalling to fail as that character is forbidden.

My ""less"" output of .jboss-cli-history looks something like this:
{noformat}
embed-server --std-out=echo
cd subsystem=discovery
./static-provider=test:add(services=[{uri=^@^@""local"", abstract-type=""ejb"", abstract-type-authority=""jboss""}])
./static-provider=test4:add(services=[{uri=""local"", abstract-type=""ejb"", abstract-type-authority=""jboss""}])
{noformat}

In the first ""test:add"" case I used tab-completion; in the second ""test4:add"" case I typed it out by hand.  The ""^@"" are in inverse video in less, indicating a NUL character.",2016/10/27 10:16 AM
WFCORE-1896,"Deployment operation browse-content(archive=true) does not return archives in archived deployments:
{code}[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:browse-content()
{
    ""outcome"" => ""success"",
    ""result"" => [
        {
            ""path"" => ""jboss-kitchensink-ear-web.war"",
            ""directory"" => false,
            ""file-size"" => 63190L
        },
        {
            ""path"" => ""jboss-kitchensink-ear-ejb.jar"",
            ""directory"" => false,
            ""file-size"" => 12256L
        },
        {
            ""path"" => ""META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.xml"",
            ""directory"" => false,
            ""file-size"" => 5582L
        },
        {
            ""path"" => ""META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.properties"",
            ""directory"" => false,
            ""file-size"" => 143L
        },
        {
            ""path"" => ""META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/"",
            ""directory"" => true
        },
        {
            ""path"" => ""META-INF/maven/org.jboss.quickstarts.eap/"",
            ""directory"" => true
        },
        {
            ""path"" => ""META-INF/maven/"",
            ""directory"" => true
        },
        {
            ""path"" => ""META-INF/MANIFEST.MF"",
            ""directory"" => false,
            ""file-size"" => 130L
        },
        {
            ""path"" => ""META-INF/application.xml"",
            ""directory"" => false,
            ""file-size"" => 802L
        },
        {
            ""path"" => ""META-INF/kitchensink-ear-quickstart-ds.xml"",
            ""directory"" => false,
            ""file-size"" => 1955L
        },
        {
            ""path"" => ""META-INF/"",
            ""directory"" => true
        }
    ]
}
[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:browse-content(archive=true)
{""outcome"" => ""success""}
{code}
It works correctly with exploded deployments:
{code}[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:undeploy
{""outcome"" => ""success""}
[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:explode
{""outcome"" => ""success""}
[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:deploy
{""outcome"" => ""success""}
[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:browse-content(archive=true)
{
    ""outcome"" => ""success"",
    ""result"" => [
        {
            ""path"" => ""jboss-kitchensink-ear-web.war"",
            ""directory"" => false,
            ""file-size"" => 63190L
        },
        {
            ""path"" => ""jboss-kitchensink-ear-ejb.jar"",
            ""directory"" => false,
            ""file-size"" => 12256L
        }
    ]
}
{code}",2016/10/26 5:44 AM
WFCORE-1905,"When using ""service.bat install /serviceuser ..."" command to install window service, if the account name behind /serviceuser has a whit space inside like "".\JBoss User"", it will failed to install windows service.

Run command: service.bat install /serviceuser "".\JBoss User"" /servicepass ""change it"" /startup /debug

When starting it, an error window poped up:
{code}
Windows could not start the JBossEAP6 on Local Computer.
For more information, review the System Event Log. 
If this is a non-Microsoft service, contact the service vendor, and refer to service-specific error code1.
{code}

Additional info:
Possible fix is editing ""service.bat"" and add double quotation marks on %SERVICE_USER% 

From 
{code}
set RUNAS=--ServiceUser=%SERVICE_USER% --ServicePassword=%SERVICE_PASS%
{code}

to
{code}
set RUNAS=--ServiceUser=""%SERVICE_USER%"" --ServicePassword=""%SERVICE_PASS%""
{code}
",2016/10/25 8:51 PM
WFCORE-1888,The HTTP handling for the management API supports caching of read-resource-description and read-operation-description responses. But the ETag calculation used in support of this is broken. It was written to calculate an MD5 hash of the toString() representation of a DMR response but the object being hashed got changed to an OperationResponse. The toString() representation of that is unique for each request.,2016/10/21 4:59 PM
WFCORE-1864,"Running 
{{module add --name=foo.bar --resources=foo.jar --dependencies=[org.a, org.b ]}}

will result in following dependencies in module.xml
{{
...
    <dependencies>
        <module name=""org.a""/>
        <module name="" org.b ""/>
    </dependencies>
...
}}

The module name in dependencies should be stripped of leading and trailing whitespaces.",2016/10/13 5:12 AM
WFCORE-1857,"When an operation doesn't exist, the character ')' is added by completion although nothing should be proposed.
",2016/10/07 8:48 AM
WFCORE-1853,"The bug WFCORE-1729 has revealed it. It seems to only occur on Windows.
I think that a small windows exists (possibly in Aesh) that makes the shutdown hook to not be properly invoked.",2016/10/05 4:22 AM
WFCORE-1851,"{{/deployment=jboss-kitchensink-ear.ear:browse-content(depth=1)}} operation returns inconsistent result depending on whether the deployment is exploded or not. Deployment attached.
Archived:
{code}{
    ""outcome"" => ""success"",
    ""result"" => [
        {
            ""path"" => ""jboss-kitchensink-ear-web.war"",
            ""directory"" => false,
            ""file-size"" => 63190L
        },
        {
            ""path"" => ""jboss-kitchensink-ear-ejb.jar"",
            ""directory"" => false,
            ""file-size"" => 12256L
        },
        {
            ""path"" => ""META-INF/"",
            ""directory"" => true
        }
    ]
}
{code}
Exploded:
{code}{
    ""outcome"" => ""success"",
    ""result"" => [
        {
            ""path"" => ""META-INF/"",
            ""directory"" => true
        },
        {
            ""path"" => ""META-INF/MANIFEST.MF"",
            ""directory"" => false,
            ""file-size"" => 130L
        },
        {
            ""path"" => ""jboss-kitchensink-ear-web.war"",
            ""directory"" => false,
            ""file-size"" => 63190L
        },
        {
            ""path"" => ""jboss-kitchensink-ear-ejb.jar"",
            ""directory"" => false,
            ""file-size"" => 12256L
        },
        {
            ""path"" => ""META-INF/application.xml"",
            ""directory"" => false,
            ""file-size"" => 802L
        },
        {
            ""path"" => ""META-INF/kitchensink-ear-quickstart-ds.xml"",
            ""directory"" => false,
            ""file-size"" => 1955L
        },
        {
            ""path"" => ""META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.xml"",
            ""directory"" => false,
            ""file-size"" => 5582L
        },
        {
            ""path"" => ""META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.properties"",
            ""directory"" => false,
            ""file-size"" => 143L
        }
    ]
}
{code}",2016/10/04 8:28 AM
WFCORE-2409,"* {{mechanism-oids}}
	** Minimal command for kerberos security factory creation is {code}/subsystem=elytron/kerberos-security-factory=kerberos:add(principal=mchoma, path=/path/to/keytab, mechanism-oids=[1.2.840.113554.1.2.2]){code}
	** I don't think it is user-friendly to require user to specify mechanism-oids. I think some reasonable default value should be used here. 
* {{minimum-remaining-lifetime}}
	** please, specify units in documentation, e.g. seconds/minutes
* {{relative-to}}
	** as just path reference can be used here, probably should be just ""expressions-allowed"" => false
	** In legacy settings it is documented better: ""The name of another previously named path, or of one of the standard paths provided by the system. If 'relative-to' is provided, the value of the 'path' attribute is treated as relative to the path specified by this attribute.""
* {{server}}
	** I assume based on {{server}} attribute INITIATE_ONLY or ACCEPT_ONLY is configured on GSSCredential [1]. Wouldn't it be useful to have also possibility to set INITIATE_AND_ACCEPT? Couldn't that be useful for example in case of identity propagation.	
* {{for-hosts}}
	** comparing to legacy security {{kerberosIdentityType}} I am missing for-hosts. Elytron won't provide such feature?
",2016/10/04 2:54 AM
WFCORE-1848,"If a thread completes the DomainServerMain main(String[] args) method, the process must exit. Currently that may not occur, as this stack trace reported while manually checking the WFCORE-1844 fix showed:

{code}
 
[Server:server-one] 14:15:39,022 ERROR [stderr] (main) Exception in thread ""main"" java.lang.OutOfMemoryError: unable to create new native thread
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at java.lang.Thread.start0(Native Method)
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at java.lang.Thread.start(Thread.java:714)
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at org.jboss.threads.JBossThread.start(JBossThread.java:342)
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:950)
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1368)
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:112)
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at org.jboss.as.server.mgmt.domain.HostControllerConnection.asyncReconnect(HostControllerConnection.java:165)
[Server:server-one] 14:15:39,023 ERROR [stderr] (main) 	at org.jboss.as.server.mgmt.domain.HostControllerClient.reconnect(HostControllerClient.java:93)
[Server:server-one] 14:15:39,024 ERROR [stderr] (main) 	at org.jboss.as.server.DomainServerMain.main(DomainServerMain.java:151)
[Server:server-one] 14:15:39,024 ERROR [stderr] (main) 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[Server:server-one] 14:15:39,024 ERROR [stderr] (main) 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[Server:server-one] 14:15:39,024 ERROR [stderr] (main) 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[Server:server-one] 14:15:39,024 ERROR [stderr] (main) 	at java.lang.reflect.Method.invoke(Method.java:498)
[Server:server-one] 14:15:39,024 ERROR [stderr] (main) 	at org.jboss.modules.Module.run(Module.java:336)
[Server:server-one] 14:15:39,024 ERROR [stderr] (main) 	at org.jboss.modules.Main.main(Main.java:520)
{code}

If the process does not exit, it is no longer under the control of the PC or HC and the only thing they can do with it is kill it. So it should kill itself.",2016/10/03 3:26 PM
WFCORE-1847,"PatchMerger merges two CPs into one. In case the first CP includes updates for modules like org.outermodule and org.outermodule.innermodule. And the second CP including an update for org.outermodule.innermodule only, the merge may not happen correctly in case the modification for the innermodule will appear before the modification for the outermodule in the first CP.
The merger will copy the innermodule's content first and then override it copying the outermodule's content (including the previous version of the innermodule).",2016/10/03 10:23 AM
WFCORE-1845,"When booting the server from a directory where the subtree is large the server hangs for a long time. JStack shows that the logging subsystem is scanning the CWD.

Booting the server from the root dir of a maven parent project containing 2 subprojects, a swarm project and a small NPM subproject added 33s to the server boot time compared to stepping into the swarm project and booting it.

Stacktrace while the server is booting:

{noformat}
Thread 25859: (state = IN_NATIVE)
 - sun.nio.fs.UnixNativeDispatcher.lstat0(long, sun.nio.fs.UnixFileAttributes) @bci=0 (Compiled frame; information may be imprecise)
 - sun.nio.fs.UnixNativeDispatcher.lstat(sun.nio.fs.UnixPath, sun.nio.fs.UnixFileAttributes) @bci=10, line=300 (Compiled frame)
 - sun.nio.fs.UnixFileAttributes.get(sun.nio.fs.UnixPath, boolean) @bci=22, line=72 (Compiled frame)
 - sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes() @bci=15, line=52 (Compiled frame)
 - sun.nio.fs.UnixFileSystemProvider.readAttributes(java.nio.file.Path, java.lang.Class, java.nio.file.LinkOption[]) @bci=57, line=144 (Compiled frame)
 - java.nio.file.Files.readAttributes(java.nio.file.Path, java.lang.Class, java.nio.file.LinkOption[]) @bci=7, line=1737 (Compiled frame)
 - java.nio.file.FileTreeWalker.getAttributes(java.nio.file.Path, boolean) @bci=56, line=219 (Compiled frame)
 - java.nio.file.FileTreeWalker.visit(java.nio.file.Path, boolean, boolean) @bci=3, line=276 (Compiled frame)
 - java.nio.file.FileTreeWalker.next() @bci=134, line=372 (Compiled frame)
 - java.nio.file.Files.walkFileTree(java.nio.file.Path, java.util.Set, int, java.nio.file.FileVisitor) @bci=256, line=2706 (Compiled frame)
 - java.nio.file.Files.walkFileTree(java.nio.file.Path, java.nio.file.FileVisitor) @bci=9, line=2742 (Interpreted frame)
 - org.jboss.as.logging.LoggingResource.findFiles(java.lang.String, org.jboss.dmr.ModelNode, boolean) @bci=47, line=251 (Interpreted frame)
 - org.jboss.as.logging.LoggingResource.getChildrenNames(java.lang.String) @bci=37, line=157 (Interpreted frame)
 - org.jboss.as.logging.LoggingResource.getChildren(java.lang.String) @bci=11, line=171 (Interpreted frame)
 - org.jboss.as.controller.registry.AbstractModelResource$DelegateResource.getChildren(java.lang.String) @bci=5, line=362 (Interpreted frame)
 - org.jboss.as.controller.registry.Resource$Tools.readModel(org.jboss.as.controller.PathAddress, org.jboss.as.controller.registry.Resource, int, org.jboss.as.controller.registry.ResourceFilter) @bci=99, line=289 (Interpreted frame)
 - org.jboss.as.controller.registry.Resource$Tools.readModel(org.jboss.as.controller.registry.Resource, int, org.jboss.as.controller.registry.ResourceFilter) @bci=19, line=276 (Interpreted frame)
 - org.jboss.as.controller.registry.Resource$Tools.readModel(org.jboss.as.controller.registry.Resource, int) @bci=5, line=262 (Interpreted frame)
 - org.jboss.as.controller.registry.Resource$Tools.readModel(org.jboss.as.controller.PathAddress, org.jboss.as.controller.registry.Resource, int, org.jboss.as.controller.registry.ResourceFilter) @bci=189, line=291 (Interpreted frame)
 - org.jboss.as.controller.registry.Resource$Tools.readModel(org.jboss.as.controller.registry.Resource, int, org.jboss.as.controller.registry.ResourceFilter) @bci=19, line=276 (Interpreted frame)
 - org.jboss.as.controller.registry.Resource$Tools.readModel(org.jboss.as.controller.registry.Resource, int) @bci=5, line=262 (Interpreted frame)
 - org.jboss.as.controller.registry.Resource$Tools.readModel(org.jboss.as.controller.registry.Resource) @bci=2, line=250 (Interpreted frame)
 - org.jboss.as.controller.ModelControllerImpl.writeModel(org.jboss.as.controller.ModelControllerImpl$ManagementModelImpl, java.util.Set) @bci=19, line=769 (Interpreted frame)
 - org.jboss.as.controller.OperationContextImpl.createPersistenceResource() @bci=17, line=519 (Interpreted frame)
 - org.jboss.as.controller.AbstractOperationContext.executeDoneStage(org.jboss.dmr.ModelNode) @bci=22, line=708 (Interpreted frame)
 - org.jboss.as.controller.AbstractOperationContext.processStages() @bci=277, line=680 (Interpreted frame)
 - org.jboss.as.controller.AbstractOperationContext.executeOperation() @bci=27, line=370 (Interpreted frame)
 - org.jboss.as.controller.OperationContextImpl.executeOperation() @bci=20, line=1344 (Interpreted frame)
 - org.jboss.as.controller.ModelControllerImpl.boot(java.util.List, org.jboss.as.controller.client.OperationMessageHandler, org.jboss.as.controller.ModelController$OperationTransactionControl, boolean, org.jboss.as.controller.extension.MutableRootResourceRegistrationProvider, boolean, boolean) @bci=410, line=485 (Interpreted frame)
 - org.jboss.as.controller.AbstractControllerService.boot(java.util.List, boolean, boolean, org.jboss.as.controller.extension.MutableRootResourceRegistrationProvider) @bci=16, line=387 (Interpreted frame)
 - org.jboss.as.controller.AbstractControllerService.boot(java.util.List, boolean) @bci=7, line=349 (Interpreted frame)
 - org.jboss.as.server.ServerService.boot(java.util.List, boolean) @bci=22, line=392 (Interpreted frame)
 - org.jboss.as.server.ServerService.boot(org.jboss.as.controller.BootContext) @bci=907, line=365 (Interpreted frame)
 - org.jboss.as.controller.AbstractControllerService$1.run() @bci=12, line=299 (Interpreted frame)
 - java.lang.Thread.run() @bci=11, line=745 (Interpreted frame)
{noformat}
",2016/09/30 6:54 PM
WFCORE-1844,"Trying to execute management requests against a managed domain server that is unresponsive due to OOME results in threads on the HC in stuck permanently in a state like this:

{code}
""Host Controller Service Threads - 48"" #91 prio=5 os_prio=31 tid=0x00007fbbf0039800 nid=0x3d33 in Object.wait() [0x0000700003c42000]
   java.lang.Thread.State: WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	- waiting on <0x00000007b64842d0> (a org.jboss.as.protocol.mgmt.ActiveOperationImpl)
	at java.lang.Object.wait(Object.java:502)
	at org.jboss.threads.AsyncFutureTask.awaitUninterruptibly(AsyncFutureTask.java:221)
	- locked <0x00000007b64842d0> (a org.jboss.as.protocol.mgmt.ActiveOperationImpl)
	at org.jboss.as.controller.client.impl.BasicDelegatingAsyncFuture.awaitUninterruptibly(BasicDelegatingAsyncFuture.java:57)
	at org.jboss.as.controller.client.impl.AbstractDelegatingAsyncFuture.awaitUninterruptibly(AbstractDelegatingAsyncFuture.java:35)
	at org.jboss.as.controller.client.impl.BasicDelegatingAsyncFuture.cancel(BasicDelegatingAsyncFuture.java:74)
	at org.jboss.as.controller.client.impl.AbstractDelegatingAsyncFuture.cancel(AbstractDelegatingAsyncFuture.java:35)
	at org.jboss.as.controller.remote.RemoteProxyController.execute(RemoteProxyController.java:173)
	at org.jboss.as.controller.TransformingProxyController$Factory$TransformingProxyControllerImpl.execute(TransformingProxyController.java:203)
	at org.jboss.as.controller.ProxyStepHandler.execute(ProxyStepHandler.java:170)
{code}

The RemoteProxyController code looks like this:

{code}
                long timeout = blockingTimeout.getProxyBlockingTimeout(targetAddress, this);
                prepared = queue.poll(timeout, TimeUnit.MILLISECONDS);
                if (prepared == null) {
                    blockingTimeout.proxyTimeoutDetected(targetAddress);
                    futureResult.cancel(true);
{code}

The problem is that ""cancel"" call will block, uninterruptibly, until the remote process responds to the cancel message. Which it won't do, as it's all messed up from the OOME condition.

Hopefully this can be simply fixed by converting that call to asyncCancel.",2016/09/30 5:27 PM
WFCORE-1834,"I have recently updated one of our resource definitions and missed updating one of the subsystem templates so currently have the following error reported: -

{noformat}
Message: WFLYCTL0376: Unexpected attribute 'security-domain' encountered. Valid attributes are: 'http-authentication-factory, override-deployment-config'
[Host Controller] 	at org.jboss.as.controller.parsing.ParseUtils.unexpectedAttribute(ParseUtils.java:128)
{noformat}

Previously my resource has been using the 'security-domain' attribute for it's name but now has been reverted to using 'name' for the name - in the above error message 'name' should have been listed as one of the valid attributes.",2016/09/27 12:10 PM
WFCORE-1826,"*Description of problem:*
Tab completion returns wrong values

*How reproducible:*
Always

*Steps to Reproduce:*
{noformat}
/extension=org.wildfly.extension.elytron:add
/subsystem=elytron:add
reload
/subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{permissions=[{class-name=""org.wildfly.security.auth.permission.LoginPermission""}],<TAB>
{noformat}

*Actual results:*
{noformat}
/subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{permissions=[{class-name=""org.wildfly.security.auth.permission.LoginPermission""}],{
{noformat}


*Expected results:*
{noformat}
[standalone@localhost:9990 /] /subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{permissions=[{class-name=""org.wildfly.security.auth.permission.LoginPermission""}],
principals  roles  
[standalone@localhost:9990 /] /subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{permissions=[{class-name=""org.wildfly.security.auth.permission.LoginPermission""}],
{noformat}",2016/09/26 9:26 AM
WFCORE-1825,"*Description of problem:*
This issue is similar like JBEAP-6043. Tab completion throws IllegalArgumentException after two '\{' characters and '=' character. Or tab completition returns unlimited count of ')' characters.

*How reproducible:*
Always

----

*1. Steps to Reproduce:*
{noformat}
Get fresh EAP.
./standalone.sh &
./jboss-cli.sh -c
/subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{roles=[{role<TAB><TAB><TAB><TAB><TAB><TAB><TAB><TAB><TAB><TAB>
{noformat}

*1. Actual results:*
{noformat}
/subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{roles=[{role))))))))))
{noformat}

----

*2. Steps to Reproduce:*
{noformat}
./standalone.sh -c standalone-elytron.xml &
./jboss-cli.sh -c
/subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{roles=[{role=<TAB>
{noformat}

*2. Actual results:*
* java.lang.IllegalArgumentException
* Details:
{noformat}
[mkopecky@dhcp-10-40-5-171 bin]$ ./jboss-cli.sh -c
[standalone@localhost:9990 /] /subsystem=elytron/simple-permission-mapper=login-permission-mapper2:add(permission-mappings=[{roles=[{role=Exception in thread ""Aesh Process Loop 30318020"" java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.getChild(ModelValue.java:115)
	at org.jboss.dmr.ModelNode.get(ModelNode.java:861)
	at org.jboss.as.cli.impl.ValueTypeCompleter$ValueTypeCallbackHandler.getCandidates(ValueTypeCompleter.java:475)
	at org.jboss.as.cli.impl.ValueTypeCompleter.complete(ValueTypeCompleter.java:321)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:254)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:74)
	at org.jboss.as.cli.CommandCompleter.doComplete(CommandCompleter.java:137)
	at org.jboss.as.cli.CommandCompleter.complete(CommandCompleter.java:64)
	at org.jboss.as.cli.impl.Console$Factory$1$1.complete(Console.java:143)
	at org.jboss.aesh.console.AeshCompletionHandler.complete(AeshCompletionHandler.java:155)
	at org.jboss.aesh.console.AeshInputProcessor.complete(AeshInputProcessor.java:427)
	at org.jboss.aesh.console.AeshInputProcessor.parseOperation(AeshInputProcessor.java:165)
	at org.jboss.aesh.console.Console.processInternalOperation(Console.java:773)
	at org.jboss.aesh.console.Console.execute(Console.java:733)
	at org.jboss.aesh.console.Console.access$900(Console.java:73)
	at org.jboss.aesh.console.Console$6.run(Console.java:642)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
[mkopecky@dhcp-10-40-5-171 bin]$
{noformat}",2016/09/26 9:22 AM
WFCORE-1824,"My resource defines an attribute which is a LIST of OBJECT that corresponds to a class (class name + module) and Properties that are passed to the created instance:

{noformat}
    private static final String CLASS = ""class"";
    private static final String MODULE = ""module"";
    public static final PropertiesAttributeDefinition PROPERTIES = new PropertiesAttributeDefinition.Builder(""properties"", true)
            .setAllowExpression(true)
            .build();

    public static final ObjectTypeAttributeDefinition PROCESS_STATE_LISTENER = ObjectTypeAttributeDefinition.Builder.of(""process-state-listener"",
            SimpleAttributeDefinitionBuilder.create(CLASS, ModelType.STRING, false)
                    .setAllowExpression(false)
                    .build(),
            SimpleAttributeDefinitionBuilder.create(MODULE, ModelType.STRING, false)
                    .setAllowExpression(false)
                    .build(),
            PROPERTIES)
            .setRestartAllServices()
            .setAllowNull(true)
            .build();
    public static final AttributeDefinition PROCESS_STATE_LISTENERS = ObjectListAttributeDefinition.Builder.of(""listeners"", PROCESS_STATE_LISTENER)
            .setAllowNull(false)
            .setRuntimeServiceNotRequired()
            .build();
{noformat}

I can create the resource from the CLI:

{noformat}
 /subsystem=core-management/service=process-state-listeners:add(listeners=[{class=org.foo.Listener, module=org.foo,, properties = {foo  = true, bar  = ${bar.prop:2}}}])
{""outcome"" => ""success""}
{noformat}

And the resource and its attribute is properly marshalled to the XML configuration:

{noformat}
            <process-state-listeners>
                <listeners>
                    <process-state-listener class=""org.foo.Listener"" module=""org.foo"">
                        <properties>
                            <property name=""foo"" value=""true""/>
                            <property name=""bar"" value=""${bar.prop:2}""/>
                        </properties>
                    </process-state-listener>
                </listeners>
            </process-state-listeners>
{noformat}

However the resource can not be parsed and it fails with the exception:

{noformat}
2016-09-27 14:57:35,285 ERROR [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0055: Caught exception during boot: org.jboss.as.controller.persistence.ConfigurationPersistenceException: WFLYCTL0085: Failed to parse configuration
	at org.jboss.as.controller.persistence.XmlConfigurationPersister.load(XmlConfigurationPersister.java:131)
	at org.jboss.as.server.ServerService.boot(ServerService.java:355)
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:303)
	at java.lang.Thread.run(Thread.java:745)
Caused by: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[118,25]
Message: WFLYCTL0198: Unexpected element '{urn:jboss:domain:core-management:1.0}properties' encountered
	at org.jboss.as.controller.parsing.ParseUtils.unexpectedElement(ParseUtils.java:89)
	at org.jboss.as.controller.parsing.ParseUtils.requireNoContent(ParseUtils.java:244)
	at org.jboss.as.controller.AttributeParser$5.parseElement(AttributeParser.java:197)
	at org.jboss.as.controller.PersistentResourceXMLDescription.parseAttributes(PersistentResourceXMLDescription.java:208)
	at org.jboss.as.controller.PersistentResourceXMLDescription.parseAttributeGroups(PersistentResourceXMLDescription.java:140)
	at org.jboss.as.controller.PersistentResourceXMLDescription.parse(PersistentResourceXMLDescription.java:117)
	at org.jboss.as.controller.PersistentResourceXMLDescription.parseChildren(PersistentResourceXMLDescription.java:258)
	at org.jboss.as.controller.PersistentResourceXMLDescription.parse(PersistentResourceXMLDescription.java:135)
	at org.wildfly.extension.management.CoreManagementSubsystemParser_1_0.readElement(CoreManagementSubsystemParser_1_0.java:77)
	at org.wildfly.extension.management.CoreManagementSubsystemParser_1_0.readElement(CoreManagementSubsystemParser_1_0.java:50)
	at org.jboss.staxmapper.XMLMapperImpl.processNested(XMLMapperImpl.java:110)
	at org.jboss.staxmapper.XMLExtendedStreamReaderImpl.handleAny(XMLExtendedStreamReaderImpl.java:69)
	at org.jboss.as.server.parsing.StandaloneXml_5.parseServerProfile(StandaloneXml_5.java:591)
	at org.jboss.as.server.parsing.StandaloneXml_5.readServerElement(StandaloneXml_5.java:245)
	at org.jboss.as.server.parsing.StandaloneXml_5.readElement(StandaloneXml_5.java:144)
	at org.jboss.as.server.parsing.StandaloneXml.readElement(StandaloneXml.java:107)
	at org.jboss.as.server.parsing.StandaloneXml.readElement(StandaloneXml.java:49)
	at org.jboss.staxmapper.XMLMapperImpl.processNested(XMLMapperImpl.java:110)
	at org.jboss.staxmapper.XMLMapperImpl.parseDocument(XMLMapperImpl.java:69)
	at org.jboss.as.controller.persistence.XmlConfigurationPersister.load(XmlConfigurationPersister.java:123)
	... 3 more
{noformat}

The code in org.jboss.as.controller.AttributeParser#parseElement:197 to parse a list of objects assumes that the object's value are all represented by XML attributes. In my case, that's not correct as the ""properties"" attribute is represented by XML elements.",2016/09/26 8:30 AM
WFCORE-1823,"ConnectDialog uses sun.tools.jconsole.Utilities.ensureContrast JDK internal API (jdk.jconsole)

https://github.com/wildfly/wildfly-core/blob/master/cli/src/main/java/org/jboss/as/cli/gui/ConnectDialog.java#L155

ensureContrast logic could be ported to util method and dependency on JDK method removed
http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/sun/tools/jconsole/Utilities.java#Utilities.ensureContrast%28java.awt.Color%2Cjava.awt.Color%29",2016/09/26 7:49 AM
WFCORE-1799,"For example:
module add --name=foo --dependencies=sun.scripting ==> space character is added at the end.
module add --name=foo --dependencies=sun.scripting,sun.jdk ==> Nothing happens, no space character added.
deployment-overlay add --name=foo --contents=foo=/some/file<TAB> ==> Nothing happens, no space character added.

This seems to be caused by a condition in  [OperationRequestCompleter|https://github.com/wildfly/wildfly-core/blob/bc4988960e9bd245318321a06ae3d001ec661bc5/cli/src/main/java/org/jboss/as/cli/operation/OperationRequestCompleter.java#L233] - if a suggested value is the same as current user input, ORC replaces the suggestion with a separator.
This only works if the offset returned by argument completer is 0 - if the completer provides only part of the value, this condition will never be triggered.",2016/09/15 10:07 AM
WFCORE-1797,NoData,2016/09/15 5:15 AM
WFCORE-1794,"The step number is not incremented. This makes the attachment command to behave strangely. As described in EAP7-602.
The file and overwrite options should be rejected for display. As described in EAP7-602 too.
",2016/09/14 9:28 AM
WFCORE-1789,"*Description of problem:*
PreparedResponseTestCase from wf-core-eap fails intermittently with two different stack-trace

*How reproducible:*
2%

*Actual results: (1. issue)*
Stack Trace:
{noformat}
java.lang.AssertionError: null
	at org.junit.Assert.fail(Assert.java:86)
	at org.junit.Assert.assertTrue(Assert.java:41)
	at org.junit.Assert.assertTrue(Assert.java:52)
	at org.wildfly.core.test.standalone.mgmt.PreparedResponseTestCase.reloadServer(PreparedResponseTestCase.java:113)
{noformat}

Standard Output:
{noformat}
&amp#27;[0m01:34:22,658 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-4) WFLYSRV0028: Stopped deployment slow-stop.jar (runtime-name: slow-stop.jar) in 3025ms
&amp#27;[0m&amp#27;[0m01:34:22,701 INFO  [org.jboss.as] (MSC service thread 1-2) WFLYSRV0050: WildFly Core 3.0.0.Alpha4-redhat-1 ""Kenny"" stopped in 3071ms
&amp#27;[0m&amp#27;[0m01:34:22,710 INFO  [org.jboss.as] (MSC service thread 1-5) WFLYSRV0049: WildFly Core 3.0.0.Alpha4-redhat-1 ""Kenny"" starting
&amp#27;[0m&amp#27;[0m01:34:23,243 INFO  [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0039: Creating http management service using socket-binding (management-http)
&amp#27;[0m&amp#27;[0m01:34:23,331 INFO  [org.jboss.as.patching] (MSC service thread 1-4) WFLYPAT0050: WildFly cumulative patch ID is: base, one-off patches include: none
&amp#27;[0m&amp#27;[33m01:34:23,361 WARN  [org.jboss.as.domain.management.security] (MSC service thread 1-3) WFLYDM0111: Keystore /mnt/hudson_workspace/workspace/eap-7x-as-testsuite-test-core-rhel/19de6045/testsuite/manualmode/target/wildfly-core/standalone/configuration/application.keystore not found, it will be auto generated on first use with a self signed certificate for host localhost
&amp#27;[0m&amp#27;[33m01:34:23,355 WARN  [org.jboss.as.domain.http.api.undertow] (MSC service thread 1-1) WFLYDMHTTP0003: Unable to load console module for slot main, disabling console
&amp#27;[0m&amp#27;[0m01:34:23,367 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-7) WFLYSRV0027: Starting deployment of ""slow-stop.jar"" (runtime-name: ""slow-stop.jar"")
&amp#27;[0m&amp#27;[33m01:34:23,449 WARN  [org.jboss.as.dependency.private] (MSC service thread 1-1) WFLYSRV0018: Deployment ""deployment.slow-stop.jar"" is using a private module (""org.jboss.as.controller:main"") which may be changed or removed in future versions without notice.
&amp#27;[0m&amp#27;[33m01:34:23,450 WARN  [org.jboss.as.dependency.private] (MSC service thread 1-1) WFLYSRV0018: Deployment ""deployment.slow-stop.jar"" is using a private module (""org.jboss.as.server:main"") which may be changed or removed in future versions without notice.
&amp#27;[0m&amp#27;[33m01:34:23,452 WARN  [org.jboss.as.dependency.private] (MSC service thread 1-1) WFLYSRV0018: Deployment ""deployment.slow-stop.jar"" is using a private module (""org.wildfly.extension.request-controller:main"") which may be changed or removed in future versions without notice.
&amp#27;[0m&amp#27;[33m01:34:23,453 WARN  [org.jboss.as.dependency.private] (MSC service thread 1-1) WFLYSRV0018: Deployment ""deployment.slow-stop.jar"" is using a private module (""org.jboss.as.network:main"") which may be changed or removed in future versions without notice.
&amp#27;[0m&amp#27;[0m01:34:23,479 INFO  [org.wildfly.test.shutdown.SlowStopService] (MSC service thread 1-7) Started with a stop duration of 3000 ms
&amp#27;[0m&amp#27;[0m01:34:23,528 INFO  [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0010: Deployed ""slow-stop.jar"" (runtime-name : ""slow-stop.jar"")
&amp#27;[0m
{noformat}

*Actual results: (2. issue)*
Stack Trace:
{noformat}
java.lang.RuntimeException: java.io.IOException: java.util.concurrent.CancellationException: Operation was cancelled
	at org.jboss.threads.AsyncFutureTask.operationCancelled(AsyncFutureTask.java:70)
	at org.jboss.threads.AsyncFutureTask.get(AsyncFutureTask.java:267)
	at org.jboss.as.controller.client.impl.AbstractDelegatingAsyncFuture.get(AbstractDelegatingAsyncFuture.java:57)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.executeForResult(AbstractModelControllerClient.java:147)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.execute(AbstractModelControllerClient.java:75)
	at org.wildfly.core.testrunner.ManagementClient.executeForResult(ManagementClient.java:234)
	at org.wildfly.core.test.standalone.mgmt.PreparedResponseTestCase.reloadServer(PreparedResponseTestCase.java:102)
{noformat}

Standard Output:
{noformat}
11:03:28,015 WARN  [org.jboss.as.protocol.connection] (Remoting ""management-client"" task-5) WFLYPRT0018: No such request (1) associated with channel Channel ID a37ddd63 (outbound) of Remoting connection 68823cff to /10.16.180.146:9990 of endpoint ""management-client"" <6645cf9f>
{noformat}

*Expected results:*
No errors

*Additional info:*
Links to jenkins results:
* https://jenkins.mw.lab.eng.bos.redhat.com/hudson/view/EAP7/view/EAP7-AS-Testsuite/view/EAP7-AS-Testsuite-Jobs/job/eap-7x-as-testsuite-test-core/40/RELEASE=7.x.0,jdk=java18_default,label_exp=eap-sustaining&&(RHEL6%7C%7CEAP-RHEL7)/testReport/
* https://jenkins.mw.lab.eng.bos.redhat.com/hudson/job/eap-7x-as-testsuite-test-core-rhel/jdk=ibm1.8,label_exp=eap-sustaining&&RHEL6&&x86/49/testReport/
* https://jenkins.mw.lab.eng.bos.redhat.com/hudson/job/eap-7x-as-testsuite-test-core-rhel-ipv6/jdk=ibm1.8,label_exp=RHEL7-ipv6/39/testReport/",2016/09/13 11:42 AM
WFCORE-1787,"Try to add resource with OBJECT type attribute cause IllegalArgumentException.

*Actual result:*
CLI operation failed with IllegalArgumentException

*Expected results:*
Success CLI operation

*My investigation:*
In my opinion is problem caused by this PR to wildfly-core 
https://github.com/wildfly/wildfly-core/pull/1698/files#diff-835f377f8fa5ec22368d701a8412f282R1333

Look at lines 1333-1350 Util.java",2016/09/13 9:43 AM
WFCORE-1786,NoData,2016/09/13 8:10 AM
WFCORE-1785,"It is not possible to add Elytron extension that was previously removed. Everything works fine if the server is reloaded between steps 5 and 6, hence I assume that there is either 'reload required' state missing or Elytron extension is not removed properly.

Actual result:
{code}
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.IllegalStateException: WFLYCTL0363: Capability 'org.wildfly.security.providers' is already registered in context 'global'."",
    ""rolled-back"" => true
}

{code}

{code}
ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 2) WFLYCTL0013: Operation (""add"") failed - address: ([(""extension"" => ""org.wildfly.extension.elytron"")]): java.lang.IllegalStateException: WFLYCTL0363: Capability 'org.wildfly.security.providers' is already registered in context 'global'.
	at org.jboss.as.controller.CapabilityRegistry.lambda$registerPossibleCapability$0(CapabilityRegistry.java:518)
	at java.util.concurrent.ConcurrentHashMap.computeIfPresent(ConcurrentHashMap.java:1769)
	at org.jboss.as.controller.CapabilityRegistry.registerPossibleCapability(CapabilityRegistry.java:512)
	at org.jboss.as.controller.registry.ConcreteResourceRegistration.registerCapability(ConcreteResourceRegistration.java:669)
	at org.jboss.as.controller.SimpleResourceDefinition.registerCapabilities(SimpleResourceDefinition.java:368)
	at org.jboss.as.controller.registry.NodeSubregistry.registerChild(NodeSubregistry.java:108)
	at org.jboss.as.controller.registry.ConcreteResourceRegistration.registerSubModel(ConcreteResourceRegistration.java:226)
	at org.wildfly.extension.elytron.ElytronDefinition.registerChildren(ElytronDefinition.java:83)
	at org.jboss.as.controller.registry.NodeSubregistry.registerChild(NodeSubregistry.java:107)
	at org.jboss.as.controller.registry.ConcreteResourceRegistration.registerSubModel(ConcreteResourceRegistration.java:226)
	at org.jboss.as.controller.extension.ExtensionRegistry$SubsystemRegistrationImpl.registerSubsystemModel(ExtensionRegistry.java:694)
	at org.wildfly.extension.elytron.ElytronExtension.initialize(ElytronExtension.java:99)
	at org.jboss.as.controller.extension.ExtensionAddHandler.initializeExtension(ExtensionAddHandler.java:131)
	at org.jboss.as.controller.extension.ExtensionAddHandler.execute(ExtensionAddHandler.java:83)
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:951)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:694)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:389)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1363)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:410)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:232)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:213)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$300(ModelControllerClientOperationHandler.java:136)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:153)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:149)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:153)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}

Expected result:
It is possible to add Elytron subsystem after its removal.",2016/09/12 8:57 AM
WFCORE-1784,"By mistake, the default directory is used for files when the file to save is renamed.
",2016/09/12 8:23 AM
WFCORE-1780,"If a slave fails to connect to the master it logs ""Could not connect to master. Aborting. Error was: %s"" but since WFCORE-316 it no longer always aborts.

Plus when it does abort it uses the deprecated SystemExiter.exit method.

So we should change the first message to drop the bit about aborting and then if we do really abort pass an abort message to SystemExiter.",2016/09/09 5:23 PM
WFCORE-1776,"I tried to click through CLI GUI, particullary interested in webservices subsystem.
I navigated through the tree into {{/subsystem=webservices/endpoint-config=*}}, right-click and chose {{ead-resource-description}}.

It generated this command, but after executing through GUI, it returns null:
{code}
/subsystem=webservices/endpoint-config=*/:read-resource-description(recursive=false,access-control=none)
null
{code}

The same command in console CLI return valid resut:
{code:java}
[standalone@localhost:9990 /] /subsystem=webservices/endpoint-config=*/:read-resource-description(recursive=false,access-control=none)
{
    ""outcome"" => ""success"",
    ""result"" => [{
        ""address"" => [
            (""subsystem"" => ""webservices""),
            (""endpoint-config"" => ""*"")
        ],
        ""outcome"" => ""success"",
        ""result"" => {
            ""description"" => ""Webservice endpoint configuration"",
            ""attributes"" => {},
            ""operations"" => undefined,
            ""notifications"" => undefined,
            ""children"" => {
                ""pre-handler-chain"" => {
                    ""description"" => ""Pre handler chain"",
                    ""model-description"" => undefined
                },
                ""post-handler-chain"" => {
                    ""description"" => ""Post handler chain"",
                    ""model-description"" => undefined
                },
                ""property"" => {
                    ""description"" => ""Configuration property"",
                    ""model-description"" => undefined
                }
            }
        }
    }]
}

{code}


The problem seems to be related to the {{access-control=none}} parameter, because without it both GUI and console return the same valid result

{code:java}
/subsystem=webservices/endpoint-config=*/:read-resource-description(recursive=false)
{
    ""outcome"" => ""success"",
    ""result"" => [{
        ""address"" => [
            (""subsystem"" => ""webservices""),
            (""endpoint-config"" => ""*"")
        ],
        ""outcome"" => ""success"",
        ""result"" => {
            ""description"" => ""Webservice endpoint configuration"",
            ""attributes"" => {},
            ""operations"" => undefined,
            ""notifications"" => undefined,
            ""children"" => {
                ""pre-handler-chain"" => {
                    ""description"" => ""Pre handler chain"",
                    ""model-description"" => undefined
                },
                ""post-handler-chain"" => {
                    ""description"" => ""Post handler chain"",
                    ""model-description"" => undefined
                },
                ""property"" => {
                    ""description"" => ""Configuration property"",
                    ""model-description"" => undefined
                }
            }
        }
    }]
}
{code}
",2016/09/09 11:02 AM
WFCORE-1771,"Getting an exception when trying to make a composite operation
{code}
[standalone@localhost:9990 /] :composite(steps=[{aException in thread ""Aesh Process Loop 1409160703"" java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.getKeys(ModelValue.java:139)
	at org.jboss.dmr.ModelNode.keys(ModelNode.java:1378)
	at org.jboss.as.cli.impl.ValueTypeCompleter$ValueTypeCallbackHandler.getCandidates(ValueTypeCompleter.java:502)
	at org.jboss.as.cli.impl.ValueTypeCompleter.complete(ValueTypeCompleter.java:332)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:254)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:74)
	at org.jboss.as.cli.CommandCompleter.doComplete(CommandCompleter.java:134)
	at org.jboss.as.cli.CommandCompleter.complete(CommandCompleter.java:63)
	at org.jboss.as.cli.impl.Console$Factory$1$1.complete(Console.java:143)
	at org.jboss.aesh.console.AeshCompletionHandler.complete(AeshCompletionHandler.java:155)
	at org.jboss.aesh.console.AeshInputProcessor.complete(AeshInputProcessor.java:423)
	at org.jboss.aesh.console.AeshInputProcessor.parseOperation(AeshInputProcessor.java:165)
	at org.jboss.aesh.console.Console.processInternalOperation(Console.java:773)
	at org.jboss.aesh.console.Console.execute(Console.java:733)
	at org.jboss.aesh.console.Console.access$900(Console.java:73)
	at org.jboss.aesh.console.Console$6.run(Console.java:642)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
{code}

Happens only for certain strings, e.g.
* {{:composite(steps=\[{a<TAB>}} fails
* {{:composite(steps=\[a<TAB>}} doesn't fail (suggests "","" or ""]"")
* {{:composite(steps=\[a=<TAB>}} fails",2016/09/08 8:44 AM
WFCORE-1769,"The ParameterValidator javadoc declares the 'value' parameter cannot be null, so a null param value should result in an AssertionError or an IAE. But RolloutPlanValidator is throwing an OFE. OFE should be used for user errors (i.e. invalid requests), not coding mistakes. The data passed to a validator is not under the control of the user; passing a null means a coding mistake.

The caller of a ParameterValidator is the kernel, not outside code, so we are not validating unknown inputs. So an assert is fine; no need for an IAE.",2016/09/07 4:09 PM
WFCORE-1767,"I just happened to catch the following exception:

{noformat}
[standalone@localhost:9990 /] /subsystem=jgroups/stack=anothertcp:add(transport={type=TCP,socket-binding=jgroups-tcp},protocols=[{Exception in thread ""Aesh Process Loop 1561063579"" java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.asType(ModelValue.java:147)
	at org.jboss.dmr.ModelNode.asType(ModelNode.java:321)
	at org.jboss.as.cli.impl.ValueTypeCompleter$ComplexInstance.isCompliantType(ValueTypeCompleter.java:239)
	at org.jboss.as.cli.impl.ValueTypeCompleter$Instance.getType(ValueTypeCompleter.java:103)
	at org.jboss.as.cli.impl.ValueTypeCompleter$ValueTypeCallbackHandler.getCandidates(ValueTypeCompleter.java:445)
	at org.jboss.as.cli.impl.ValueTypeCompleter.complete(ValueTypeCompleter.java:332)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:254)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:74)
	at org.jboss.as.cli.CommandCompleter.doComplete(CommandCompleter.java:134)
	at org.jboss.as.cli.CommandCompleter.complete(CommandCompleter.java:63)
	at org.jboss.as.cli.impl.Console$Factory$1$1.complete(Console.java:143)
	at org.jboss.aesh.console.AeshCompletionHandler.complete(AeshCompletionHandler.java:155)
	at org.jboss.aesh.console.AeshInputProcessor.complete(AeshInputProcessor.java:423)
	at org.jboss.aesh.console.AeshInputProcessor.parseOperation(AeshInputProcessor.java:165)
	at org.jboss.aesh.console.Console.processInternalOperation(Console.java:773)
	at org.jboss.aesh.console.Console.execute(Console.java:733)
	at org.jboss.aesh.console.Console.access$900(Console.java:73)
	at org.jboss.aesh.console.Console$6.run(Console.java:642)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
{noformat}

when double tapping tab on the following:

{noformat}
[standalone@localhost:9990 /] /subsystem=jgroups/stack=anothertcp:add(transport={type=TCP,socket-binding=jgroups-tcp},protocols=[{
{noformat}

When trying a second time, it popped up again, so it is likely reproducible. Note that the server was started with:
{code}
./standalone -c standalone-ha.xml
{code}

The exception killed the CLI.",2016/09/06 4:36 AM
WFCORE-1768,"in {noformat}./jboss-eap-7.1/modules/system/layers/base/org/wildfly/security/elytron/main/module.xml {noformat}
there is {noformat} <exclude path=""org/wildfly/wildfly/security/manager/_private""/>{noformat}, which is probably unnecessary.


{noformat}
<module xmlns=""urn:jboss:module:1.3"" name=""org.wildfly.security.elytron"">

    <exports>
        <exclude path=""org/wildfly/security/_private""/>
        <exclude path=""org/wildfly/wildfly/security/manager/_private""/>
    </exports>
{noformat}",2016/09/06 4:07 AM
WFCORE-1762,"The removal of the deployment which is a dependency for other resources makes these dependent resources unusable. The deployment operation should not be completed in such conditions.

The information about the missing dependencies is now currently logged after the removal by the ContainerStateMonitor class.

Example:

{code}INFO  [org.jboss.as.server.deployment] (MSC service thread 1-6) WFLYSRV0028: Stopped deployment postgresql-9.4.1208.jar (runtime-name: postgresql-9.4.1208.jar) in 61ms
INFO  [org.jboss.as.server] (ServerService Thread Pool -- 65) WFLYSRV0009: Undeployed ""postgresql-9.4.1208.jar"" (runtime-name: ""postgresql-9.4.1208.jar"")
INFO  [org.jboss.as.repository] (ServerService Thread Pool -- 65) WFLYDR0002: Content removed from location /home/mjurc/testing/eap/7.0.0/jboss-eap-7.0/standalone/data/content/5c/7e80698b80a5045fe64daa67426051bbd16a56/content
INFO  [org.jboss.as.controller] (ServerService Thread Pool -- 65) WFLYCTL0183: Service status report
WFLYCTL0184:    New missing/unsatisfied dependencies:
      service jboss.jdbc-driver.postgresql-9_4_1208_jar (missing) dependents: [service jboss.driver-demander.java:/PostgresDS, service org.wildfly.data-source.PostgresDS] 
{code}
",2016/09/05 6:51 AM
WFCORE-1756,If overwrite is set to false then adding the file should fail.,2016/08/31 10:23 AM
WFCORE-1752,The deployment-overlay command fails to redeploy affected deployments if the runtime-name isn't the same as the deployment name. Since affected deployment to be redeployed should be running the couple runtime-name + enabled == true should be used to define which deployments are affected instead of using the deployment name since the name used in overlay is the runtime-name,2016/08/31 5:08 AM
WFCORE-1750,"EAP produces following warning upon undeployment:
{code}WARN  [org.jboss.as.controller] (management-handler-thread - 4) WFLYCTL0357: Notification of type deployment-undeployed is not described for the resource at the address []{code}

The warning is produced for both managed and unmanaged deployments.",2016/08/30 4:04 PM
WFCORE-1743,"I cannot get this operation to execute, even if I set validate-operation-requests to false in jboss-cli.xml:

{code}
[standalone@embedded /] /subsystem=datasources/bogus=*:read-resource-description
Failed to get the list of the operation properties: ""WFLYCTL0030: No resource definition is registered for address [
    (""subsystem"" => ""datasources""),
    (""bogus"" => ""*"")
]""
{code}

It is important that the CLI allows users to send whatever low level ops they wish to the server if they turn off verification. The server validates requests itself, and in some cases can be coded to be lenient about things (e.g. to let previous 'wrong' things work.) We don't want the CLI to get in the way of that by doing client side validation that cannot be turned off.

Problem seems to be this in the Util class:

{code}
    public static ModelNode toOperationRequest(CommandContext ctx,
            ParsedCommandLine parsedLine, Attachments attachments)
            throws CommandFormatException {
        return toOperationRequest(ctx, parsedLine, attachments, true);
    }
{code}

That 'true' param results in the CLI trying to do a background read-operation-description and failing the op if unsuccessful.",2016/08/27 10:23 AM
WFCORE-1737,"Run the following command in CLI it throws a NullPointerException
As it is a rrd it should not require a resolved wildcard

{code}
/subsystem=datasources/data-source=*/statistics=pool:read-resource-description
{code}

Results
{code}
{
    ""outcome"" => ""failed"",
    ""result"" => [],
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.NullPointerException"",
    ""rolled-back"" => true
}
{code}

The exception throws at server.log
{code}
ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 4) WFLYCTL0013: Operation (""resolve"") failed - address: ([]): java.lang.NullPointerException
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$AbstractAddressResolver.execute(GlobalOperationHandlers.java:422)
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$RegistrationAddressResolver.executeSingleTargetChild(GlobalOperationHandlers.java:903)
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$AbstractAddressResolver.execute(GlobalOperationHandlers.java:442)
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$RegistrationAddressResolver.executeMultiTargetChildren(GlobalOperationHandlers.java:895)
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$AbstractAddressResolver.execute(GlobalOperationHandlers.java:440)
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$RegistrationAddressResolver.executeSingleTargetChild(GlobalOperationHandlers.java:903)
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$AbstractAddressResolver.execute(GlobalOperationHandlers.java:442)
        at org.jboss.as.controller.operations.global.GlobalOperationHandlers$AbstractAddressResolver.execute(GlobalOperationHandlers.java:337)
        at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:951)
        at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:694)
        at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:389)
        at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1363)
        at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:410)
        at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:232)
        at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:213)
        at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$300(ModelControllerClientOperationHandler.java:136)
        at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
        at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:153)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:422)
        at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:149)
        at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:153)
        at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
        at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)
        at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}


This op works
{code}
/subsystem=datasources/data-source=*:read-resource-description
{code}",2016/08/25 2:51 PM
WFCORE-1731,"I started the embedded server and tried to obtain the connection information. An exception occurred:
{code}
[standalone@embedded /] connection-info
13:14:59,095 ERROR [org.jboss.as.controller.management-operation] (AeshProcess: 32) WFLYCTL0013: Operation (""whoami"") failed - address: ([]): java.lang.IllegalArgumentException: newValue is null
        at org.jboss.dmr.ModelNode.set(ModelNode.java:499)
        at org.jboss.as.domain.management.security.WhoAmIOperation.execute(WhoAmIOperation.java:95)
        at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:890)
        at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:659)
        at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:370)
        at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1344)
        at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:392)
        at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:204)
        at org.jboss.as.controller.ModelControllerImpl$3.execute(ModelControllerImpl.java:659)
        at org.jboss.as.controller.ModelControllerImpl$3.execute(ModelControllerImpl.java:649)
        at org.jboss.as.controller.client.helpers.DelegatingModelControllerClient.execute(DelegatingModelControllerClient.java:63)
        at org.jboss.as.cli.embedded.ThreadContextsModelControllerClient.execute(ThreadContextsModelControllerClient.java:59)
        at org.jboss.as.cli.handlers.ConnectionInfoHandler.doHandle(ConnectionInfoHandler.java:74)
        at org.jboss.as.cli.handlers.CommandHandlerWithHelp.handle(CommandHandlerWithHelp.java:88)
        at org.jboss.as.cli.impl.CommandContextImpl.handle(CommandContextImpl.java:776)
        at org.jboss.as.cli.impl.CommandContextImpl.handleSafe(CommandContextImpl.java:799)
        at org.jboss.as.cli.impl.CommandContextImpl$2.execute(CommandContextImpl.java:412)
        at org.jboss.aesh.console.AeshProcess.run(AeshProcess.java:53)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)

WFLYCTL0158: Operation handler failed: java.lang.IllegalArgumentException: newValue is null
Failed to handle 'connection-info': java.lang.NullPointerException
{code}",2016/08/25 12:52 AM
WFCORE-1730,"WILDFLY doesn't call ServiceLoader (META-INF/services/org.jboss.msc.service.ServiceActivator) when it is deployed in EAR/lib. The SingletonService (not a singleton EJB) is activated in the ServiceLoader so the SingletonService hasn't been activated from the first. It works as expected when deployed as an EJB (not in EAR/lib).

When the ServiceLoader is called, a message of ""HATimerService will be installed!"" is logged and the SingletonService will be activated.

$ fgrep -e HATimerService -e '[org.jboss.as.clustering.singleton]' domain/servers/server-one/log/server.log
12:14:52,373 INFO  [org.jboss.as.quickstarts.cluster.hasingleton.service.ejb.HATimerServiceActivator] (MSC service thread 1-7) HATimerService will be installed!
12:14:56,251 INFO  [org.jboss.as.clustering.singleton] (ServerService Thread Pool -- 54) JBAS010342: master:server-one/singleton elected as the singleton provider of the jboss.quickstart.ha.singleton.timer service
12:14:56,251 INFO  [org.jboss.as.clustering.singleton] (ServerService Thread Pool -- 54) JBAS010340: This node will now operate as the singleton provider of the jboss.quickstart.ha.singleton.timer service
12:14:56,268 INFO  [org.jboss.as.quickstarts.cluster.hasingleton.service.ejb.HATimerService] (MSC service thread 1-8) Start HASingleton timer service 'org.jboss.as.quickstarts.cluster.hasingleton.service.ejb.HATim
erService'
12:14:56,873 INFO  [org.jboss.as.clustering.singleton] (notification-thread-0) JBAS010342: master:server-one/singleton elected as the singleton provider of the jboss.quickstart.ha.singleton.timer service
",2016/08/24 11:28 AM
WFCORE-1729,"Test is failing about 5% of the time, although recently it seems like more. Failures are on Windows.

https://ci.wildfly.org/project.html?branch_WildFlyCore=__all_branches__&buildTypeId=&tab=testDetails&projectId=WildFlyCore&testNameId=6317148453350548512&itemsCount=50&order=TEST_STATUS_DESC&page=1",2016/08/23 12:17 PM
WFCORE-1717,"Toby Crawley reports:

- adding a duplicate extension under server > extensions causes an
   IllegalStateException that occurs when trying to generate the
   XMLStreamException
   (https://gist.github.com/tobias/59d155afe0c88e268b83cb75734353eb)

The problem happens because before the parser calls the invalidAttributeValue method to throw an exception, it has already consumed the element, preventing invalidAttributeValue working properly.

This should really be a custom exception that more clearly explains the problem, which is that the 'module' attribute value must be unique across the extension elements.",2016/08/15 7:11 PM
WFCORE-1716,"The ObjectName filtering logic added for WFLY-3161 does not handle queryMBeans and queryNames correctly in some cases where the ObjectName param to the method is a property list pattern (i.e. one that includes a simple '*' at the end of the list of properties, meaning ""all other properties besides previous ones whose keys were specifically enumerated, match"".)

The problem occurs when the the ObjectName does specifically include some keys, and those keys don't correspond to the final elements of the related management resource's PathAddress. As the RootResourceIterator walks the management resource tree, ModelControllerMBeanHelper.ObjectNameMatchResourceAction will not identify the parent resources of children that should match as matching, with the result that the iterator will not descend into that part of the tree and the children will not be matched. For example, this query will return an empty set because the /socket-binding-group=standard-sockets parent will not be matched, preventing checks of the socket-binding-group children.

{code}
Set<ObjectInstance> instances = connection.queryMBeans(createObjectName(""jboss.as:socket-binding=*,*""), null);
{code}",2016/08/15 5:21 PM
WFCORE-1712,"*Description of problem:*
org.jboss.as.test.manualmode.management.cli.CLIScriptSupportTestCase#testConnectStatus fails on pure-IPv6 machines

*How reproducible:*
100%

*Steps to Reproduce:*
# export PROXY_PARAMS=""-DproxySet=true -DproxyHost=proxy-01-ipv6.mw.lab.eng.bos.redhat.com -DproxyPort=3128 -Dhttp.proxyHost=proxy-01-ipv6.mw.lab.eng.bos.redhat.com -Dhttp.proxyPort=3128 -Dhttps.proxyHost=proxy-01-ipv6.mw.lab.eng.bos.redhat.com -Dhttps.proxyPort=3128"" 
# mvn install -Dmaven.repo.local=$MAVEN_REPO_LOCAL -fae -Dmaven.test.failure.ignore=true -Dnode0=$MYTESTIPV6_1 -Dipv6 $PROXY_PARAMS  -Dtest=CLIScriptSupportTestCase -Dts.manualmode -DfailIfNoTests=false

*Actual results:*
Stacktrace:
{noformat}java.lang.IllegalStateException: Unable to connect to controller.
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.xnio.nio.WorkerThread$ConnectHandle.handleReady(WorkerThread.java:319)
	at org.xnio.nio.WorkerThread.run(WorkerThread.java:559)
	at ...asynchronous invocation...(Unknown Source)
	at org.jboss.remoting3.EndpointImpl.doConnect(EndpointImpl.java:294)
	at org.jboss.remoting3.EndpointImpl.doConnect(EndpointImpl.java:276)
	at org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:393)
	at org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:381)
	at org.jboss.as.protocol.ProtocolConnectionUtils.connect(ProtocolConnectionUtils.java:83)
	at org.jboss.as.protocol.ProtocolConnectionUtils.connectSync(ProtocolConnectionUtils.java:114)
	at org.jboss.as.protocol.ProtocolConnectionManager$EstablishingConnection.connect(ProtocolConnectionManager.java:257)
	at org.jboss.as.protocol.ProtocolConnectionManager.connect(ProtocolConnectionManager.java:71)
	at org.jboss.as.protocol.mgmt.FutureManagementChannel$Establishing.getChannel(FutureManagementChannel.java:218)
	at org.jboss.as.cli.impl.CLIModelControllerClient.getOrCreateChannel(CLIModelControllerClient.java:179)
	at org.jboss.as.cli.impl.CLIModelControllerClient$3.getChannel(CLIModelControllerClient.java:138)
	at org.jboss.as.protocol.mgmt.ManagementChannelHandler.executeRequest(ManagementChannelHandler.java:147)
	at org.jboss.as.protocol.mgmt.ManagementChannelHandler.executeRequest(ManagementChannelHandler.java:122)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.executeRequest(AbstractModelControllerClient.java:263)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.execute(AbstractModelControllerClient.java:168)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.executeForResult(AbstractModelControllerClient.java:147)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.execute(AbstractModelControllerClient.java:75)
	at org.jboss.as.cli.impl.CommandContextImpl.tryConnection(CommandContextImpl.java:1157)
	at org.jboss.as.cli.impl.CommandContextImpl.connectController(CommandContextImpl.java:1003)
	at org.jboss.as.cli.impl.CommandContextImpl.connectController(CommandContextImpl.java:980)
	at org.jboss.as.cli.scriptsupport.CLI.doConnect(CLI.java:278)
	at org.jboss.as.cli.scriptsupport.CLI.connect(CLI.java:82)
	at org.jboss.as.test.manualmode.management.cli.CLIScriptSupportTestCase.testConnectStatus(CLIScriptSupportTestCase.java:87)

 Standard Output
 Standard Error
	5.6 sec
{noformat}

Test output:
{noformat}&amp#27;[0m09:15:56,815 INFO  [org.jboss.modules] (main) JBoss Modules version 1.5.2.Final-redhat-1
&amp#27;[0m&amp#27;[0m09:15:57,137 INFO  [org.jboss.msc] (main) JBoss MSC version 1.2.6.Final-redhat-1
&amp#27;[0m&amp#27;[0m09:15:57,331 INFO  [org.jboss.as] (MSC service thread 1-4) WFLYSRV0049: WildFly Core 2.2.0.CR7-redhat-1 ""Kenny"" starting
&amp#27;[0m&amp#27;[33m09:16:00,230 WARN  [org.jboss.as.domain.management.security] (MSC service thread 1-3) WFLYDM0111: Keystore /mnt/hudson_workspace/eap-7x-as-testsuite-test-core-rhel-ipv6-CLIScriptSupport/49bf0d07/testsuite/manualmode/target/wildfly-core/standalone/configuration/application.keystore not found, it will be auto generated on first use with a self signed certificate for host localhost
&amp#27;[0m&amp#27;[0m09:16:00,413 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: WildFly Core 2.2.0.CR7-redhat-1 ""Kenny"" started in 3532ms - Started 37 of 46 services (17 services are lazy, passive or on-demand)
&amp#27;[0m09:16:00,477 INFO  [org.jboss.as.cli.CommandContext] (main) Warning! The CLI is running in a non-modular environment and cannot load commands from management extensions.
Warning! The CLI is running in a non-modular environment and cannot load commands from management extensions.
&amp#27;[0m09:16:00,699 INFO  [org.jboss.as] (MSC service thread 1-2) WFLYSRV0050: WildFly Core 2.2.0.CR7-redhat-1 ""Kenny"" stopped in 86ms
&amp#27;[0m&amp#27;[0m09:16:00,715 INFO  [org.jboss.as] (MSC service thread 1-4) WFLYSRV0049: WildFly Core 2.2.0.CR7-redhat-1 ""Kenny"" starting
&amp#27;[0m&amp#27;[0m09:16:00,943 INFO  [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0039: Creating http management service using socket-binding (management-http)
&amp#27;[0m&amp#27;[0m09:16:01,083 INFO  [org.xnio] (MSC service thread 1-1) XNIO version 3.3.6.Final-redhat-1
&amp#27;[0m&amp#27;[0m09:16:01,143 INFO  [org.xnio.nio] (MSC service thread 1-1) XNIO NIO Implementation Version 3.3.6.Final-redhat-1
&amp#27;[0m&amp#27;[33m09:16:01,438 WARN  [org.jboss.as.domain.management.security] (MSC service thread 1-3) WFLYDM0111: Keystore /mnt/hudson_workspace/eap-7x-as-testsuite-test-core-rhel-ipv6-CLIScriptSupport/49bf0d07/testsuite/manualmode/target/wildfly-core/standalone/configuration/application.keystore not found, it will be auto generated on first use with a self signed certificate for host localhost
&amp#27;[0m&amp#27;[0m09:16:01,505 INFO  [org.jboss.remoting] (MSC service thread 1-2) JBoss Remoting version 4.0.21.Final-redhat-1
&amp#27;[0m&amp#27;[33m09:16:01,753 WARN  [org.jboss.as.domain.http.api.undertow] (MSC service thread 1-1) WFLYDMHTTP0003: Unable to load console module for slot main, disabling console
&amp#27;[0m&amp#27;[0m09:16:01,944 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0060: Http management interface listening on http://127.0.0.1:9990/management
&amp#27;[0m&amp#27;[0m09:16:01,946 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0051: Admin console listening on http://127.0.0.1:9990
&amp#27;[0m&amp#27;[0m09:16:01,946 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: WildFly Core 2.2.0.CR7-redhat-1 ""Kenny"" started in 1221ms - Started 59 of 62 services (20 services are lazy, passive or on-demand)
&amp#27;[0m&amp#27;[0m09:16:02,188 INFO  [org.jboss.as] (MSC service thread 1-1) WFLYSRV0050: WildFly Core 2.2.0.CR7-redhat-1 ""Kenny"" stopped in 55ms
{noformat}

*Expected results:*
No errors

*Additional info:*
Jenkins reproducer job: https://jenkins.mw.lab.eng.bos.redhat.com/hudson/view/EAP7/view/EAP7-AS-Testsuite/view/EAP7-AS-Testsuite-Reproducers/job/eap-7x-as-testsuite-test-core-rhel-ipv6-CLIScriptSupport/",2016/08/11 3:35 PM
WFCORE-1710,The WFCORE-1106 work for checking the runtime status of a capability assumes that only CapabilityScope.GLOBAL should be relevant when the check is performed. But this omits HostCapabilityScope which comes into play when host controller subsystems are used.,2016/08/11 12:39 PM
WFCORE-1706,"For an unmanaged deployment if you replace it using the CLI deploy command it becomes managed.
To reproduce:
{code:java}
deploy /home/ehsavoie/dev/wildfly/quickstart/kitchensink-ear/ear/target/wildfly-kitchensink-ear.ear --unmanaged
deploy /home/ehsavoie/dev/wildfly/quickstart/kitchensink-ear/ear/target/wildfly-kitchensink-ear.ear --unmanaged --force
{code}
After the second command the deployment is managed.",2016/08/10 1:01 PM
WFCORE-1704,"Help message for connect command refers to old default protocol.
./cli/src/main/resources/help/connect.txt:  In this case, the default port will be 9990 and the default protocol will be http 
",2016/08/10 2:39 AM
WFCORE-1702,"Current implementation of class {{StringBytesLengthValidator}} which is used by {{TransactionSubsystemRootResourceDefinition}} for validation of {{node-identifier}} element prints error message in format

{code}
Caused by: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[356,13]
Message: ""WFLYCTL0112: '' is an invalid value for parameter node-identifier. Values must have a maximum length of 23 characters""
{code}

but the validator does not count characters of the string but bytes of the string. Then could occur if some none-ascii character are part of the {{node id}} that the string has length smaller than {{23}} but the message says that it's bigger.",2016/08/09 10:53 AM
WFCORE-1699,"Inefficient usage of map iterators

{code}
Map<String, CommandArgument> options = getDynamicOptions(ctx);
for (String k : options.keySet()) {
   args.add(options.get(k));
}
{code}
can be replaced with {{args.addAll(getDynamicOptions(ctx).values());}}",2016/08/08 8:45 AM
WFCORE-1698,Implementation and help don't mention the headers. It shouldn't appear in completion.,2016/08/05 11:32 AM
WFCORE-1695,"*Description:*
echo command prints all variables in tab auto-complete even without typing $ prefix
This duplicates functionality of 'set' with no arguments. 

*Steps to reproduce*
{code:bash}
[disconnected /] set myvar1=value1
[disconnected /] set myvar2=value2
[disconnected /] set
myvar1=value1
myvar2=value2
{code}

*Actual*

{code:bash}
[disconnected /] echo <TAB>
--help  myvar1  myvar2   #should not suggest variables
[disconnected /] echo $<TAB>myvar<TAB> #expected, auto-completes with $prefix
myvar1  myvar2  
[disconnected /] echo myvar<TAB> #autocompletes variable without $prefix
myvar1  myvar2  
{code}

*Expected*

{code:bash}
[disconnected /] echo <TAB>
--help
[disconnected /] echo $<TAB>myvar<TAB>
myvar1  myvar2  
[disconnected /] echo myvar<TAB> #does not suggest anything
{code}


",2016/08/04 4:59 AM
WFCORE-1687,"EAP produces following warning upon undeployment:
{code}WARN  [org.jboss.as.controller] (management-handler-thread - 4) WFLYCTL0357: Notification of type deployment-undeployed is not described for the resource at the address []{code}

The warning is produced for both managed and unmanaged deployments.",2016/08/02 10:41 AM
WFCORE-1686,"{noformat}
15:07:56,793 FATAL [org.jboss.as.server] (main) WFLYSRV0239: Aborting with exit code 1
{noformat}
appears at the end of help for standalone server.

*reproduce*
{noformat}
bash standalone.sh --help
{noformat}

The issues is a regression against 7.0.0",2016/08/02 9:18 AM
WFCORE-1682,"Tab completion for edit-batch-list command suggest to use --line-number as a command option, but that is not how the command works.

*command usage*
{noformat}
[standalone@localhost:9990 /] batch 
[standalone@localhost:9990 / #] :read-resource
[standalone@localhost:9990 / #] list-batch 
#1 /:read-resource
[standalone@localhost:9990 / #] edit-batch-line 1 :read-attribute(name=launch-type)
#1 :read-attribute(name=launch-type)
[standalone@localhost:9990 / #] list-batch 
#1 :read-attribute(name=launch-type)
{noformat}
*actual*
{noformat}
[standalone@localhost:9990 / #] edit-batch-line <TAB>
[standalone@localhost:9990 / #] edit-batch-line --<TAB>
--help  --line-number
[standalone@localhost:9990 / #] edit-batch-line --line-number=1 :read-attribute(name=launch-type)
Failed to parse line number '--line-number=1': For input string: ""--line-number=1""
{noformat}
{{--line-number}} shouldn't be offered by tab completion for the command.
Misleading tab completion ends up with syntax error.
*expected*
{noformat}
[standalone@localhost:9990 / #] edit-batch-line <TAB>
--help
{noformat}

The issue is a regression against EAP 7.0.0 release.",2016/08/01 3:36 AM
WFCORE-1680,"Tab completion for echo-dmr command doesn't work.

To reproduce, start the standalone server and connect with CLI
*actual 3.0.0.Alpha5-SNAPSHOT 77673c5*
{noformat}
[standalone@localhost:9990 /] echo-dmr /sub[TAB]
core-service  deployment  deployment-overlay  extension  interface  path  socket-binding-group  subsystem  system-property
[standalone@localhost:9990 /] echo-dmr /subsystem=log[TAB]
core-service  deployment  deployment-overlay  extension  interface  path  socket-binding-group  subsystem  system-property
{noformat}

*expected*
{noformat}
[standalone@localhost:9990 /] echo-dmr /sub[TAB]
[standalone@localhost:9990 /] echo-dmr /subsystem=
[standalone@localhost:9990 /] echo-dmr /subsystem=log[TAB]
[standalone@localhost:9990 /] echo-dmr /subsystem=logging
{noformat}

The issue is not reproducible with 2.2.0.CR7 (EAP 7.1.0.DR1).",2016/07/29 8:34 AM
WFCORE-1679,"The current plugin does not reac to the connect/dissconnect button. causing an error in the next use case:

1) loing
2) show the jconsole tb
3) disconnect jconsole
4) connect jconsole again

try to execute anything jconsole tab plugin",2016/07/29 4:50 AM
WFCORE-1676,"read-attribute --node=interface=public namespaces should fail and fails
read-attribute namespaces --node=interface=public should fail and doesn't
read-attribute --node=interface=public init-address should succeed and succeeds
read-attribute init-address --node=interface=public should succeed and fails

This is due to some logic in place to retrieve the node value.",2016/07/27 12:30 PM
WFCORE-1657,"Using tab completion for adding a module dependencies with {{module add}} command could lead to invalid module.xml as CLI prompt user to use module name with ""system.layers.base"" prefix, which is not a part of module name.

*reproduce*
Add a new module via {{module add}} command, use tab-completion for dependencies
{noformat}
module add --name=<name> --resources=<path_to_jar> --dependencies=<TAB>
module add --name=<name> --resources=<path_to_jar> --dependencies=system.<TAB>
module add --name=<name> --resources=<path_to_jar> --dependencies=system.layers.<TAB>
module add --name=<name> --resources=<path_to_jar> --dependencies=system.layers.base.<TAB>
asm  ch  com  gnu  ibm  io  javaee  javax  net  nu  org  sun 
{noformat}
this way something like following is generated in module.xml file
{code:xml}
<dependencies>
    <module name=""system.layers.base.org.jboss.as.controller""/>
</dependencies>
{code}
however correct module name is {{org.jboss.as.controller}}

",2016/07/15 7:51 AM
WFCORE-1655,"When the CLI is connected to the controller, patch info reflects the outcome of read-resource operation. It could be basic info or extended (--verbose).
In the offline mode though, the only information available is the basic one. It is actually limited by the tool's API, which means it never meant to support --verbose.
This difference is not reflected in the help content of the command and simply looks like an inconsistent behavior of the same command depending on the connection status.

Another issue with the offline mode is that, the current version was not propagated to the CLI and would always read ""Unknown"" for the user.",2016/07/14 11:30 AM
WFCORE-1645,"https://github.com/jfdenise/wildfly-core/blob/c023b0bd21d35d8f96c5d99fe4a2ecd24ed76bb3/cli/src/main/resources/help/module.txt#L42

Whitespace indent is missing for --module-root-dir and --name options
{noformat}
ARGUMENTS

--module-root-dir - (optional) The absolute file path to the server's modules 
                    directory. By default the module is added to (or removed from)
                    JBOSS_HOME/modules
 
--name          - (required) the name of the module to be added or removed.
                   NOTE: slot is not a part of the module name.

 --slot          - (optional) specifies a slot which should be created or
                   removed. If this argument is not specified, ""main"" slot is
                   assumed.
...
{noformat}",2016/07/11 2:32 AM
WFCORE-1642,The configuration changes feature is broken in domain mode: the propagation to managed servers / slaves HC doesn't work properly.  Once set it will fail on restarting the DC. So we need a clean refactoring of the feature to have a usable domain mode.,2016/07/08 11:12 AM
WFCORE-1640,"DeploymentScannerUnitTestCase.testStartup() has been failing intermittently since May:

https://ci.wildfly.org/project.html?projectId=WildFlyCore&buildTypeId=&tab=testDetails&testNameId=-2364482317512802563&order=TEST_STATUS_DESC&branch_WildFlyCore=__all_branches__&itemsCount=50

The May 4 failure is the first that was not associated with some large scale failure; i.e. is more likely to be relevant to the test itself.

I'll send up a PR to @Ignore this test.",2016/07/07 1:21 PM
WFCORE-1639,"I am raising this immediately as a Blocker as the changes made for WFCORE-307 effectively prevent us from referencing Elytron supplied capabilities to secure the management interfaces.

https://github.com/wildfly/wildfly-core/commit/13d8f51b79c8b976ec7a5489c94f0e8a8bda998d

I think at this point it would be easier to revert WFCORE-307 and re-evaluate.

To provide consistency we have all been working along the path where Elytron can be configured using a subsystem and used in all modes of the server, this was even a big motivation for Kabir's work bringing subsystems to host controllers.

We could take the view that only subsystems can depend on subsystems but I think we would quickly reach the point where we discuss moving management into a subsystem which would immediately obsolete the changes for WFCORE-307 - this move is something that has been talked about a number of times already.

This will need discussion but as an alternative idea for the original issue reported in WFCORE-307, how about adding the ability to flag a select few capabilities as crtitical / core and those will always cause a failure in this first boot if their requirements are not satisfied.

Also I think WFCORE-307 may only be a partial solution, if we are really saying the server can only run if it is manageable there is still the possibility that at stage RUNTIME the services will fail to start.
",2016/07/07 5:30 AM
WFCORE-1637,"For example:
1) ls --headers {allow-resource-service-restart <TAB>
doesn't give you the '='

2) ls --headers {allow-resource-service-restart=true; <TAB>
list you the commands one can type...not at al an header.

3) NPE caused by  WFCORE-1617
ls --headers {allow-resource-service-restart=t<TAB> ==> NPE

Completion should properly complete each header.",2016/07/06 3:33 PM
WFCORE-1636,"- ls -l --storage will make the CLI to throw an exception. storage being not known by the Command runtime.
- Furthermore completion is not offered for these options.
",2016/07/05 11:58 AM
WFCORE-1632,"When stopping server which is processing request, it terminates the connection from the client but doesn't stop the request processing as such.

After debugging and searching when the issue appeared I've found out that the issue was introduced with this commit: [https://github.com/wildfly/wildfly-core/commit/7304c019705c5f7ec0378e1c51750432591f73d2]

Steps to reproduce:
1) start EAP server with deployed app from attachment
2) create request to long running application: {{curl -i http://127.0.0.1:8080/long-running-servlet/HeavyProcessing?duration=25000}}
3) stop server (you can do it even gracefully) using {{./jboss-cli.sh -c "":shutdown(timeout=1)""}}

See that server is stopped after 25 seconds since request from step 2 was issued, as that is duration of the request processing requested by param duration, instead of being terminated after 1 second.",2016/07/03 10:53 PM
WFCORE-1630,"When running in domain mode and using indexed resources, applying of model in domain can fail with assertion error if assertions are enabled.

{noformat}
[Host Controller] 16:42:39,979 ERROR [org.jboss.as.controller.management-operation] (Host Controller Service Threads - 11) WFLYCTL0013: Operation (""apply-remote-domain-model"") failed - address: ([]): java.lang.AssertionError: Unknown operation undefine-attribute
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler$OrderedOperationsCollection.add(SyncModelOperationHandler.java:704)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.processAttributes(SyncModelOperationHandler.java:203)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.compareExistsInBothModels(SyncModelOperationHandler.java:443)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.processNonOrderedChildrenOfType(SyncModelOperationHandler.java:341)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.processChildren(SyncModelOperationHandler.java:229)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.compareExistsInBothModels(SyncModelOperationHandler.java:446)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.processNonOrderedChildrenOfType(SyncModelOperationHandler.java:341)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.processChildren(SyncModelOperationHandler.java:229)
[Host Controller] 	at org.jboss.as.domain.controller.operations.SyncModelOperationHandler.execute(SyncModelOperationHandler.java:155)
[Host Controller] 	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:890)
[Host Controller] 	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:659)
[Host Controller] 	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:370)
[Host Controller] 	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1329)
[Host Controller] 	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:400)
[Host Controller] 	at org.jboss.as.controller.AbstractControllerService.internalExecute(AbstractControllerService.java:409)
[Host Controller] 	at org.jboss.as.host.controller.DomainModelControllerService.access$1000(DomainModelControllerService.java:179)
[Host Controller] 	at org.jboss.as.host.controller.DomainModelControllerService$InternalExecutor.execute(DomainModelControllerService.java:1255)
[Host Controller] 	at org.jboss.as.host.controller.RemoteDomainConnectionService.applyRemoteDomainModel(RemoteDomainConnectionService.java:575)
[Host Controller] 	at org.jboss.as.host.controller.RemoteDomainConnectionService.access$1100(RemoteDomainConnectionService.java:131)
[Host Controller] 	at org.jboss.as.host.controller.RemoteDomainConnectionService$2.applyDomainModel(RemoteDomainConnectionService.java:518)
[Host Controller] 	at org.jboss.as.host.controller.RemoteDomainConnection.applyDomainModel(RemoteDomainConnection.java:311)
[Host Controller] 	at org.jboss.as.host.controller.RemoteDomainConnection$RegisterSubsystemsRequest$1.execute(RemoteDomainConnection.java:454)
[Host Controller] 	at org.jboss.as.protocol.mgmt.AbstractMessageHandler$ManagementRequestContextImpl$1.doExecute(AbstractMessageHandler.java:363)
[Host Controller] 	at org.jboss.as.protocol.mgmt.AbstractMessageHandler$AsyncTaskRunner.run(AbstractMessageHandler.java:472)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
{noformat}

This was observed in a failure of OrderedChildResourcesTestCase.

Failed tests:
  OrderedChildResourcesTestCase.testOrderedChildResources:124 expected:<{
    ""protocol"" => {
        ""MPING"" => undefined,
        ""MERGE3"" => undefined,
        ""FD_SOCK"" => undefined,
        ""FD"" => undefined,
        ""VERIFY_SUSPECT"" => undefined,
        ""pbcast.NAKACK2"" => undefined,
        ""UNICAST3"" => undefined,
        ""pbcast.STABLE"" => undefined,
        ""pbcast.GMS"" => undefined,
        ""MFC"" => undefined,
        ""FRAG2"" => undefined
    },
    ""relay"" => undefined,
    ""transport"" => {
        ""TRANSPORT"" => undefined,
        ""TCP"" => undefined
    }
}> but was:<{
    ""protocol"" => {
        ""MPING"" => undefined,
        ""MERGE3"" => undefined,
        ""FD_SOCK"" => undefined,
        ""VERIFY_SUSPECT"" => undefined,
        ""pbcast.NAKACK2"" => undefined,
        ""UNICAST3"" => undefined,
        ""pbcast.STABLE"" => undefined,
        ""pbcast.GMS"" => undefined,
        ""MFC"" => undefined,
        ""FRAG2"" => undefined
    },
    ""relay"" => undefined,
    ""transport"" => {
        ""TRANSPORT"" => undefined,
        ""TCP"" => undefined
    }
}>",2016/06/29 6:51 PM
WFCORE-1629,"While creating a WildFly Swarm Fraction that exposes the management console, I debugged ConsoleMode and found out that a NullPointerException is thrown in the {{findConsoleVersions}} methods. That's because the {{module.path}} returns {{null}} (as specified in the default value in this same method).

A simple null check is enough to fix it.",2016/06/29 6:18 PM
WFCORE-1627,"CLI tab completion cannot be used in the middle of the command. Whole command is taken as a context, ignoring the current position of prompt. Auto-completed string is inserted to the current position of the prompt (no matter it can be placed in the middle of the command).

[] is used to show the current position of the prompt
*actual*
tab completion in the middle doesn't work
{noformat}
/subsystem=loggin[]<TAB>/root-logger=ROOT
/subsystem=loggin[]/root-logger=ROOT
{noformat}
tab completion with prompt in the middle
{noformat}
/subsystem=logging/[]<TAB>root-logger=R
/subsystem=logging/ROOT[]root-logger=R
{noformat}

*expected*
tab completion in the middle works
{noformat}
/subsystem=loggin[]<TAB>/root-logger=ROOT
/subsystem=logging[]/root-logger=ROOT
{noformat}

tab completion with prompt in the middle doesn't add anything unless it's a valid part of the command
{noformat}
/subsystem=logging/[]<TAB>root-logger=R
/subsystem=logging/[]root-logger=R
{noformat}",2016/06/29 5:32 AM
WFCORE-1625,"The ouput of :read-resource-description is missing some metadata for operations compared to :read-operation-description:


{noformat}
[domain@localhost:9990 /] /profile=default:read-resource-description(operations=true)
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""description"" => ""A named set of subsystem configurations."",
        ...
        ""operations"" => {
            ...
            ""read-attribute-group-names"" => {
                ""operation-name"" => ""read-attribute-group-names"",
                ""description"" => ""Gets the names of all the attribute groups under the selected resource"",
                ""request-properties"" => {},
                ""reply-properties"" => {
                    ""type"" => LIST,
                    ""value-type"" => STRING
                }
            },
            ...
}
[domain@localhost:9990 /] /profile=default:read-operation-description(name=read-attribute-group-names)
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""read-attribute-group-names"",
        ""description"" => ""Gets the names of all the attribute groups under the selected resource"",
        ""request-properties"" => {},
        ""reply-properties"" => {
            ""type"" => LIST,
            ""value-type"" => STRING
        },
        ""read-only"" => true,
        ""runtime-only"" => true
    }
}
{noformat}

At least read-only and runtime-only metadata are missing (when they are set on the operation).",2016/06/28 11:52 AM
WFCORE-1622,"I want to dynamically configure following section in IO subsystem in standalone.xml of wildfly:

{code:xml}
<worker name=""default"" io-threads=""100"" task-max-threads=""1000""/>
{code}

Here if I do something like:
{code:xml}
<worker name=""default"" io-threads=""${my.io.threads:100}"" task-max-threads=""${my.task.max.threads:1000}""/>
{code}
And pass parameters as -Dmy.io.threads, -Dmy.task.max.threads while starting wildfly server, it's failing to parse standalone.xml with following exception:

{code}
ERROR [org.jboss.as.server] (Controller Boot Thread) JBAS015956: Caught exception during boot:
org.jboss.as.controller.persistence.ConfigurationPersistenceException: JBAS014676: Failed to parse configuration 
at org.jboss.as.controller.persistence.XmlConfigurationPersister.load(XmlConfigurationPersister.java:112) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.server.ServerService.boot(ServerService.java:331) [wildfly-server-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:259) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at java.lang.Thread.run(Thread.java:745) [rt.jar:1.8.0_45] Caused by: java.lang.NumberFormatException: For input string: ""${my.io.threads:100}"" 
at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65) [rt.jar:1.8.0_45] 
at java.lang.Integer.parseInt(Integer.java:569) [rt.jar:1.8.0_45] at java.lang.Integer.parseInt(Integer.java:615) [rt.jar:1.8.0_45] 
at org.jboss.dmr.StringModelValue.asInt(StringModelValue.java:139) [jboss-dmr-1.2.0.Final.jar:1.2.0.Final] 
at org.jboss.dmr.ModelNode.asInt(ModelNode.java:240) [jboss-dmr-1.2.0.Final.jar:1.2.0.Final] 
at org.jboss.as.controller.AttributeParser.parse(AttributeParser.java:116) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.controller.AttributeParser.parse(AttributeParser.java:82) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.controller.AttributeParser$DiscardOldDefaultValueParser.parse(AttributeParser.java:177) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.controller.AttributeParser.parseAndSetParameter(AttributeParser.java:61) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.controller.PersistentResourceXMLDescription.parse(PersistentResourceXMLDescription.java:83) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.controller.PersistentResourceXMLDescription.parseChildren(PersistentResourceXMLDescription.java:135) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.controller.PersistentResourceXMLDescription.parse(PersistentResourceXMLDescription.java:107) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final] 
at org.wildfly.extension.io.IOSubsystemParser_1_0.readElement(IOSubsystemParser_1_0.java:71) 
at org.wildfly.extension.io.IOSubsystemParser_1_0.readElement(IOSubsystemParser_1_0.java:41) 
at org.jboss.staxmapper.XMLMapperImpl.processNested(XMLMapperImpl.java:110) [staxmapper-1.1.0.Final.jar:1.1.0.Final] 
at org.jboss.staxmapper.XMLExtendedStreamReaderImpl.handleAny(XMLExtendedStreamReaderImpl.java:69) [staxmapper-1.1.0.Final.jar:1.1.0.Final] 
at org.jboss.as.server.parsing.StandaloneXml.parseServerProfile(StandaloneXml.java:1131) [wildfly-server-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.server.parsing.StandaloneXml.readServerElement_1_4(StandaloneXml.java:458) [wildfly-server-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.server.parsing.StandaloneXml.readElement(StandaloneXml.java:145) [wildfly-server-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.as.server.parsing.StandaloneXml.readElement(StandaloneXml.java:107) [wildfly-server-8.2.0.Final.jar:8.2.0.Final] 
at org.jboss.staxmapper.XMLMapperImpl.processNested(XMLMapperImpl.java:110) [staxmapper-1.1.0.Final.jar:1.1.0.Final] 
at org.jboss.staxmapper.XMLMapperImpl.parseDocument(XMLMapperImpl.java:69) [staxmapper-1.1.0.Final.jar:1.1.0.Final]
 at org.jboss.as.controller.persistence.XmlConfigurationPersister.load(XmlConfigurationPersister.java:104) [wildfly-controller-8.2.0.Final.jar:8.2.0.Final]
 ... 3 more
{code}

This section should allow expressions.",2016/06/27 1:29 AM
WFCORE-1836,"For rejection-style transformer tests, the subsystem test framework stores expected rejected operations in a map keyed by PathAddress.  This is fine when the subsystem's parser only generates add operations.  However, if the parser generates an add operation as well as a a write-attribute operation, these 2 operations will have the same path address.  If we expect one of these operations to be rejected, but not the other, we end up with an unexpected rejection - and the test fails.
This is a little hard to explain in the abstract, so let me know if any of the above doesn't make sense.",2016/06/23 4:41 PM
WFCORE-1611,"Interruption a CLI session with Ctrl+C during authentication dialogue could get CLI into unresponsive state.

*reproduce*
Either use a remote server, --no-local-auth cli script arg or remove a local element from ManagementRealm configuration
{code:diff}
         <security-realms>
             <security-realm name=""ManagementRealm"">
                 <authentication>
-                    <local default-user=""$local"" skip-group-loading=""true""/>
{code}
start a standalone server and launch a CLI
{noformat}
[pkremens@localhost] $ ./standalone.sh &
[pkremens@localhost] $ ./jboss-cli.sh
[disconnected /] connect
Authenticating against security realm: ManagementRealm
Username: <Press Ctrl+C here>
{noformat}
Could not connect message is printed, but process is not terminated and stuck at this point.
{noformat}
The controller is not available at localhost:9990: java.net.ConnectException: WFLYPRT0023: Could not connect to http-remoting://localhost:9990. The connection timed out: WFLYPRT0023: Could not connect to http-remoting://localhost:9990. The connection timed out
{noformat}

Only way to recover the terminal is to SIGKILL the CLI process.",2016/06/22 4:49 AM
WFCORE-1783,"When in the CLI GUI, if you try to edit a boolean attribute whose current value is an expression then an exception is thrown and you can't edit it - the popup dialog is really small and blank.

See ""Steps to Reproduce"" for replication procedures.

Here's the exception:

java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.asBoolean(ModelValue.java:66)
	at org.jboss.dmr.ModelNode.asBoolean(ModelNode.java:262)
	at org.jboss.as.cli.gui.OperationDialog$RequestProp.setInputComponentValue(OperationDialog.java:428)
	at org.jboss.as.cli.gui.OperationDialog$RequestProp.<init>(OperationDialog.java:336)
	at org.jboss.as.cli.gui.OperationDialog.setProps(OperationDialog.java:157)
	at org.jboss.as.cli.gui.OperationDialog.<init>(OperationDialog.java:73)
	at org.jboss.as.cli.gui.OperationMenu$OperationAction.actionPerformed(OperationMenu.java:152)
	at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2022)
	at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2348)
	at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
	at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
	at javax.swing.AbstractButton.doClick(AbstractButton.java:376)
	at javax.swing.plaf.basic.BasicMenuItemUI.doClick(BasicMenuItemUI.java:833)
	at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(BasicMenuItemUI.java:877)
	at java.awt.AWTEventMulticaster.mouseReleased(AWTEventMulticaster.java:289)
	at java.awt.Component.processMouseEvent(Component.java:6535)
	at javax.swing.JComponent.processMouseEvent(JComponent.java:3324)
	at java.awt.Component.processEvent(Component.java:6300)
	at java.awt.Container.processEvent(Container.java:2236)
	at java.awt.Component.dispatchEventImpl(Component.java:4891)
	at java.awt.Container.dispatchEventImpl(Container.java:2294)
	at java.awt.Component.dispatchEvent(Component.java:4713)
	at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4888)
	at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4525)
	at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4466)
	at java.awt.Container.dispatchEventImpl(Container.java:2280)
	at java.awt.Window.dispatchEventImpl(Window.java:2750)
	at java.awt.Component.dispatchEvent(Component.java:4713)
	at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:758)
	at java.awt.EventQueue.access$500(EventQueue.java:97)
	at java.awt.EventQueue$3.run(EventQueue.java:709)
	at java.awt.EventQueue$3.run(EventQueue.java:703)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(ProtectionDomain.java:76)
	at java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(ProtectionDomain.java:86)
	at java.awt.EventQueue$4.run(EventQueue.java:731)
	at java.awt.EventQueue$4.run(EventQueue.java:729)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(ProtectionDomain.java:76)
	at java.awt.EventQueue.dispatchEvent(EventQueue.java:728)
	at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:201)
	at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:116)
	at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:105)
	at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:101)
	at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:93)
	at java.awt.EventDispatchThread.run(EventDispatchThread.java:82)


",2016/06/17 9:44 AM
WFCORE-1606,"When security-realm, which is set as http-interface security-realm in management-interfaces, is modified and operation used {allow-resource-service-restart=true} header then server is NOT in reload-required state but modified security realm does not work correctly until server is manually reloaded.",2016/06/17 8:24 AM
WFCORE-1595,"Tab completion for CLI unalias commend doesn't seem to work. CLI will suggest available option, but doesn't autocomplete.

*actual*
{noformat}
[standalone@localhost:9990 /] unalias read_<TAB>
  read_undertow  
[standalone@localhost:9990 /] unalias read_<TAB>
  read_undertow 
{noformat}

*expected*
{noformat}
[standalone@localhost:9990 /] unalias read_<TAB>
[standalone@localhost:9990 /] unalias read_undertow
{noformat}",2016/06/15 6:10 AM
WFCORE-1592,"There is a bug in PropertiesFileLoader#persistProperties, specifically [here|https://github.com/wildfly/wildfly-core/blob/master/domain-management/src/main/java/org/jboss/as/domain/management/security/PropertiesFileLoader.java#L230-L238]. Because of the write call in the else block, properties are persisted to the file even after they have been deleted in memory.

[Here|https://github.com/psiroky/uberfire/blob/2811baeac64805646d3943a096e77cf56d5fdc26/uberfire-extensions/uberfire-security/uberfire-security-management/uberfire-security-management-wildfly/src/main/java/org/uberfire/ext/security/management/wildfly/properties/WildflyUserPropertiesManager.java#L221-L246] is a fixed implementation of persistProperties that we are using as a workaround.",2016/06/13 2:50 PM
WFCORE-1590,"With the following attribute definition: -

{code:java}
    static final SimpleAttributeDefinition REPLACEMENT = new SimpleAttributeDefinitionBuilder(ElytronDescriptionConstants.REPLACEMENT, ModelType.STRING, false)
        .setAllowExpression(true)
        .setMinSize(0)
        .setFlags(AttributeAccess.Flag.RESTART_RESOURCE_SERVICES)
        .build();
{code}

The following error is reported if an empty string is used as a parameter: -

{noformat}

[standalone@localhost:9990 /] ./subsystem=elytron/regex-name-rewriter=strip-realm:add(pattern=""@ELYTRON.ORG"", replacement="""", replace-all=true)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0113: '' is an invalid value for parameter replacement. Values must have a minimum length of 1 characters"",
    ""rolled-back"" => true
}
{noformat}

",2016/06/12 10:18 AM
WFCORE-1580,"Say I have a very simple Java program using the WildFly CLI scripting facilities:

{code:java}
    public static void main(String[] args) throws Exception {
        CLI cli = CLI.newInstance();
        cli.connect();
        System.out.println(cli.cmd("":whoami"").getResponse());
        cli.disconnect();
    }
{code}

This is in a small Maven project that has a single dependency:

{code:xml}
        <dependency>
            <groupId>org.wildfly.core</groupId>
            <artifactId>wildfly-cli</artifactId>
            <version>2.1.0.Final</version>
        </dependency>
{code}

When trying to run the program (no matter if there's a running WildFly server or not), I get the following exception:

{code}
Exception in thread ""main"" java.lang.NoClassDefFoundError: org/jboss/logmanager/LogContextSelector
	at org.jboss.as.cli.embedded.EmbeddedControllerHandlerRegistrar.registerEmbeddedCommands(EmbeddedControllerHandlerRegistrar.java:89)
	at org.jboss.as.cli.impl.CommandContextImpl.initCommands(CommandContextImpl.java:581)
	at org.jboss.as.cli.impl.CommandContextImpl.<init>(CommandContextImpl.java:302)
	at org.jboss.as.cli.impl.CommandContextFactoryImpl.newCommandContext(CommandContextFactoryImpl.java:44)
	at org.jboss.as.cli.scriptsupport.CLI.connect(CLI.java:80)
	at cz.ladicek.foobar.Main.main(Main.java:8)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: java.lang.ClassNotFoundException: org.jboss.logmanager.LogContextSelector
	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
	... 11 more
{code}

This is because {{CommandContextImpl}}'s constructor calls {{EmbedServerHandler.create}} and for the {{EmbedServerHandler}} class to load, there has to be JBoss LogManager present on the classpath.

The {{wildfly-cli}} Maven module already has a dependency on JBoss LogManager, except that...

{code:xml}
        <dependency>
            <groupId>org.jboss.logmanager</groupId>
            <artifactId>jboss-logmanager</artifactId>
            <optional>true</optional>
        </dependency>
{code}

It's optional. I guess this made sense in WildFly Core 1.x which didn't have server embedding, but in WildFly Core 2.x, I wonder if the dependency should be mandatory.

Thoughts?",2016/06/07 10:43 AM
WFCORE-1579,"When creating my own deployment-scanner, I have to provide {{path}} attribute where given value is checked whether it is a real directory on current filesystem. Although when I change value of this attribute in existing deployment-scanner instance, such check is not performed and I can provide non-existent directory. This leads to server crash after calling reload operation:
# start EAP7 server and connect to CLI
# create your own deployment-scanner instance pointing to existing directory
{code}
[standalone@localhost:9990 /] /subsystem=deployment-scanner/scanner=mysc:add(path=/home/jstourac/Downloads/jboss-eap-7.0/standalone/deployments)
{""outcome"" => ""success""}
{code}
# change path of deployment-scanner to some nonexisting directory
{code}
[standalone@localhost:9990 /] /subsystem=deployment-scanner/scanner=mysc:write-attribute(name=path,value=/nonexistent)
{
    ""outcome"" => ""success"",
    ""response-headers"" => {
        ""operation-requires-reload"" => true,
        ""process-state"" => ""reload-required""
    }
}
{code}
# perform reload operation
# server fails with following output in console.log
{code}
15:29:08,039 INFO  [org.jboss.as.server.deployment.scanner] (MSC service thread 1-5) WFLYDS0013: Started FileSystemDeploymentService for directory /home/jstourac/Downloads/jboss-eap-7.0/standalone/deployments
15:29:29,068 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-3) WFLYJCA0010: Unbound data source [java:jboss/datasources/ExampleDS]
15:29:29,070 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-8) WFLYUT0019: Host default-host stopping
15:29:29,071 INFO  [org.jboss.as.connector.deployers.jdbc] (MSC service thread 1-5) WFLYJCA0019: Stopped Driver service with driver-name = h2
15:29:29,073 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-4) WFLYUT0008: Undertow HTTP listener default suspending
15:29:29,075 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-4) WFLYUT0007: Undertow HTTP listener default stopped, was bound to 127.0.0.1:8080
15:29:29,076 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-2) WFLYUT0004: Undertow 1.3.21.Final-redhat-1 stopping
15:29:29,081 INFO  [org.jboss.as.mail.extension] (MSC service thread 1-2) WFLYMAIL0002: Unbound mail session [java:jboss/mail/Default]
15:29:29,082 INFO  [org.jboss.as] (MSC service thread 1-8) WFLYSRV0050: JBoss EAP 7.0.0.GA (WildFly Core 2.1.2.Final-redhat-1) stopped in 16ms
15:29:29,083 INFO  [org.jboss.as] (MSC service thread 1-8) WFLYSRV0049: JBoss EAP 7.0.0.GA (WildFly Core 2.1.2.Final-redhat-1) starting
15:29:29,135 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 13) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""subsystem"" => ""deployment-scanner""),
    (""scanner"" => ""mysc"")
]): java.lang.IllegalArgumentException: WFLYDS0023: /nonexistent does not exist
	at org.jboss.as.server.deployment.scanner.FileSystemDeploymentService.<init>(FileSystemDeploymentService.java:273)
	at org.jboss.as.server.deployment.scanner.DeploymentScannerAdd.execute(DeploymentScannerAdd.java:124)
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:890)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:659)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:370)
	at org.jboss.as.controller.ParallelBootOperationStepHandler$ParallelBootTask.run(ParallelBootOperationStepHandler.java:359)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)

15:29:29,139 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) ""WFLYCTL0193: Failed executing subsystem deployment-scanner boot operations""
15:29:29,140 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (""parallel-subsystem-boot"") failed - address: ([]) - failure description: ""\""WFLYCTL0193: Failed executing subsystem deployment-scanner boot operations\""""
15:29:29,141 FATAL [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0056: Server boot has failed in an unrecoverable manner; exiting. See previous messages for details.
15:29:29,144 INFO  [org.jboss.as.server] (Thread-2) WFLYSRV0220: Server shutdown has been requested.
15:29:29,159 INFO  [org.jboss.as] (MSC service thread 1-8) WFLYSRV0050: JBoss EAP 7.0.0.GA (WildFly Core 2.1.2.Final-redhat-1) stopped in 4ms
{code}
# one has to manually modify {{EAP_HOME/standalone/configuration/standalone.xml}} removing problematic deployment-scanner part to be able to start server again

It would be great if there is same check to {{path}} atribute performed when changing it in existing instance of deployment-scanner as what is performed during the adding a new instance of deployment-scanner.",2016/06/07 9:31 AM
WFCORE-1577,Executing a {{full-replace-deployment}} operation on a deployment deployed to a server in a managed domain will result a servers subsystem model to be an empty list.,2016/06/06 7:10 PM
WFCORE-1572,"When an argument value contains a space (eg. {{deploy /path/to/test-application.war --all-server-groups --headers=\{rollout id=foo\}}}) and if user hits tab after the whitespace, suggestions are generated based on the command, rather than the current argument's name.",2016/05/27 12:20 PM
WFCORE-1570,"When using rollout plans for EAP deployment scenarios I can create my own named rollout-plan for ease of use. I can then apply rollout command later on, referring with name of my own rollout plan that should be used. There is minor discrepancy in the way I create and use such rollout plan though.

When I create rollout-plan, I use command like:
{code}
rollout-plan add --name=my-rollout-plan --content={rollout main-server-group(rolling-to-servers=false,max-failed-servers=1),other-server-group(rolling-to-servers=true,max-failure-percentage=20) rollback-across-groups=true}
{code}
- see {{--name}} attribute given to name my rollout plan

When I then refer to it I use following command:
{code}
deploy /path/to/test-application.war --all-server-groups --headers={rollout id=my-rollout-plan}
{code}
 - see {{id}} attribute given to {{rollout}} header operation

Yes, this is really minor issue, but I think that these two attributes used in aforementioned commands should be unified (preferably to {{name}} instead of {{id}}) as user might be confused when using it.

Note: examples are used from our documentation.
Note: I do not know whether I am missing something but I was not able to retrieve more info how to use {{rollout}} header operation in deploy command directly in CLI.",2016/05/27 8:51 AM
WFCORE-3199,"If -Dorg.jboss.server.bootstrap.maxThreads is explictily set in Wildfly, then, the permissions.xml file is not even parsed when the application is deployed.

Debugging the Wildfly 8.2.0 source code revealed the problem in org.jboss.as.server.ServerService#addService:218 


{code:java}
if (configuration.getServerEnvironment().isAllowModelControllerExecutor()) {
            serviceBuilder.addDependency(Services.JBOSS_SERVER_EXECUTOR, ExecutorService.class, service.getExecutorServiceInjector());
        }
{code}

The org.jboss.as.server.ServerEnvironment#allowModelControllerExecutor property is set to true if -Dorg.jboss.server.bootstrap.maxThreads was set. 

The above 'if' seems a little strange because a default value for maxThreads is always set in org.jboss.as.server.ServerEnvironment#getBootstrapMaxThreads even when the -Dorg.jboss.server.bootstrap.maxThreads property was not specified. 

This may also cause other things to not work properly when  -Dorg.jboss.server.bootstrap.maxThreads is set.",2016/05/27 4:49 AM
WFCORE-1557,"The unwrap method resolves the value of the map entries but does not check if they are defined before calling asString(). So an undefined value will store as string ""undefined"" instead of null.

-The class doesn't any way to configure or check whether null is ok; perhaps I'll improve that as well.- <--- was incorrect",2016/05/17 5:21 PM
WFCORE-1556,"The handling of the notions of 'required' and 'nillable' don't comply with the specs in https://docs.jboss.org/author/display/WFLY/Description+of+the+Management+Model, particularly the ""Description of an Attribute"" part, where the 'required' and 'alternatives' fields are well described, with their relationship spelled out, while 'nillable' doesn't appear at all. Then in ""Description of an Operation Parameter or Return Value"" nillable is specified, although I think those descriptions could be tightened up in general.

The read-resource-description output for an attribute doesn't show ""required"" at all.

After a fair bit of thinking, I've finally recalled why the two separate notions of ""required"" and ""nillable"" exist in the first place.

The ""required"" and ""alternatives"" pieces go together. Is something required? And then if it is required, an alternative satisfies. So you can have two attributes/params, both required, but they are alternatives so one is defined and the other is not. And this is an ok thing.

And then 'nillable' comes in to help clients understand in a simple way whether they need to account for the possibility an undefined value. Basically:

nillable = !required || alternatives != null

Right now, nillable is implemented as

nillable = !required

There are a number of problems I see with AttributeDefinition:

1) We don't output the 'required' metadata unless it's an operation param being described.  This is contrary to spec. However we shouldn't fix this unless we can have meaningful values for 'required', ones where the value can be true but the attribute/param can still have an undefined value, due to an alternative being present. If we can't fix that, there's no point outputting required as it's just redundant with what we output for 'nillable'.

2) We do output the 'nillable' metadata, even for attribute descriptions, where it isn't in the spec. But in this case I think we change the spec, as dropping nillable would be an incompatible change.

3) We don't properly validate the ""required but has alternatives case."" This can't be validated solely with ParameterValidator impls as those only see a single attribute value and don't have contextual information about other attributes/params. To get around this limitation, devs are saying that attributes with alternatives ""allowNull"" which is equivalent to saying they are not required. But they are required! So I think a fix for this will require AttributeDefinition itself to validate the overall resource model or operation object, and skip calling the ParameterValidator if the attribute/param is undefined and an alternative is defined.

4) AttributeDefinition and AbstractAttributeDefinitionBuilder unfortunately have a getter/setter/constructor param for property ""allowNull"" instead of a property named ""required"". This is unfortunate because ""allowNull"" intuitively maps to ""nillable"", but ""required"" is a much more useful thing to set. The value of ""nillable"" can be derived from a ""required"" setting and an ""alternatives"" setting, but the value of required cannot be so derived.

I think a fix for this would probably start from 4), deprecating setAllowNull, adding get/setRequired and changing the meaning of the AD(Builder) constructor param to ""required"". The effect of this would be that all current code setting ""allowNull"" would now be setting a new ""required"" field. This should be a non-breaking change as in current code that's the effect anyway.

Next would be to fix 3), by changing how AD validates.

Next would be to change the metadata we output, such that ""required"" is always present and the ""nillable"" value is !required || alternatives != null. And change the spec accordingly.

Last, in a separate task, would be to find attributes that were configuring ""allowNull = true"" solely to allow validation to pass when alternatives are present, and fix them to say ""required=false"".",2016/05/16 2:08 PM
WFCORE-1550,"Wildfly start-up script $JBOSS_HOME/docs/contrib/scripts/init.d/wildfly-init-redhat.sh tries to get successful start timestamp using following command:

grep -o '[0-9]*' $JBOSS_MARKERFILE

This however does not work on RHEL 5 OS, as grep-2.5.1 does not return regular expression result correctly when used with -o option.",2016/05/13 10:10 AM
WFCORE-1534,"I created a command named toto:
toto --help
SYNOPSIS

  logger --help [--properties | --commands] |
         (--category=<resource_id> (--<property>=<value>)*) |
         (<command> --category=<resource_id> (--<parameter>=<value>)*)
         [--headers={<operation_header> (;<operation_header>)*}]


logger is used everywhere in the command description, it should be the actual command name.
",2016/05/06 8:03 AM
WFCORE-1536,"We have some development Wildfly 10.0.0 servers running as slaves in a domain that frequently have WAR files redeployed. We have noticed that these slaves will often go offline after a redeployment of WAR files with the following stack trace:

{code}
2016-05-06 05:05:51,306 ERROR [org.jboss.as.controller.management-operation] (Host Controller Service Threads - 1012) WFLYCTL0190: Step handler org.jboss.as.domain.controller.operations.deployment.DeploymentFullReplaceHandler@3f68226b for operation {""operation"" => ""full-replace-deployment"",""name"" => ""whatever.war"",""enabled"" => true,""content"" => [{""hash"" => bytes { 0x5d, 0x12, 0x18, 0x2b, 0x1c, 0x86, 0x71, 0x27, 0x08, 0x3d, 0xf1, 0x75, 0x08, 0x29, 0xa6, 0x49, 0x1f, 0x16, 0xe8, 0x22 }}],""operation-headers"" => {""access-mechanism"" => ""NATIVE"",""domain-uuid"" => ""802ab616-dd2c-4081-a79c-c4d54e14c384"",""push-to-servers"" => undefined},""address"" => [],""runtime-name"" => undefined} at address [] failed handling operation rollback -- java.lang.NullPointerException: java.lang.NullPointerException
        at org.jboss.as.repository.LocalDeploymentFileRepository.deleteDeployment(LocalDeploymentFileRepository.java:59)
        at org.jboss.as.host.controller.RemoteDomainConnectionService$RemoteFileRepository.deleteDeployment(RemoteDomainConnectionService.java:756)
        at org.jboss.as.domain.controller.operations.deployment.DeploymentFullReplaceHandler$1.handleResult(DeploymentFullReplaceHandler.java:181)
        at org.jboss.as.controller.AbstractOperationContext$Step.invokeResultHandler(AbstractOperationContext.java:1384)
        at org.jboss.as.controller.AbstractOperationContext$Step.handleResult(AbstractOperationContext.java:1366)
        at org.jboss.as.controller.AbstractOperationContext$Step.finalizeInternal(AbstractOperationContext.java:1328)
        at org.jboss.as.controller.AbstractOperationContext$Step.finalizeStep(AbstractOperationContext.java:1311)
        at org.jboss.as.controller.AbstractOperationContext$Step.access$300(AbstractOperationContext.java:1185)
        at org.jboss.as.controller.AbstractOperationContext.executeResultHandlerPhase(AbstractOperationContext.java:767)
        at org.jboss.as.controller.AbstractOperationContext.executeDoneStage(AbstractOperationContext.java:753)
        at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:680)
        at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:370)
        at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1344)
        at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:392)
        at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:217)
        at org.jboss.as.controller.remote.TransactionalProtocolOperationHandler.internalExecute(TransactionalProtocolOperationHandler.java:247)
        at org.jboss.as.controller.remote.TransactionalProtocolOperationHandler$ExecuteRequestHandler.doExecute(TransactionalProtocolOperationHandler.java:185)
        at org.jboss.as.controller.remote.TransactionalProtocolOperationHandler$ExecuteRequestHandler$1.run(TransactionalProtocolOperationHandler.java:138)
        at org.jboss.as.controller.remote.TransactionalProtocolOperationHandler$ExecuteRequestHandler$1.run(TransactionalProtocolOperationHandler.java:134)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:360)
        at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:81)
        at org.jboss.as.controller.remote.TransactionalProtocolOperationHandler$ExecuteRequestHandler$2$1.run(TransactionalProtocolOperationHandler.java:157)
        at org.jboss.as.controller.remote.TransactionalProtocolOperationHandler$ExecuteRequestHandler$2$1.run(TransactionalProtocolOperationHandler.java:153)
        at java.security.AccessController.doPrivileged(Native Method)
        at org.jboss.as.controller.remote.TransactionalProtocolOperationHandler$ExecuteRequestHandler$2.execute(TransactionalProtocolOperationHandler.java:153)
        at org.jboss.as.protocol.mgmt.AbstractMessageHandler$ManagementRequestContextImpl$1.doExecute(AbstractMessageHandler.java:363)
        at org.jboss.as.protocol.mgmt.AbstractMessageHandler$AsyncTaskRunner.run(AbstractMessageHandler.java:472)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)
        at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}

This error will usually only happen for 2 out of the 4 identically configured slaves, and seems to happen randomly, although frequently enough.",2016/05/05 6:02 PM
WFCORE-1529,"tl;dr version from Brian:

The ServerService Threads and Host Controller Service Threads pools have no core size and a thread timeout of 20 secs, so if a management request comes in periodically but less often then every 20 secs (says twice a minute) the pool will continually churn threads. That kind of periodic polling is not an unusual scenario, so, we'll put in a core size of one or two.

Original details from Rostislav:

I did quite simple thing in the loop : 
 * deploy attached application into jboss-eap-7.0/standalone/deployments/
 * wait 1 minute
 * remove anything from jboss-eap-7.0/standalone/deployments/
 * wait 1 minute

I connected with jvisualvm and was watching monitor tab for cpu / classes / heap / threads overview statistics. After some time I spotted jumps (up and down) on threads.

After some time I see threads named ""ServerService Thread Pool -- 346"", I ended with number bigger than 1400. In my case 15 threads are created for 20 seconds when deploying and another 15 threads are created for 20 seconds when undeploying. Nothing seems to be reused

Setup for threads is done in https://github.com/wildfly/wildfly-core/blob/master/server/src/main/java/org/jboss/as/server/ServerService.java#L207-L213 method addService

Is it intentional to have threads alive only 20 seconds and then scratch them ? Keeping a lot of threads means usage of system resources, creating new threads has some overhead too. Maybe the question is what is the right balance ? 

Note: It would be nice to have ""Possible Bug"" Issue Type for issues like this ;)",2016/05/05 1:35 PM
WFCORE-1522,"PersistanceResourceTestCase fails on Windows 10 (out-of-box configuration) where defaultPermissins list contain only groups, ownerPermissions is empty set thus assertion fail - see discussion on https://github.com/wildfly/wildfly-core/pull/1513.

Test the ownerPermissions for emptiness before making the assertion.",2016/05/02 2:18 AM
WFCORE-1525,"When ageout-history cannot delete the old CP files, it silently fails and returns ""success"".

LocalAgeoutHistoryHandler#recursiveDelete does keep track of whether the
delete failed or succeeded, but the return value from this method is ignored
in execute(...).

If recursiveDelete returns false, it should report a failure.",2016/04/28 5:41 PM
WFCORE-1516,"4 issues with command arguments completion:
1) "" "" and ""=false"" shouldn't be proposed for argument without values (that is a regression introduced by the support of implicit true value).
2) arguments without values used to stop completion to operate. For example ls --resolve-expressions should complete to the argument separator "" "" if no more arguments can be added.
3) ""="" character is not appended to argument that has a value (that is a regression introduced by the support of implicit true value).
4) Exception in read-attribute completing the node
read-attribute --node
org.jboss.as.cli.CommandFormatException: Couldn't locate ' --node=' in the line: 'read-attribute --node'
	at org.jboss.as.cli.handlers.ReadAttributeHandler.getAddress(ReadAttributeHandler.java:325)
	at org.jboss.as.cli.handlers.ReadAttributeHandler$2.canAppearNext(ReadAttributeHandler.java:114)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:257)
	at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:73)
	at org.jboss.as.cli.CommandCompleter.doComplete(CommandCompleter.java:126)
	at org.jboss.as.cli.CommandCompleter.complete(CommandCompleter.java:63)
	at org.jboss.as.cli.impl.Console$Factory$1$1.complete(Console.java:141)
	at org.jboss.aesh.console.AeshCompletionHandler.complete(AeshCompletionHandler.java:150)
	at org.jboss.aesh.console.AeshInputProcessor.complete(AeshInputProcessor.java:420)
	at org.jboss.aesh.console.AeshInputProcessor.parseOperation(AeshInputProcessor.java:165)
	at org.jboss.aesh.console.Console.processInternalOperation(Console.java:735)
	at org.jboss.aesh.console.Console.execute(Console.java:718)
	at org.jboss.aesh.console.Console.access$900(Console.java:73)
	at org.jboss.aesh.console.Console$6.run(Console.java:627)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
",2016/04/28 11:29 AM
WFCORE-1508,"This issue appeared after the fix for WFCORE-1315

In interactive mode the prompt is not displayed after the first command line execution. It is correctly displayed afterwards.",2016/04/25 4:11 PM
WFCORE-1503,"The logging subsystem uses a dynamic resource to list log files as resources. These are the files that are allowed to be read or downloaded and are attached to known file handlers.

When several file handlers are defined the file tree walker is invoked several times per {{read-resource-operation}}. This may be happening for each stage of an operation. Ideally we could either cache the file listing per-operation or only execute at the runtime stage. This may not be an option for dynamic resources however.

As a result of this poor performance the web console is very slow to load the logging subsystem configuration. This is not an issue with the web console.
",2016/04/25 12:32 PM
WFCORE-1501,"Something like the following shouldn't be allowed to fail a boot; if it happens an ERROR should be logged but no exception thrown:

{code}

2016-04-22 22:10:21,247 ERROR [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0055: Caught exception during boot: java.lang.IllegalStateException: WFLYCTL0056: Could not rename C:\BuildAgent\work\38e1ea00f932992d\full\testsuite\integration\basic\target\jbossas\standalone\configuration\standalone_xml_history\current to C:\BuildAgent\work\38e1ea00f932992d\full\testsuite\integration\basic\target\jbossas\standalone\configuration\standalone_xml_history\20160422-221021244
	at org.jboss.as.controller.persistence.ConfigurationFile.createHistoryDirectory(ConfigurationFile.java:668)
	at org.jboss.as.controller.persistence.ConfigurationFile.successfulBoot(ConfigurationFile.java:500)
	at org.jboss.as.controller.persistence.BackupXmlConfigurationPersister.successfulBoot(BackupXmlConfigurationPersister.java:94)
	at org.jboss.as.controller.AbstractControllerService.finishBoot(AbstractControllerService.java:452)
	at org.jboss.as.server.ServerService.boot(ServerService.java:367)
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:299)
	at java.lang.Thread.run(Thread.java:745)
{code}

That stack trace indicates file standalone\configuration\standalone_xml_history\20160422-221021144 must already exist but the 2nd attempt renameTo standalone\configuration\standalone_xml_history\20160422-221021244 has failed. It would be good to sort out what happened, but regardless it should not fail boot.",2016/04/23 7:42 AM
WFCORE-1500,"While reviewing https://github.com/wildfly/wildfly-core/pull/1517 I wondered if the same problem was present in other places in core. A check shows the WFCORE-582 fix has this problem.

Minor issue as our extensions don't use slots other than main. But they could.",2016/04/22 4:57 PM
WFCORE-1499,"Tested on EAP 6.4

when creating a module for a custom *loghandler*, everything works fine if the module is package in default main slot, e.g.
my/loghandler/main
   - module.xml
   - my.jar

{code:xml}
<custom-handler name=""4H"" class=""my.handler.Periodic4HFileHandler"" module=""my.loghandler"">
{code}

Nevertheless I want to version the module, therefore package my module with a given slot:
my/loghandler/1.0
    - module.xml
    - my.jar

{code:xml}
<custom-handler name=""4H"" class=""my.handler.Periodic4HFileHandler"" module=""my.loghandler:1.0"">
{code}

But this fails with following stacktrace:
{code}
11:53:50,458 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) JBAS014612: Operation (""add"") failed - address: ([
    (""subsystem"" => ""logging""),
    (""custom-handler"" => ""4H"")
]): java.lang.IllegalArgumentException: JBAS011532: Failed to load module 'my.loghandler:1.0' for handler '4H'
	at org.jboss.as.logging.HandlerOperations$HandlerAddOperationStepHandler.createHandlerConfiguration(HandlerOperations.java:320) [jboss-as-logging-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.logging.HandlerOperations$HandlerAddOperationStepHandler.performRuntime(HandlerOperations.java:255) [jboss-as-logging-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.logging.LoggingOperations$LoggingAddOperationStepHandler$1.execute(LoggingOperations.java:206) [jboss-as-logging-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:702) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:537) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.AbstractOperationContext.completeStepInternal(AbstractOperationContext.java:338) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:314) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1144) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.ModelControllerImpl.boot(ModelControllerImpl.java:416) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.AbstractControllerService.boot(AbstractControllerService.java:301) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.server.ServerService.boot(ServerService.java:355) [jboss-as-server-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.server.ServerService.boot(ServerService.java:330) [jboss-as-server-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:263) [jboss-as-controller-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	at java.lang.Thread.run(Thread.java:745) [rt.jar:1.8.0_65]
Caused by: org.jboss.modules.ModuleNotFoundException: my.loghandler:1.0:main
	at org.jboss.modules.ModuleLoader.loadModule(ModuleLoader.java:240) [jboss-modules.jar:1.3.6.Final-redhat-1]
	at org.jboss.as.logging.HandlerOperations$HandlerAddOperationStepHandler.createHandlerConfiguration(HandlerOperations.java:295) [jboss-as-logging-7.5.0.Final-redhat-21.jar:7.5.0.Final-redhat-21]
	... 13 more
{code}

why is the module not found being *my.loghandler:1.0:main* ?",2016/04/22 6:04 AM
WFCORE-1495,"In domain mode, the server instances cannot find the keytab if the ApplicationRealm is configured to use kerberos as the server-identity:

{code}
            <security-realm name=""ApplicationRealm"">                                                                                                                               
              <server-identities>                                                                                                                                                  
                <kerberos>                                                                                                                                                         
                  <keytab principal=""remote/imahost.imadomain.net@VM29"" path=""/path/to/keytab""/>                                                       
                </kerberos>                                                                                                                                                        
              </server-identities>                                                                                                                                                              
              <authentication>                                                                                                                                                                     
                <kerberos remove-realm=""true""/>                                                                                                                                    
              </authentication>                                                                                                                                                    
              <authorization>                                                                                                                                                      
                <properties path=""application-roles.properties"" relative-to=""jboss.domain.config.dir""/>                                                                                                   
               </authorization>                                                                                                                                                     
            </security-realm> 
{code}                                     

This results in the following error and the server instances fail to start:

[Server:server-one] 15:10:35,360 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (""validate-authentication"") failed - address: ([
[Server:server-one]     (""core-service"" => ""management""),
[Server:server-one]     (""security-realm"" => ""ApplicationRealm"")
[Server:server-one] ]) - failure description: ""WFLYDM0094: Kerberos is enabled for authentication on security realm 'ApplicationRealm' but no Keytab has been added to the server-identity.""
[Server:server-one] 15:10:35,376 FATAL [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0056: Server boot has failed in an unrecoverable manner; exiting. See previous messages for details.
",2016/04/20 6:19 PM
WFCORE-1493,"JDK9 provides -XaddExports launch option to workaround potential migration problems to modularized JDK.
{color:red}When modularized JDK forks new process all -XaddExports values are translated into
-Djdk.launcher.addexports.%d=%s JVM options.{color}
But method org.jboss.as.host.controller.Main.getHostSystemProperties()
has problems with its values.

The format of -XaddExports (and thus for -Djdk.launcher.addexports.%d=%s too) is:

{noformat}
-XaddExports:<source-module>/<package>=<target-module>(,<target-module>)*{noformat}

See http://openjdk.java.net/jeps/261 for more information.",2016/04/20 4:05 PM
WFCORE-1491,"In order to ensure consistent WildFly-Core build and runtime behavior on all JDKs it is necessary to explicitly specify which JAXP providers should be used instead of default ones
provided by JDK.",2016/04/20 12:06 PM
WFCORE-484,"OperationContext.getResourceRegistrationForUpdate().registerAlias(...) throws the following:
{noformat}
java.lang.AssertionError: Unknown alias type
	at org.jboss.as.controller.registry.AbstractResourceRegistration.registerAlias(AbstractResourceRegistration.java:503)
	at org.jboss.as.controller.registry.DelegatingManagementResourceRegistration.registerAlias(DelegatingManagementResourceRegistration.java:310)
	at org.jboss.as.clustering.jgroups.subsystem.TransportResourceDefinition$5$1.execute(TransportResourceDefinition.java:360)
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:728)
	at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:563)
	at org.jboss.as.controller.AbstractOperationContext.completeStepInternal(AbstractOperationContext.java:336)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:312)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1163)
	at org.jboss.as.controller.ModelControllerImpl.boot(ModelControllerImpl.java:421)
	at org.jboss.as.controller.AbstractControllerService.boot(AbstractControllerService.java:304)
	at org.jboss.as.model.test.ModelTestModelControllerService.boot(ModelTestModelControllerService.java:256)
	at org.jboss.as.controller.AbstractControllerService.boot(AbstractControllerService.java:299)
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:266)
	at java.lang.Thread.run(Thread.java:745)
{noformat}

This is because OperationContext.getResourceRegistrationForUpdate() returns a DelegatingManagementResourceRegistration, which does not extend AbstractResourceRegistration - so the assertion fails.

Is there a technical reason why this should not work?",2014/12/16 6:11 PM
WFCORE-451,"ResolveExpressionHandler deliberately does not make use of the full range of expression resolutions sources, because by design the intent is not to support vault resolution.

However, the way it implements that limitation is by simply calling ModelNode.resolve(). That is overly restrictive, as DMR alone does not support other valid resolution features, i.e. nested expressions and recursive resolution.

Fix is to switch the handler to use an ExpressionResolver impl, just one that doesn't plug in the vault resolver.",2014/12/08 11:16 AM
WFCORE-450,"Using wildfly domain I would like to define some properties in domain.xml and then be able to use these properties when defining others in server-group or server level. Currently this leads to JBAS014802: Cannot resolve expression.

More detailed example:

{code:xml|title=domain.xml}
<domain>
    <system-properties>
        <property name=""foo"" value=""bar""/>
    </system-properties>
    ...
    <server-group name=""g1"">
        <system-properties>
            <property name=""g1_foo"" value=""${foo}""/>
        </system-properties>
    </server-group>
</domain>
{code}",2014/12/08 6:27 AM
WFCORE-449,"This issue happens if you create an MBean in your EJB and deploy the EJB. The steps to reproduce the issue is the following:
{code}
git clone https://github.com/zhfeng/test_jmx_ejb
cd test_jmx_ejb
mvn clean install
{code}
After starting the wildfly server, copy the test_jmx_ejb-1.0.jar to the deployment directory of the wildfly and you will see the exception 

{code}
11:39:30,064 ERROR [org.jboss.as.weld] (MSC service thread 1-8) WFLYWELD0002: Failed to tear down Weld contexts: javax.naming.NameNotFoundException: java:comp/BeanManager
	at org.jboss.as.naming.InitialContext$DefaultInitialContext.findContext(InitialContext.java:187)
	at org.jboss.as.naming.InitialContext$DefaultInitialContext.lookup(InitialContext.java:231)
	at org.jboss.as.naming.NamingContext.lookup(NamingContext.java:188)
	at org.jboss.as.naming.NamingContext.lookup(NamingContext.java:184)
	at javax.naming.InitialContext.lookup(InitialContext.java:411) [rt.jar:1.7.0_21]
	at javax.naming.InitialContext.lookup(InitialContext.java:411) [rt.jar:1.7.0_21]
	at org.jboss.as.weld.arquillian.WeldContextSetup.teardown(WeldContextSetup.java:108)
	at org.jboss.as.jmx.MBeanRegistrationService.start(MBeanRegistrationService.java:106) [wildfly-jmx-1.0.0.Alpha9.jar:1.0.0.Alpha9]
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1948) [jboss-msc-1.2.2.Final.jar:1.2.2.Final]
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1881) [jboss-msc-1.2.2.Final.jar:1.2.2.Final]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [rt.jar:1.7.0_21]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [rt.jar:1.7.0_21]
	at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_21]
{code}

It looks like the JavaNamespaceSetup teardown happens before the WeldContextSetup so it throws NameNotFoundException in the WeldContextSetup teardown.

The possible fix is to reverse calling the setupActions.",2014/12/05 11:00 AM
WFCORE-443,Currently if the {{/host=master/directory-grouping=by-server}} is set the same directory will be used for all servers if the {{jboss.server.xxx.dir}} is overridden. For example of the {{jboss.server.log.dir}} is overridden all servers in the group write to the same {{server.log}} file. They should be in {{$jboss.server.log.dir/server-name/}} directory.,2014/12/02 6:00 PM
WFCORE-442,"An example is worth a thousand words:

{code}
[standalone@localhost:9990 /] /path=*:query(where={read-only=1})
{
    ""outcome"" => ""failed"",
    ""result"" => [
        {
            ""address"" => [(""path"" => ""jboss.server.temp.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""jboss.server.temp.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT/standalone/tmp"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""user.home"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""user.home"",
                ""path"" => ""/Users/hbraun"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""jboss.server.base.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""jboss.server.base.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT/standalone"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""java.home"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""java.home"",
                ""path"" => ""/Library/Java/JavaVirtualMachines/jdk1.7.0_67.jdk/Contents/Home/jre"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""user.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""user.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""jboss.server.data.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""jboss.server.data.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT/standalone/data"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""jboss.home.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""jboss.home.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""jboss.server.log.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""jboss.server.log.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT/standalone/log"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""jboss.server.config.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""jboss.server.config.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT/standalone/configuration"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""rolled-back"" => true
        },
        {
            ""address"" => [(""path"" => ""jboss.controller.temp.dir"")],
            ""outcome"" => ""failed"",
            ""result"" => {
                ""name"" => ""jboss.controller.temp.dir"",
                ""path"" => ""/Users/hbraun/dev/prj/wildfly-core/core-build/target/wildfly-core-1.0.0.Alpha14-SNAPSHOT/standalone/tmp"",
                ""read-only"" => true,
                ""relative-to"" => undefined
            },
            ""failure-description"" => ""Illegal argument for attribute 'read-only'. Expected type BOOLEAN"",
            ""rolled-back"" => true
        }
    ],
    ""rolled-back"" => true
}
{code}

One item in the set has a failure description but the overall response does not.

ReadResourceDescriptionHandler handles similar things but has logic for creating an overall failure-description.",2014/12/02 2:15 PM
WFCORE-441,"https://github.com/wildfly/wildfly-core/blob/master/controller/src/main/java/org/jboss/as/controller/operations/global/ReadResourceDescriptionHandler.java#L427 is suspect. AFAICT that operation variable will be from the original op that triggered the multi-part request. So its address is not the address of the bit that had the failure, but the use of that address implies the intent is that it is the bit that had the failure.

Perhaps it should be resultItem.get(OP_ADDR) ?",2014/12/02 1:16 PM
WFCORE-439,"IPv6 addresses in log files are in a wrong format, the [ ] are missing:
{noformat}
09:18:44,203 INFO  [org.jboss.as] (Controller Boot Thread) JBAS015951: Admin console listening on http://2620:52:0:105f::ffff:2:9990
{noformat}
It should be:
{noformat}
http://[2620:52:0:105f::ffff:2]:9990 {noformat}",2014/12/02 9:51 AM
WFCORE-286,If there is a more accurate way to calculate the RealmUser then use it.,2014/11/26 1:06 PM
WFCORE-283,NoData,2014/11/26 8:14 AM
WFCORE-271,"Description of problem: The description of the 'scan-enabled' attribute states ""Flag indicating that all scanning (including initial scanning at startup) should be disabled."" The default value of this attribute is ""true"", therefore I believe the description is incorrect.

I propose that the description be changed to: ""Flag indicating if all scanning (including initial scanning at startup) is enabled.""",2014/11/21 3:32 AM
WFCORE-269,"This is copy of https://bugzilla.redhat.com/show_bug.cgi?id=1149099

Description:

The CLI freezes in phase of requesting username/password in some cases.

Reproducer
==========
Run following command:

./jboss-cli.sh -c << EOF
/core-service=management/security-realm=ManagementRealm/authentication=local:remove
reload
EOF",2014/11/20 6:51 AM
WFCORE-268,"If you try to use a WildFly version CLI GUI to connect to AS7 or EAP6, you will get a failure.  The reason is because CLI GUI tries to do a list-log-files operation, which does not exist in those older AS versions.",2014/11/19 2:55 PM
WFCORE-265,NoData,2014/11/19 1:07 PM
WFCORE-264,NoData,2014/11/19 8:19 AM
WFCORE-263,"If you have a DC with a slave HC, and perform a management operation which gets stuck, non-progressing operations will be reported for both the DC and the slave HC via:
/host=master/core-service=management/service=management-operations:find-non-progressing-operation
/host=slave/core-service=management/service=management-operations:find-non-progressing-operation

Cancelling the operation under /host=master works as expected, pushing the cancellation down to the slave and the controllers become responsive again.


If however you attempt to cancel the operation under /host=slave, it goes bad. { ""outcome"" => ""success"", ""result"" => undefined } is reported in the CLI, but the controllers are still unresponsive.

Running :find-non-progressing-operation against the slave will report the {outcome=success,result=undefined} rather than that no non-progressing operations were found, and active-operation=*:read-resource() shows it as not cancelled.

Once you attempt to cancel it on a slave, attempting to cancel it under /host=master will report success, but leave the slave op in a weird state, and things requiring the controller lock (such as the web UI) will still not respond.",2014/11/19 1:24 AM
WFCORE-260,NoData,2014/11/17 2:33 PM
WFCORE-253,NoData,2014/11/14 2:37 PM
WFCORE-285,Using two slashes in a CLI path and hitting TAB confuses the auto-completion,2014/11/14 9:25 AM
WFCORE-243,"In ServerAddHandler where the server resource is created, a placeholder should be added. I.e. instead of context.createResource(...) below

        context.addStep(runningServerAdd, new OperationStepHandler() {
            @Override
            public void execute(final OperationContext context, final ModelNode operation) throws OperationFailedException {
                context.createResource(PathAddress.EMPTY_ADDRESS);
                context.stepCompleted();
            }
        }, OperationContext.Stage.MODEL, true);

context.addResource(PathAddress.EMPTY_ADDRESS, PlaceholderResource.INSTANCE) should be used instead. Otherwise, servers that are not started at boot will be missing runtime proxies and will be considered as parts of the persistent model.",2014/11/11 10:59 AM
WFCORE-241,NoData,2014/11/11 9:04 AM
WFCORE-242,"- If deploy and undeploy CLI commands executed in a batch mode then it causes missing  deployment inside the ""data/content"" directory which leads to the following error:

{code}
[Host Controller] 10:33:42,387 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (""add"") failed - address: ([(""deployment"" => ""example.war"")]) - failure description: ""WFLYDC0058: No deployment content with hash d85f1e3106bc8a49838a0dccae9e80819c25e02c is available in the deployment content repository for deployment 'example.war'. This is a fatal boot error. To correct the problem, either restart with the --admin-only switch set and use the CLI to install the missing content or remove it from the configuration, or remove the deployment from the xml configuraiton file and restart.""
[Host Controller] 10:33:42,390 FATAL [org.jboss.as.host.controller] (Controller Boot Thread) WFLYHC0034: Host Controller boot has failed in an unrecoverable manner; exiting. See previous messages for details.
{code}

",2014/11/11 12:10 AM
WFCORE-239,NoData,2014/11/10 3:29 PM
WFCORE-238,NoData,2014/11/10 12:11 PM
WFCORE-247,"When I invoke ""add-user.bat <args>"", then I'm getting this Windows error message (in German):
{code}
""that"" kann syntaktisch an dieser Stelle nicht verarbeitet werden.
{code}

The solution is to remove the brackets in line 34, i.e. before:
{code}
echo   WARNING: The JBOSS_HOME (""%SANITIZED_JBOSS_HOME%"") that this script uses points to a different installation than the one that this script resides in (""%RESOLVED_JBOSS_HOME%""). Unpredictable results may occur.
{code}

After:
{code}
echo   WARNING: The JBOSS_HOME ""%SANITIZED_JBOSS_HOME%"" that this script uses points to a different installation than the one that this script resides in ""%RESOLVED_JBOSS_HOME%"". Unpredictable results may occur.
{code}",2014/11/10 6:04 AM
WFCORE-1164,"My web app is using some modules of WildFly AS which are not public.
The warning about using private modules is issued twice for every module:
09.11. 22:07:34,088 WARN  [org.jboss.as.dependency.private#start] WFLYSRV0018: Deployment ""deployment.web-maj2e-langfr-dev.war"" is using a private module (""org.jboss.common-core:main"") which may be changed or removed in future versions without notice.
09.11. 22:07:34,090 WARN  [org.jboss.as.dependency.private#start] WFLYSRV0018: Deployment ""deployment.web-maj2e-langfr-dev.war"" is using a private module (""org.jboss.common-core:main"") which may be changed or removed in future versions without notice.
09.11. 22:07:34,091 WARN  [org.jboss.as.dependency.private#start] WFLYSRV0018: Deployment ""deployment.web-maj2e-langfr-dev.war"" is using a private module (""org.apache.commons.collections:main"") which may be changed or removed in future versions without notice.
09.11. 22:07:34,091 WARN  [org.jboss.as.dependency.private#start] WFLYSRV0018: Deployment ""deployment.web-maj2e-langfr-dev.war"" is using a private module (""org.apache.commons.collections:main"") which may be changed or removed in future versions without notice.
09.11. 22:07:34,092 WARN  [org.jboss.as.dependency.private#start] WFLYSRV0018: Deployment ""deployment.web-maj2e-langfr-dev.war"" is using a private module (""org.apache.cxf.impl:main"") which may be changed or removed in future versions without notice.
09.11. 22:07:34,094 WARN  [org.jboss.as.dependency.private#start] WFLYSRV0018: Deployment ""deployment.web-maj2e-langfr-dev.war"" is using a private module (""org.apache.cxf.impl:main"") which may be changed or removed in future versions without notice.
",2014/11/09 4:13 PM
WFCORE-233,"When standalone.xml gets persisted following some post-boot change, the original ordering of subsystems is lost. We don't want to change config files in this way.

I don't recall how we retained the original subsystem ordering with parallel boot, but something there has broken.",2014/11/09 8:46 AM
WFCORE-232,"I happened to see this in a testsuite log file:

{code}
2014-11-07 02:59:41,808 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) WFLYDS0012: Scan of /opt/buildAgent/work/8feb0abb503148fe/testsuite/manualmode/target/deployment-test-bc636b67-df54-462d-9a13-3618a1755d3f threw Exception: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@146a4b2 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@e6cbcd[Shutting down, pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 3]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2048)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:821)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:325)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:530)
	at java.util.concurrent.ScheduledThreadPoolExecutor.execute(ScheduledThreadPoolExecutor.java:619)
	at org.jboss.as.controller.ModelControllerImpl$3.executeAsync(ModelControllerImpl.java:669)
	at org.jboss.as.controller.ModelControllerImpl$3.executeAsync(ModelControllerImpl.java:605)
	at org.jboss.as.server.deployment.scanner.DefaultDeploymentOperations.deploy(DefaultDeploymentOperations.java:61)
	at org.jboss.as.server.deployment.scanner.FileSystemDeploymentService.scan(FileSystemDeploymentService.java:449)
	at org.jboss.as.server.deployment.scanner.FileSystemDeploymentService$UndeployScanRunnable.run(FileSystemDeploymentService.java:538)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:744)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}

DeploymentScannerService is calling stopScanner() on the scanner and then is shutting down the executor. But stopScanner does not wait for in progress tasks to complete, nor do the in-progress tasks recognize that shutdown is occurring and handle any problems differently (e.g. don't toss the above in the log.)

Waiting for tasks to complete could be tricky, e.g. imagine this race:

1) Admin submits op to shutdown/reload, which has the controller lock and is now stopping services.
2) Scan job kicks off, finds changes and wants to modify the model, so the task is blocking waiting for the controller lock.

Deadlock.

Now, this may not be a problem, as server reload tells MSC to remove the root service on the way out (i.e. after the bit where it blocks for stability) and then MSC threads take over, allowing the op thread to continue and release the lock. The shutdown handler spawns a thread to call System.exit.

But ^^^ is just a quick look, so be cautious! ",2014/11/07 4:27 PM
WFCORE-230,"In a domain configuration, if a server is associated with an incorrectly configurated jvm java-home (e.g. domain.xml -> server-groups -> jvm), it will fail silently (no error shown in logs). For example:

```
<server-group name=""mySrvrGrp"" profile=""full"">
  <jvm name=""my-default"" java-home=""/usr/java/wrongPath"">
    <heap size=""1024m"" max-size=""4096m""/>
    <permgen size=""256m"" max-size=""256m""/>
    <stack size=""256k""/>
```
",2014/11/07 12:46 PM
WFCORE-229,"Start a regular domain

Any operations on server children with the same names that server-config operations (:start, :stop, :restart, :kill) are executed instead of being rejected because the actual resources at the operation address does not define them.

Examples:

{noformat}
[domain@localhost:9990 /] /host=master/server=server-one/subsystem=undertow:start
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.util.NoSuchElementException: No child 'undertow' exists"",
    ""rolled-back"" => true
}

=>

[Host Controller] 16:15:30,231 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 15) WFLYCTL0013: Operation (""restart"") failed - address: ([
[Host Controller]     (""host"" => ""master""),
[Host Controller]     (""server"" => ""server-one""),
[Host Controller]     (""subsystem"" => ""undertow"")
[Host Controller] ]) - failure description: ""WFLYHC0047: Cannot restart server undertow as it is not currently started; it is STOPPED""
[Host Controller] 16:18:43,764 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 18) WFLYCTL0013: Operation (""start"") failed - address: ([
[Host Controller]     (""host"" => ""master""),
[Host Controller]     (""server"" => ""server-one""),
[Host Controller]     (""subsystem"" => ""undertow"")
[Host Controller] ]): java.util.NoSuchElementException: No child 'undertow' exists
[Host Controller]       at org.jboss.dmr.ModelValue.requireChild(ModelValue.java:369)
[Host Controller]       at org.jboss.dmr.ObjectModelValue.requireChild(ObjectModelValue.java:299)
[Host Controller]       at org.jboss.dmr.ModelNode.require(ModelNode.java:870)
[Host Controller]       at org.jboss.as.host.controller.ManagedServerBootCmdFactory.<init>(ManagedServerBootCmdFactory.java:93)
[Host Controller]       at org.jboss.as.host.controller.ServerInventoryImpl.createBootFactory(ServerInventoryImpl.java:629)
[Host Controller]       at org.jboss.as.host.controller.ServerInventoryImpl.startServer(ServerInventoryImpl.java:200)
[Host Controller]       at org.jboss.as.host.controller.operations.ServerStartHandler$1.execute(ServerStartHandler.java:110)
[Host Controller]       at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:728)
[Host Controller]       at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:563)
[Host Controller]       at org.jboss.as.controller.AbstractOperationContext.completeStepInternal(AbstractOperationContext.java:336)
[Host Controller]       at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:312)
[Host Controller]       at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1160)
[Host Controller]       at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:356)
[Host Controller]       at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:215)
[Host Controller]       at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:220)
[Host Controller]       at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$300(ModelControllerClientOperationHandler.java:147)
[Host Controller]       at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:169)
[Host Controller]       at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:165)
[Host Controller]       at java.security.AccessController.doPrivileged(Native Method)
[Host Controller]       at javax.security.auth.Subject.doAs(Subject.java:422)
[Host Controller]       at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:94)
[Host Controller]       at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:165)
[Host Controller]       at org.jboss.as.protocol.mgmt.AbstractMessageHandler$2$1.doExecute(AbstractMessageHandler.java:298)
[Host Controller]       at org.jboss.as.protocol.mgmt.AbstractMessageHandler$AsyncTaskRunner.run(AbstractMessageHandler.java:518)
[Host Controller]       at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
[Host Controller]       at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
[Host Controller]       at java.lang.Thread.run(Thread.java:745)
[Host Controller]       at org.jboss.threads.JBossThread.run(JBossThread.java:320)

[domain@localhost:9990 /] /host=master/server=server-one/subsystem=undertow:stop
{
    ""outcome"" => ""success"",
    ""result"" => ""STOPPED""
}

[domain@localhost:9990 /] /host=master/server=server-one/subsystem=undertow:kill
{""outcome"" => ""success""}
{noformat}

If the corresponding server-config resource is actually stopped, the operations fail because there is no resource at the operation's address.
",2014/11/07 10:20 AM
WFCORE-227,"After wildfly-core 1.0.0.Alpha11 has been included in WFLY master, I'm seeing hundreds of the following exceptions in the logs when running the JBossWS-CXF testsuite:

{noformat}
Exception in thread ""Remoting ""management-client"" task-4"" java.util.concurrent.RejectedExecutionException: Task org.jboss.remoting3.remote.RemoteConnectionChannel$3@5651c0c2 rejected from org.xnio.XnioWorker$TaskPool@11462cd4[Shutting down, pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 4]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2048)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:821)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1372)
	at org.xnio.XnioWorker.execute(XnioWorker.java:741)
	at org.jboss.remoting3.remote.RemoteConnectionChannel.receiveMessage(RemoteConnectionChannel.java:363)
	at org.jboss.as.protocol.mgmt.ManagementChannelReceiver.handleMessage(ManagementChannelReceiver.java:107)
	at org.jboss.remoting3.remote.RemoteConnectionChannel$5.run(RemoteConnectionChannel.java:451)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
{noformat}

The exception is logged just after the org.jboss.as.webservices.deployer.RemoteDeployer calls the RemotingModelControllerClient#close method.
The issue seems to be related to some kind of race condition, as trying to reproduce it with an attached debugger is not possible.",2014/11/07 3:02 AM
WFCORE-226,"DeploymentStatusHandler is calling Resource.Tools.readModel() to get the mode instead of the simple Resource.getModel().

This fails because the resource is runtime-only and Resource.Tools.readModel() ignore runtime-only.",2014/11/06 8:43 PM
WFCORE-221,Shouldn't happen.,2014/11/05 10:03 PM
WFCORE-216,"Currently there is no validation of ""requires"" and ""alternatives"" that are specified in attribute metadata / AttributeDefinition
ModelValidator should be added as extra step handler that executes on end of MODEL phase to ensure resource model is correct.",2014/11/04 6:43 AM
WFCORE-211,"If you deploy the same war twice (same hash with different names) on a domain then undeploy one the content is removed from the HC while it is still referenced and potentially useable.
The content is not removed from the servers content directory.
To reproduce :
deploy /home/ehsavoie/dev/wildfly/quickstart/ejb-in-war/target/wildfly-ejb-in-war.war --runtime-name=first.war --server-groups=main-server-group --name=first.war
deploy /home/ehsavoie/dev/wildfly/quickstart/ejb-in-war/target/wildfly-ejb-in-war.war --runtime-name=second.war --server-groups=main-server-group --name=second.war
undeploy first.war --all-relevant-server-groups




",2014/11/03 5:18 AM
WFCORE-210,"If an IO error such as reaching the file descriptor limit occurs during deployment scanning, the scanner continues with an empty deployment list causing it to undeploy applications.

This occurs because FileSystemDeploymentService.scanDirectory() treats File.listFiles() returning null as an empty list rather than an error. http://docs.oracle.com/javase/7/docs/api/java/io/File.html#listFiles%28%29 notes that it returns an empty array if the directory is empty, and null if it is not a directory or an IO error occurs.

It should instead respond to a null return value by aborting the scanner run, with a log message, and not proceed to undeploy applications.",2014/11/03 12:07 AM
WFCORE-207,"The write-attribute and undefine-attribute operation are registered as runtime-only, which is not correct and was probably done unintentionally.",2014/10/30 11:24 AM
WFCORE-485,"I tried to specify a custom log folder for WildFly, by overriding property  jboss.server.log.dir 
https://docs.jboss.org/author/display/WFLY8/Command+line+parameters

But it only works for folder without space in path. The ones with space when used with ""jboss.server.log.dir"" will prevent wildfly from starting. 

Working: 
C:\>start C:\wildfly-8.1.0.Final\bin\standalone.bat 
C:\>start C:\wildfly-8.1.0.Final\bin\standalone.bat -Djboss.server.log.dir=""C:\Windows""

Not working (server can not start):
C:\>start C:\wildfly-8.1.0.Final\bin\standalone.bat -Djboss.server.log.dir=""C:\Program Files""

(More info:
JBoss AS 7.1 works: 
C:\> start C:\jboss-as-7.1.1.Final\bin\standalone.bat -Djboss.server.log.dir=""C:\Program Files""

JBoss EAP 6 and WildFly 8.0 not working either:
C:\> start C:\jboss-eap-6.2\bin\standalone.bat -Djboss.server.log.dir=""C:\Program Files""
C:\> start C:\wildfly-8.0.0.Final\bin\standalone.bat -Djboss.server.log.dir=""C:\Program Files""

Aready tried setting jboss.server.log.dir=""C:\Program Files"" in JAVA_OPTS but did not work either. Should have been fixed in WFLY-1358 or WFLY-2348.
)",2014/10/30 2:38 AM
WFCORE-202,"Creating upstream issue as the same deadlock can be found in WFLY.
Descirption as comment 5 in [BZ1142538|https://bugzilla.redhat.com/show_bug.cgi?id=1142538]

{noformat}
The following deadlock still exists.

Steps to Reproduce:
1. Prepare a running EAP instance with secured management port - optionally in VM
2. Execute export JAVA_OPTS=""-agentlib:jdwp=transport=dt_socket,address=8787,server=y,suspend=y""
3. In the same terminal, execute ""bin/jboss-cli.sh --connect --controller=$EAP_IP --user=admin --password=password ':read-resource'""
4. From yet another terminal, execute ""jdb -attach localhost:8787""
5. In JDB: 
5.a. Create breakpoint: ""stop in org.xnio.channels.FramedMessageChannel.receive(java.nio.ByteBuffer)""
5.b. Resume all threads: ""resume""
5.c. [Execute five times] Wait until breakpoint is hit and execute ""resume"". Either set timeout or be fast so that timeout does not occur first
6. Execute ""kill -9 $EAP_PID"" - optionally in VM
7. In JDB:
8.a. Remove breakpoint: ""clear org.xnio.channels.FramedMessageChannel.receive(java.nio.ByteBuffer)""
8.b. Resume all threads: ""resume""
9. Now dump the stack trace of jboss-cli.sh: ""kill -3 $JBOSS_CLI_PID""




Found one Java-level deadlock:
=============================
""Remoting ""cli-client"" read-1"":
  waiting to lock monitor 0x00007ff9c829b558 (object 0x0000000783433408, a java.lang.String),
  which is held by ""main""
""main"":
  waiting to lock monitor 0x00007ff9c8333c48 (object 0x00000007851ae6e0, a java.util.ArrayDeque),
  which is held by ""Remoting ""cli-client"" read-1""

Java stack information for the threads listed above:
===================================================
""Remoting ""cli-client"" read-1"":
        at org.jboss.as.cli.impl.CLIModelControllerClient$ChannelCloseHandler.handleClose(CLIModelControllerClient.java:286)
        - waiting to lock <0x0000000783433408> (a java.lang.String)
        at org.jboss.as.cli.impl.CLIModelControllerClient$ChannelCloseHandler.handleClose(CLIModelControllerClient.java:269)
        at org.jboss.remoting3.spi.SpiUtils.safeHandleClose(SpiUtils.java:54)
        at org.jboss.remoting3.spi.AbstractHandleableCloseable$CloseHandlerTask.run(AbstractHandleableCloseable.java:501)
        at org.jboss.remoting3.spi.AbstractHandleableCloseable.runCloseTask(AbstractHandleableCloseable.java:406)
        at org.jboss.remoting3.spi.AbstractHandleableCloseable.closeComplete(AbstractHandleableCloseable.java:277)
        at org.jboss.remoting3.remote.RemoteConnectionChannel.closeAction(RemoteConnectionChannel.java:532)
        at org.jboss.remoting3.spi.AbstractHandleableCloseable.closeAsync(AbstractHandleableCloseable.java:359)
        at org.jboss.remoting3.remote.RemoteConnectionHandler.closeAllChannels(RemoteConnectionHandler.java:392)
        - locked <0x00000007851ae6e0> (a java.util.ArrayDeque)
        at org.jboss.remoting3.remote.RemoteConnectionHandler.handleConnectionClose(RemoteConnectionHandler.java:109)
        at org.jboss.remoting3.remote.RemoteReadListener.handleEvent(RemoteReadListener.java:81)
        - locked <0x00000007851ae6e0> (a java.util.ArrayDeque)
        at org.jboss.remoting3.remote.RemoteReadListener.handleEvent(RemoteReadListener.java:45)
        at org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:72)
        at org.xnio.channels.TranslatingSuspendableChannel.handleReadable(TranslatingSuspendableChannel.java:189)
        at org.xnio.channels.TranslatingSuspendableChannel$1.handleEvent(TranslatingSuspendableChannel.java:103)
        at org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:72)
        at org.xnio.channels.TranslatingSuspendableChannel.handleReadable(TranslatingSuspendableChannel.java:189)
        at org.xnio.ssl.JsseConnectedSslStreamChannel.handleReadable(JsseConnectedSslStreamChannel.java:183)
        at org.xnio.channels.TranslatingSuspendableChannel$1.handleEvent(TranslatingSuspendableChannel.java:103)
        at org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:72)
        at org.xnio.nio.NioHandle.run(NioHandle.java:90)
        at org.xnio.nio.WorkerThread.run(WorkerThread.java:198)
""main"":
        at org.jboss.remoting3.remote.RemoteConnectionChannel.receiveMessage(RemoteConnectionChannel.java:361)
        - waiting to lock <0x00000007851ae6e0> (a java.util.ArrayDeque)
        at org.jboss.as.protocol.mgmt.FutureManagementChannel$Establishing.connectionOpened(FutureManagementChannel.java:217)
        at org.jboss.as.protocol.ProtocolConnectionManager.connect(ProtocolConnectionManager.java:78)
        - locked <0x0000000784978a00> (a org.jboss.as.protocol.ProtocolConnectionManager)
        at org.jboss.as.protocol.mgmt.FutureManagementChannel$Establishing.getChannel(FutureManagementChannel.java:204)
        at org.jboss.as.cli.impl.CLIModelControllerClient.getOrCreateChannel(CLIModelControllerClient.java:160)
        - locked <0x0000000783433408> (a java.lang.String)
        at org.jboss.as.cli.impl.CLIModelControllerClient$2.getChannel(CLIModelControllerClient.java:120)
        at org.jboss.as.protocol.mgmt.ManagementChannelHandler.executeRequest(ManagementChannelHandler.java:123)
        at org.jboss.as.protocol.mgmt.ManagementChannelHandler.executeRequest(ManagementChannelHandler.java:98)
        at org.jboss.as.controller.client.impl.AbstractModelControllerClient.executeRequest(AbstractModelControllerClient.java:236)
        at org.jboss.as.controller.client.impl.AbstractModelControllerClient.execute(AbstractModelControllerClient.java:141)
        at org.jboss.as.controller.client.impl.AbstractModelControllerClient.executeForResult(AbstractModelControllerClient.java:127)
        at org.jboss.as.controller.client.impl.AbstractModelControllerClient.execute(AbstractModelControllerClient.java:71)
        at org.jboss.as.cli.impl.CommandContextImpl.tryConnection(CommandContextImpl.java:980)
        at org.jboss.as.cli.impl.CommandContextImpl.connectController(CommandContextImpl.java:841)
        at org.jboss.as.cli.impl.CommandContextImpl.connectController(CommandContextImpl.java:817)
        at org.jboss.as.cli.impl.CliLauncher.initCommandContext(CliLauncher.java:282)
        at org.jboss.as.cli.impl.CliLauncher.main(CliLauncher.java:250)
        at org.jboss.as.cli.CommandLineMain.main(CommandLineMain.java:34)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:483)
        at org.jboss.modules.Module.run(Module.java:312)
        at org.jboss.modules.Main.main(Main.java:460)
{noformat}

It can be easily reproduce with Eclipse as:
{noformat}
1 start Wildfly
2 uncomment ""JAVA_OPTS=""$JAVA_OPTS -agentlib:jdwp=transport=dt_socket,address=8787,server=y,suspend=y"" in jboss-cli.sh and connect to server
3 add two break points at
    CLIModelControllerClient$ChannelCloseHandler [line: 285] - handleClose(Channel, IOException)
    RemoteConnectionChannel [line: 360] - receiveMessage(Receiver)
4 connect to 8787 from eclipse debug
5 shutdown Wildfly

A deadlock between ""main"" and ""cli-client"" is in Eclipse debug stack.
{noformat}",2014/10/24 5:33 AM
WFCORE-196,"It is fairly easy to produce a hang in domain mode shutdown by launching domain.sh and then soft killing the process with CTRL-C.

If this hang happens, a thread dump will show this

{code}
[Host Controller] ""Remoting ""localhost:MANAGEMENT"" task-16"" prio=5 tid=0x00007fa07423b800 nid=0x3b0b waiting for monitor entry [0x000000010bce6000]
[Host Controller]    java.lang.Thread.State: BLOCKED (on object monitor)
[Host Controller] 	at org.jboss.as.host.controller.ManagedServer.callbackUnregistered(ManagedServer.java:417)
[Host Controller] 	- waiting to lock <0x00000007f7946a30> (a org.jboss.as.host.controller.ManagedServer)
[Host Controller] 	at org.jboss.as.host.controller.ServerInventoryImpl$1.handleClose(ServerInventoryImpl.java:461)
[Host Controller] 	at org.jboss.as.host.controller.ServerInventoryImpl$1.handleClose(ServerInventoryImpl.java:456)
[Host Controller] 	at org.jboss.remoting3.spi.SpiUtils.safeHandleClose(SpiUtils.java:54)
[Host Controller] 	at org.jboss.remoting3.spi.AbstractHandleableCloseable$CloseHandlerTask.run(AbstractHandleableCloseable.java:501)
[Host Controller] 	at org.jboss.remoting3.spi.AbstractHandleableCloseable.runCloseTask(AbstractHandleableCloseable.java:406)
[Host Controller] 	at org.jboss.remoting3.spi.AbstractHandleableCloseable.closeComplete(AbstractHandleableCloseable.java:277)
[Host Controller] 	at org.jboss.remoting3.remote.RemoteConnectionChannel.closeAction(RemoteConnectionChannel.java:532)
[Host Controller] 	at org.jboss.remoting3.spi.AbstractHandleableCloseable.close(AbstractHandleableCloseable.java:153)
[Host Controller] 	at org.jboss.as.protocol.mgmt.ManagementChannelReceiver.handleEnd(ManagementChannelReceiver.java:127)
[Host Controller] 	at org.jboss.remoting3.remote.RemoteConnectionChannel$2.run(RemoteConnectionChannel.java:282)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
[Host Controller] 	at java.lang.Thread.run(Thread.java:744)


[Host Controller] ""Host Controller Service Threads - 13"" prio=5 tid=0x00007fa072cbc800 nid=0xa903 waiting on condition [0x000000010d93a000]
[Host Controller]    java.lang.Thread.State: WAITING (parking)
[Host Controller] 	at sun.misc.Unsafe.park(Native Method)
[Host Controller] 	- parking to wait for  <0x00000007f61e5480> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)
[Host Controller] 	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)
[Host Controller] 	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2043)
[Host Controller] 	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
[Host Controller] 	at org.jboss.as.controller.remote.BlockingQueueOperationListener.retrievePreparedOperation(BlockingQueueOperationListener.java:88)
[Host Controller] 	at org.jboss.as.controller.remote.TransactionalProtocolHandlers.executeBlocking(TransactionalProtocolHandlers.java:76)
[Host Controller] 	at org.jboss.as.host.controller.ManagedServer$ServerStopTask.execute(ManagedServer.java:846)
[Host Controller] 	at org.jboss.as.host.controller.ManagedServer.internalSetState(ManagedServer.java:531)
[Host Controller] 	at org.jboss.as.host.controller.ManagedServer.stop(ManagedServer.java:259)
[Host Controller] 	- locked <0x00000007f7946a30> (a org.jboss.as.host.controller.ManagedServer)
[Host Controller] 	at org.jboss.as.host.controller.ServerInventoryImpl.stopServers(ServerInventoryImpl.java:339)
[Host Controller] 	at org.jboss.as.host.controller.ServerInventoryImpl.shutdown(ServerInventoryImpl.java:437)
[Host Controller] 	at org.jboss.as.host.controller.ServerInventoryService$1.run(ServerInventoryService.java:124)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
[Host Controller] 	at java.lang.Thread.run(Thread.java:744)
[Host Controller] 	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}

The 2nd thread is blocking waiting for a prepared response from one of the servers. The first thread is trying to send a notification that the channel connecting to the server has been closed. The first thread will never unblock because the 2nd thread can't proceed and deliver the information that the channel is closed.

This happens because all the processes (PC, HC, servers) respond to the CTRL-C. So the server is shutting down in parallel and has closed the channel.

In theory this could happen for other reasons too, though. Anything that results in closing the channel while the ManagedServer lock is held.",2014/10/23 5:01 PM
WFCORE-180,NoData,2014/10/17 10:40 AM
WFCORE-178,"ContentRepositoryImpl.removeContent calls File.deleteOnExit if it can't delete the content or parent dirs. This is very wrong:

1) The grandparent dir may have other children completed unrelated to the item being removed.
2) The content in question may have been restored before process exit. For example, a deployment is undeployed, and then a while later the same bits are uploaded again.
3) File.deleteOnExit is a small memory leak. This one's relatively minor.",2014/10/16 4:28 PM
WFCORE-176,"This is the request which is generated by the xml parser

{""operation"" => ""add"",
""type"" => ""user"",
""name"" => ""$local"",
""address"" => [
(""core-service"" => ""management""),
(""access"" => ""authorization""),
(""role-mapping"" => ""SuperUser""),
""include"",
""user-$local""
]

include and user-$local are added separately, not as a pair.
ManagementXml.parseRole(...) line 3345 adds include
then parsePrincipal(...) line 3428 adds the alias.",2014/10/16 10:17 AM
WFCORE-173,"BindingGroupAddHandler does this in the initial step:

SocketBindingGroupResourceDefinition.validateDefaultInterfaceReference(context, model);

It actually adds a step to do other validation, so ^^^ should be moved there.

Doing this removes the requirement to run interface add ops before the socket-binding-group add ops, e.g. in non-xml-parsing based boots or in a post-boot composite operation.",2014/10/15 12:37 PM
WFCORE-171,"File handler resources allow existing directories to be used as the path name for the file. An exception is thrown in the logmanager, but the operation succeeds. Validation of the path should be done in the operations. ",2014/10/15 11:55 AM
WFCORE-163,NoData,2014/10/13 10:08 AM
WFCORE-159,"Handlers can be created with the same name as an existing handler. This was done to reconfigure differences in the logging subsystem XML and the logging.properties file. The problem is it will replace a handler during an {{ADD}} operation if the same name is used on another parent resource.

{code}
/subsystem=logging/async-handler=CONSOLE:add(queue-length=10,overflow-action=BLOCK)
{code}

This will replace the default console handler with the new one keeping the existing console-handler resource. The next boot also fails with no indication on the console.",2014/10/09 7:16 PM
WFCORE-158,Handlers can currently be removed even if the handler is assigned to a logger or another handler. This allows an invalid {{logging.properties}} file to be written and will fail to start the server on the next boot.,2014/10/09 5:48 PM
WFCORE-150,When the suffix is undefined ({{undefine-attribute(name=suffix)}}) on a {{size-rotating-file-handler}} the value {{undefined}} gets written to the suffix which is invalid. The value needs to be set to null if undefined.,2014/10/07 12:06 PM
WFCORE-145,"In the JBoss CLI tool, the ""run-batch --file=script.cli"" command cannot
successfully process lines that start with ""#"" or blank lines. Comments and
blank lines help readability when creating cli batch scripts.

However, running the batch file containing comments/blank lines as a parameter
to jboss-cli.sh works just fine (./jboss-cli.sh -c --file=script.cli). This
difference in accepted syntax creates some confusion for users who are new to
the CLI tool.",2014/10/02 9:28 AM
WFCORE-143,The reply type is STRING so setReplyValueType is not required.,2014/10/02 5:50 AM
WFCORE-140,"Scanner managed deployments have the deployment resource's 'persistent' attribute set to 'false'. This results in the StandaloneXml not persisting the resource to XML, but that depends on custom logic in StandaloneXml that reads the attribute.

The Resource for these deployments should return 'true' from isRuntime() so callers can decided about this without needing internal knowledge of the resource attributes.",2014/10/01 1:21 PM
WFCORE-136,"As part of WFCORE-113, the suffix attribute on size-rotating-file-handler has a little bit different functionality than on other handlers (seconds or milliseconds are allowed). However the validation error message is the same as on other handlers (""seconds or milliseconds are not allowed"").",2014/09/30 11:46 AM
WFCORE-134,"CLIWrapper is using the default encoding which might lead to issue with non US locales.
Also take advantage of this fix to remove some hard coded strings from tests.",2014/09/30 8:12 AM
WFCORE-133,"Full stacktrace is printed for exceptions that occur before the CLI connects to a server.

Instead, only the exception messages should be printed.",2014/09/30 4:31 AM
WFCORE-132,"BoundedQueueThreadPoolWriteAttributeHandler doesn't deal with undefined values for core-threads correctly. It assumes the attribute will be defined, and that's not required.

The attribute doesn't have a fixed default value. Instead, the behavior in add is to set the runtime value to match max-threads of core-threads is undefined. BoundedQueueThreadPoolWriteAttributeHandler should do the same.",2014/09/29 8:58 PM
WFCORE-125,"
It's not possible to configure LDAP cache in security realms under ""authorization=ldap/group-search=principal-to-group""

Possible reason:
The LdapCacheResourceDefinition is not registered under the org.jboss.as.domain.management.security.PrincipalToGroupResourceDefinition

When I try to add the cache configuration manually to standalone.xml, server doesn't start and reports:

15:23:44,619 ERROR [org.jboss.as.controller] (Controller Boot Thread) JBAS014629: No resource definition is registered for address [
    (""core-service"" => ""management""),
    (""security-realm"" => ""JBossTest""),
    (""authorization"" => ""ldap""),
    (""group-search"" => ""principal-to-group""),
    (""cache"" => ""by-search-time"")
]
15:23:44,621 FATAL [org.jboss.as.server] (Controller Boot Thread) JBAS015957: Server boot has failed in an unrecoverable manner; exiting. See previous messages for details.
",2014/09/25 6:07 AM
WFCORE-124,"The end result is if the translated value contains upper case characters the users input will not match, as an example for German ja and Ja - whatever the user inputs it will be converted to 'ja' but is always compared to 'Ja'.",2014/09/24 12:25 PM
WFCORE-161,"When reading any JMX attribute(s), I have noticed a noticeable impact on the performance of our system. After attaching a profiler, I see that getting a single attribute of a JMX bean (either using remoting or using jconsole) is generating thousands of objects, that have to cleaned up by the GC. For instance, 6000 instances of the ModelNode class are created.

A clone is made of the complete management model before executing any JMX operation. This happens in the OperationContextImpl.readResourceFromRoot class.

More background on associated forum thread",2014/09/23 7:04 PM
WFCORE-117,"There is a typo in help message of add-user tool.

Version-Release number of selected component (if applicable):
 EAP 6.4.0.DR1.1

How reproducible:
 Always

Steps to Reproduce:
1. ./add-user.sh --help

Actual results:
...
    -sc <value>                         Define the location the server config 
                                        directory.
...


Expected results:
...
    -sc <value>                         Define the location of the server config 
                                        directory.
...",2014/09/22 7:08 AM
WFCORE-115,"It is always possible this is in code I have added to the CLI so feel free to assign it back if that turns out to be the case ;-)

Steps: -
 - Start wildfly-core
 - Start the CLI and connect to the local server, either with -c or connect command.
 - Shut down server with Ctrl-C and start again
 - Enter command in CLI

Result: -

{noformat}
[standalone@localhost:9990 /] connect
Failed to handle 'connect': java.lang.NullPointerException
{noformat}

Restarting the CLI it is able to connect.",2014/09/19 4:49 AM
WFCORE-114,"The only real implementation of AbstractVaultReader isn't in wildfly-core; it's in the wildfly-full security subsystem module.

This means WildFly Core currently doesn't really support vault expressions.",2014/09/18 3:54 PM
WFCORE-95,NoData,2014/09/11 7:57 AM
WFCORE-92,"- CLI ""deploy"" command with open quote and tab for completion results in a ""StringIndexOutOfBoundsException"" exception

- Type 'connect' to connect to the server or 'help' for the list of supported commands.
{code}
[disconnected /] connect
[standalone@localhost:9999 /] deploy ""d<Tab>

[standalone@localhost:9990 /] deploy ""djava.lang.StringIndexOutOfBoundsException: String index out of range: -1
        at java.lang.String.substring(String.java:1958)
        at org.jboss.as.cli.handlers.WindowsFilenameTabCompleter.complete(WindowsFilenameTabCompleter.java:54)
        at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:229)
        at org.jboss.as.cli.operation.OperationRequestCompleter.complete(OperationRequestCompleter.java:73)
        at org.jboss.as.cli.CommandCompleter.doComplete(CommandCompleter.java:126)
        at org.jboss.as.cli.CommandCompleter.complete(CommandCompleter.java:63)
        at org.jboss.as.cli.impl.Console$Factory$1$1.complete(Console.java:102)
        at org.jboss.aesh.console.Console.complete(Console.java:1155)
        at org.jboss.aesh.console.Console.parseOperation(Console.java:550)
        at org.jboss.aesh.console.Console.read(Console.java:452)
        at org.jboss.aesh.console.Console.read(Console.java:346)
        at org.jboss.as.cli.impl.Console$Factory$1.readLine(Console.java:178)
        at org.jboss.as.cli.impl.CommandContextImpl.interact(CommandContextImpl.java:1283)
        at org.jboss.as.cli.impl.CliLauncher.main(CliLauncher.java:254)
        at org.jboss.as.cli.CommandLineMain.main(CommandLineMain.java:34)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.jboss.modules.Module.run(Module.java:312)
        at org.jboss.modules.Main.main(Main.java:460)
Press any key to continue . . .
{code}",2014/09/09 1:58 AM
WFCORE-82,"There are actually two checks that need to be performed: -
 1 - If a secure port is required then a security realm must be associated with the interface.
 2 - That security realm must supply an SSLContext

For #1 that can at least be validated in the model at the end of stage MODEL.  This will need to be validated for both standalone mode and domain mode - each of these use independent resource definitions.

#2 will have to wait until RUNTIME where we have the opportunity to check that the injected realm does supply a SSLContext.",2014/09/03 1:18 PM
WFCORE-76,"The code inside ReadResourceHandler.doExecuteInternal(OperationContext context, ModelNode operation) goes as follows:

{noformat}
final int recursiveDepth = operation.get(ModelDescriptionConstants.RECURSIVE_DEPTH).asInt(0);
final boolean recursive = recursiveDepth > 0 || operation.get(ModelDescriptionConstants.RECURSIVE).asBoolean(false);
{noformat}

The [documentation|https://docs.jboss.org/author/display/WFLY8/Global+operations] states:

recursive-depth  (int)  The depth to which information about child resources should be included *if recursive is {{true}*. If not set, the depth will be unlimited; i.e. all descendant resources will be included.

The logic, however, as implemented goes - either recursive-depth is greater than zero OR recursive is true.

The proper implementation should be:

{noformat}
final int recursiveDepth = operation.get(ModelDescriptionConstants.RECURSIVE_DEPTH).asInt(0);
final boolean recursive =  operation.get(ModelDescriptionConstants.RECURSIVE).asBoolean(false) && 
                (!operation.get(ModelDescriptionConstants.RECURSIVE_DEPTH).isDefined() || recursiveDepth > 0);
{noformat}

The above snippet works as follows: recurs IF recursive is set AND (either recursive-depth is not defined OR recursive-depth is greater than 0).
  ",2014/08/28 3:47 PM
WFCORE-72,The --force flag is not working with the deploy command in CLI GUI.  The CLI CommandContextImpl is generating the wrong DMR request.,2014/08/26 10:09 PM
WFCORE-71,"The ProtocolLogger class is used in a few places in host-controller and server, but the module.xml for the org.jboss.as.protocol module specifically excludes it from being exported.

The uses aren't complex enough to justify exporting the class, so I'll just change them.",2014/08/26 3:34 PM
WFCORE-65,There is no way to associate a deployment to a specific scanner thus if one deployment fails for a scanner during startup all deployments not persistent will be removed ,2014/08/21 12:40 PM
WFCORE-58,"- When WildFly 9 Alpha1 is started with the following system properties in the ""standalone.conf"" then the admin console behaves abnormally and shows some missing buttons in the console. See attached screenshot ""mssing_add_remove_disable_Buttons.png"".

{code}
JAVA_OPTS=""$JAVA_OPTS -Duser.country=TR -Duser.language=tr""
{code}


- Also it throws following Error while accessing the console URL like [1]
[1] http://localhost:9990/console/App.html#datasources

{code}
10:39:39,223 ERROR [org.jboss.as.controller.management-operation] (XNIO-1 task-8) WFLYCTL0013: Operation (""check-resource-access"") failed - address: ([
    (""subsystem"" => ""datasources""),
    (""data-source"" => ""*""),
    (""connection-properties"" => ""*"")
]): java.lang.IllegalArgumentException: No enum constant org.jboss.as.controller.registry.AttributeAccess.Storage.CONFGURATON
	at java.lang.Enum.valueOf(Enum.java:236) [rt.jar:1.7.0_51]
	at org.jboss.as.controller.registry.AttributeAccess$Storage.valueOf(AttributeAccess.java:91) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.operations.global.ReadResourceDescriptionHandler$CheckResourceAccessHandler.execute(ReadResourceDescriptionHandler.java:431) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:603) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:481) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.AbstractOperationContext.completeStepInternal(AbstractOperationContext.java:282) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:277) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1060) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:296) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:165) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.domain.http.server.DomainApiHandler.handleRequest(DomainApiHandler.java:179) [wildfly-domain-http-interface-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.domain.http.server.security.SubjectDoAsHandler$1.run(SubjectDoAsHandler.java:72) [wildfly-domain-http-interface-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.domain.http.server.security.SubjectDoAsHandler$1.run(SubjectDoAsHandler.java:68) [wildfly-domain-http-interface-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at java.security.AccessController.doPrivileged(Native Method) [rt.jar:1.7.0_51]
	at javax.security.auth.Subject.doAs(Subject.java:415) [rt.jar:1.7.0_51]
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:94) [wildfly-controller-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.domain.http.server.security.SubjectDoAsHandler.handleRequest(SubjectDoAsHandler.java:68) [wildfly-domain-http-interface-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at org.jboss.as.domain.http.server.security.SubjectDoAsHandler.handleRequest(SubjectDoAsHandler.java:63) [wildfly-domain-http-interface-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at io.undertow.server.handlers.BlockingHandler.handleRequest(BlockingHandler.java:50) [undertow-core-1.1.0.Beta5.jar:1.1.0.Beta5]
	at org.jboss.as.domain.http.server.DomainApiCheckHandler.handleRequest(DomainApiCheckHandler.java:83) [wildfly-domain-http-interface-1.0.0.Alpha3.jar:1.0.0.Alpha3]
	at io.undertow.security.handlers.AuthenticationCallHandler.handleRequest(AuthenticationCallHandler.java:52) [undertow-core-1.1.0.Beta5.jar:1.1.0.Beta5]
	at io.undertow.server.Connectors.executeRootHandler(Connectors.java:197) [undertow-core-1.1.0.Beta5.jar:1.1.0.Beta5]
	at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:737) [undertow-core-1.1.0.Beta5.jar:1.1.0.Beta5]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [rt.jar:1.7.0_51]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [rt.jar:1.7.0_51]
	at java.lang.Thread.run(Thread.java:744) [rt.jar:1.7.0_51]
{code}",2014/08/18 1:18 AM
WFCORE-64,"If one's standalone-full.xml configuration contains something like:

<deployments>
  <deployment name=""MyWebApp.war"" runtime-name=""MyWebApp.war"" enabled=""true"">
    <fs-exploded path=""../../SomeDir/MyWebApp.war"" relative-to=""jboss.home.dir""/>
  </deployment>
</deployments>

whether manually inserted (while the server is not running) or installed via the CLI via

  /deployment=ServiceCenter.war/:add(runtime-name=ServiceCenter.war,content=[{archive=false,path=""../../Windchill/ServiceCenter.war"",relative-to=""jboss.home.dir""}])

and a deployment scanner like:

  <subsystem xmlns=""urn:jboss:domain:deployment-scanner:2.0""> 
    <deployment-scanner name=""1"" path=""../../../Applications"" relative-to=""jboss.server.base.dir"" scan-interval=""5000"" auto-deploy-exploded=""true""/> 
  </subsystem> 

a failure by a deployment-scanner to deploy an application (exploded in my case, though I'm not sure this makes a difference) will cause the explicitly listed <deployments> to be removed from the configuration!

This occurs irrespective of the value used for auto-deploy-exploded and to <deployment> elements that had already successfully been deployed and started.",2014/08/11 11:19 AM
WFCORE-48,"(Hopefully this belongs to WildFly Core. If not, please move to WildFly.)

I'm doing a programmatic invocation of a simple mgmt operation on the root mgmt resource, say e.g. {{:whoami}}. I'm doing this against a freshly built WildFly from master branch (commit {{e2b9ecfb}}) and on the client side, I'm depending on {{org.wildfly.core:wildfly-controller-client:1.0.0.Alpha4}}.

The code looks like this:

{code:java}
ModelControllerClient client = ModelControllerClient.Factory.create(""localhost"", 9990);

try {
    ModelNode op = new ModelNode();
    op.get(ClientConstants.OP).set(""whoami"");
    op.get(ClientConstants.OP_ADDR).set("""");
    ModelNode result = client.execute(op);
    System.out.println(result);
} finally {
    client.close();
}
{code}

This fails with an exception like this:

{code}
Exception in thread ""main"" java.io.IOException: java.util.concurrent.ExecutionException: Operation failed
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.executeForResult(AbstractModelControllerClient.java:129)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.execute(AbstractModelControllerClient.java:71)
	at cz.ladicek.wildfly.ErrorReproducer.main(ErrorReproducer.java:17)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:134)
Caused by: java.util.concurrent.ExecutionException: Operation failed
	at org.jboss.threads.AsyncFutureTask.operationFailed(AsyncFutureTask.java:74)
	at org.jboss.threads.AsyncFutureTask.get(AsyncFutureTask.java:268)
	at org.jboss.as.controller.client.impl.AbstractDelegatingAsyncFuture.get(AbstractDelegatingAsyncFuture.java:100)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient.executeForResult(AbstractModelControllerClient.java:127)
	... 7 more
Caused by: java.io.EOFException
	at java.io.DataInputStream.readByte(DataInputStream.java:267)
	at org.jboss.as.protocol.mgmt.ProtocolUtils.expectHeader(ProtocolUtils.java:83)
	at org.jboss.as.controller.client.impl.AbstractModelControllerClient$1.handleRequest(AbstractModelControllerClient.java:167)
	at org.jboss.as.protocol.mgmt.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:270)
	at org.jboss.as.protocol.mgmt.AbstractMessageHandler.handleRequest(AbstractMessageHandler.java:235)
	at org.jboss.as.protocol.mgmt.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:113)
	at org.jboss.as.protocol.mgmt.ManagementChannelReceiver$1.handleMessage(ManagementChannelReceiver.java:56)
	at org.jboss.as.protocol.mgmt.ManagementChannelReceiver.handleMessage(ManagementChannelReceiver.java:84)
	at org.jboss.remoting3.remote.RemoteConnectionChannel$5.run(RemoteConnectionChannel.java:452)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
{code}

However, when I remove the line that sets {{address}} ({{op.get(ClientConstants.OP_ADDR).set("""");}}), it works just fine.

Fine, I made a mistake, but getting an {{EOFException}}? That's hardly an appropriate response. I should get a proper failure ({{""outcome"" => ""failed""}} etc.).",2014/08/09 5:52 AM
WFCORE-521,"A German (or french etc...) system must be used to reproduce.
It is likely this is not limited to MacOS, but I do not have a non-english Linux system available

An out of the box install of wildfly/EAP:

Without configuration, the log file is in German as expected.

Using these CLI comands:

:read-operation-description(name=stop-servers,locale=de_DE) -> german
:read-operation-description(name=stop-servers,locale=en_US) -> german
:read-operation-description(name=stop-servers,locale=fr_FR) -> french

So we cannot get the CLI to produce english output

when configuring JAVA_OPTS in domain.conf with:

JAVA_OPTS=""$JAVA_OPTS -Duser.language=en -Duser.country=DE -Duser.encoding=utf-8

The log is now in English -> works as expected; and:
:read-operation-description(name=stop-servers,locale=de_DE) -> german
:read-operation-description(name=stop-servers,locale=en_US) -> english

So it seems we have a bug where the locale set to start the domain takes precedence over the locale set in the CLI command (but only when English is asked)

I presume this is because English is the default locale.
",2014/08/08 7:08 AM
WFCORE-45,NoData,2014/08/06 9:27 PM
WFCORE-35,NoData,2014/07/30 7:52 AM
WFCORE-33,NoData,2014/07/29 2:23 PM
WFCORE-21,"ExtensionRegistry maintains state that OSHs modify during Stage.MODEL. But ExtensionRegistry doesn't (and can't, readily) support the copy-on-write/publish-on-commit behavior that is ideal in Stage.MODEL, so those state changes need to be reverted by the OSH if the operation rolls back.

Affects ExtensionAddHandler, ExtensionRemoveHandler, ApplyMissingDomainModelResourcesHandler and ApplyExtensionsHandler.",2014/07/25 6:05 PM
WFCORE-8,"This shows up a fair amount in issue reports, either in the CLI output or in the server log:

""failure-description"" => ""JBAS014749: Operation handler failed: null""

The null happens because the message is getting passed the result of throwable.getLocalizedMessage() and that may be null. See DMR-11 for what's likely the most common reason it's null.

If it's null, the code should use the class name of the error message.",2014/07/16 9:39 PM
WFCORE-7,"The AttributeDefinition.convertParameterExpression method is called before the validator has validated the model node. This is because the conversion is part of doing any configured ""cleanup"" of the node before validation. (See AS7-6224.)

MapAttributeDefinition and ListAttributeDefinition break this in their overrides of the method by doing unsafe type conversions. When these fail, users get unfriendly failure messages instead of the ones that the validators would provide.

For example, this bogus CLI command:

{code}
[standalone@localhost:9990 /] /subsystem=datasources/data-source=ExampleDS:write-attribute(name=valid-connection-checker-properties, value=1)
{code}

Produces this in the server log:

{code}
15:46:42,167 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 4) WFLYCTL0013: Operation (""write-attribute"") failed - address: ([
    (""subsystem"" => ""datasources""),
    (""data-source"" => ""ExampleDS"")
]): java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.asPropertyList(ModelValue.java:100) [jboss-dmr-1.2.0.Final.jar:1.2.0.Final]
	at org.jboss.dmr.ModelNode.asPropertyList(ModelNode.java:384) [jboss-dmr-1.2.0.Final.jar:1.2.0.Final]
	at org.jboss.as.controller.MapAttributeDefinition.convertParameterExpressions(MapAttributeDefinition.java:252) [wildfly-controller-1.0.0.Alpha2.jar:1.0.0.Alpha2]
	at org.jboss.as.controller.AttributeDefinition.validateAndSet(AttributeDefinition.java:439) [wildfly-controller-1.0.0.Alpha2.jar:1.0.0.Alpha2]
	at org.jboss.as.controller.AbstractWriteAttributeHandler.execute(AbstractWriteAttributeHandler.java:88) [wildfly-controller-1.0.0.Alpha2.jar:1.0.0.Alpha2]
	at org.jboss.as.controller.operations.global.WriteAttributeHandler.execute(WriteAttributeHandler.java:98) [wildfly-controller-1.0.0.Alpha2.jar:1.0.0.Alpha2]
{code}

There should be nothing in the server log at all for that error; the validator should have caught it and generated an appropriate failure response to the client.",2014/07/16 7:37 PM
WFCORE-5,"org.jboss.as.controller.client.impl.ClientConfigurationImpl

052     static ExecutorService createDefaultExecutor() {
053         final ThreadGroup group = new ThreadGroup(""management-client-thread"");

The ThreadGroup is never cleaned up and creates a memory leak",2014/07/16 6:50 AM
WFCORE-1,"According to WFLY-1359[1], we should be able to add a jar for an existing deployment.

Testing against  WildFly 8.1.0 Final, the deployment-overlay feature reports errors on adding a new .jar for a .rar resource adapter deployment.

[1] - https://issues.jboss.org/browse/WFLY-1359",2014/07/02 1:18 AM
WFCORE-108,"ReloadRequiredWriteAttributeHandler inherits the default behavior of AbstractWriteAttributeHandler.requiresRuntime(), which is to only process Stage.RUNTIME if context.isNormalServer(). So any use in host resources needs to override that behavior. This isn't done in at least some places. See https://bugzilla.redhat.com/show_bug.cgi?id=1085228 for an example.",2014/06/30 4:36 PM
WFCORE-29,"If the MBeans for the patching subsystem are queried during server shutdown, it can result in an IllegalStateException.  InstallationManagerService has already had stop() called on it, so the value is null.

This can be reproduced by the attached EJB, which does a MBeanServer.queryMBeans(null, null); from the @PreDestroy method. It's in a loop to ensure it runs after the installation manager gets de-initialised.

java.lang.IllegalStateException
	at org.jboss.as.patching.installation.InstallationManagerService.getValue(InstallationManagerService.java:87) [wildfly-patching-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.patching.installation.InstallationManagerService.getValue(InstallationManagerService.java:28) [wildfly-patching-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.msc.service.ServiceControllerImpl.getValue(ServiceControllerImpl.java:1158) [jboss-msc-1.2.2.Final.jar:1.2.2.Final]
	at org.jboss.as.patching.management.PatchResource$ElementProviderResourceProvider.children(PatchResource.java:139) [wildfly-patching-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.patching.management.PatchResource$ElementProviderResourceProvider.hasChildren(PatchResource.java:134) [wildfly-patching-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.controller.registry.AbstractModelResource.hasChildren(AbstractModelResource.java:81) [wildfly-controller-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.controller.registry.AbstractModelResource$DelegateResource.hasChildren(AbstractModelResource.java:279) [wildfly-controller-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.jmx.model.RootResourceIterator.doIterate(RootResourceIterator.java:57) [wildfly-jmx-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.jmx.model.RootResourceIterator.doIterate(RootResourceIterator.java:61) [wildfly-jmx-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.jmx.model.RootResourceIterator.iterate(RootResourceIterator.java:43) [wildfly-jmx-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.jmx.model.ModelControllerMBeanHelper.queryMBeans(ModelControllerMBeanHelper.java:125) [wildfly-jmx-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.jmx.model.ModelControllerMBeanServerPlugin.queryMBeans(ModelControllerMBeanServerPlugin.java:159) [wildfly-jmx-8.1.0.Final.jar:8.1.0.Final]
	at org.jboss.as.jmx.PluggableMBeanServerImpl.queryMBeans(PluggableMBeanServerImpl.java:816) [wildfly-jmx-8.1.0.Final.jar:8.1.0.Final]
	at example.ShutdownMBeanQuery.destroy(ShutdownMBeanQuery.java:23)",2014/06/17 1:19 AM
WFCORE-412,NoData,2014/06/10 12:11 PM
WFCORE-128,"The LdapGroupSearcher code will fail if it tries to lookup a group that 
does not exist on the local ldap server.

This can happen when the ldap systems are configured as trusted domains.  
Even though the security-realm is not configured to use the trusted domain
(it is configured to only look at a single ldap server), the 
user's entry on one ldap server could point at a group that exists on 
the other (trusted) ldap server.

The LdapGroupSearcher code attempts to lookup this role and it fails.  This 
failure is sent back to the http server which results in an HTTP 500 error
and leaves the user with no way to authenticate/login.

There is currently not a way to tell the group searcher code to ignore the 
group/role that cannot be found.

2014-06-06 12:44:39,819 TRACE [org.jboss.as.domain.management.security] (XNIO-1 task-1) Group found with distinguishedName=cn=TestManagedRole,ou=People,dc=my-ds-domain,dc=com
2014-06-06 12:44:39,821 TRACE [org.jboss.as.domain.management.security] (XNIO-1 task-1) Failure supplementing Subject: javax.naming.NameNotFoundException: [LDAP: error code 32 - No Such Object]; remaining name 'cn=TestManagedRole,ou=People,dc=my-ds-domain,dc=com'
        at com.sun.jndi.ldap.LdapCtx.mapErrorCode(LdapCtx.java:3112) [rt.jar:1.7.0_45]
        at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:3033) [rt.jar:1.7.0_45]
        at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2840) [rt.jar:1.7.0_45]
        at com.sun.jndi.ldap.LdapCtx.c_getAttributes(LdapCtx.java:1332) [rt.jar:1.7.0_45]
        at com.sun.jndi.toolkit.ctx.ComponentDirContext.p_getAttributes(ComponentDirContext.java:231) [rt.jar:1.7.0_45]
        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.getAttributes(PartialCompositeDirContext.java:139) [rt.jar:1.7.0_45]
        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.getAttributes(PartialCompositeDirContext.java:127) [rt.jar:1.7.0_45]
        at javax.naming.directory.InitialDirContext.getAttributes(InitialDirContext.java:142) [rt.jar:1.7.0_45]
        at javax.naming.directory.InitialDirContext.getAttributes(InitialDirContext.java:142) [rt.jar:1.7.0_45]
        at org.jboss.as.domain.management.security.LdapGroupSearcherFactory$PrincipalToGroupSearcher.search(LdapGroupSearcherFactory.java:256) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.management.security.LdapGroupSearcherFactory$PrincipalToGroupSearcher.search(LdapGroupSearcherFactory.java:191) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.management.security.LdapCacheService$NoCacheCache.search(LdapCacheService.java:223) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.management.security.LdapSubjectSupplementalService$LdapSubjectSupplemental.loadGroupEntries(LdapSubjectSupplementalService.java:218) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.management.security.LdapSubjectSupplementalService$LdapSubjectSupplemental.loadGroups(LdapSubjectSupplementalService.java:195) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.management.security.LdapSubjectSupplementalService$LdapSubjectSupplemental.loadGroups(LdapSubjectSupplementalService.java:188) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.management.security.LdapSubjectSupplementalService$LdapSubjectSupplemental.supplementSubject(LdapSubjectSupplementalService.java:163) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.management.security.SecurityRealmService$1.createSubjectUserInfo(SecurityRealmService.java:200) [wildfly-domain-management-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.http.server.security.RealmIdentityManager.verify(RealmIdentityManager.java:155) [wildfly-domain-http-interface-8.1.0.Final.jar:8.1.0.Final]
        at org.jboss.as.domain.http.server.security.RealmIdentityManager.verify(RealmIdentityManager.java:120) [wildfly-domain-http-interface-8.1.0.Final.jar:8.1.0.Final]
        at io.undertow.security.impl.BasicAuthenticationMechanism.authenticate(BasicAuthenticationMechanism.java:110) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at org.jboss.as.domain.http.server.security.AuthenticationMechanismWrapper.authenticate(AuthenticationMechanismWrapper.java:57) [wildfly-domain-http-interface-8.1.0.Final.jar:8.1.0.Final]
        at io.undertow.security.impl.SecurityContextImpl$AuthAttempter.transition(SecurityContextImpl.java:281) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.security.impl.SecurityContextImpl$AuthAttempter.transition(SecurityContextImpl.java:298) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.security.impl.SecurityContextImpl$AuthAttempter.access$100(SecurityContextImpl.java:268) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.security.impl.SecurityContextImpl.attemptAuthentication(SecurityContextImpl.java:131) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.security.impl.SecurityContextImpl.authTransition(SecurityContextImpl.java:106) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.security.impl.SecurityContextImpl.authenticate(SecurityContextImpl.java:99) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.security.handlers.AuthenticationCallHandler.handleRequest(AuthenticationCallHandler.java:50) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.server.Connectors.executeRootHandler(Connectors.java:177) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:727) [undertow-core-1.0.15.Final.jar:1.0.15.Final]
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [rt.jar:1.7.0_45]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [rt.jar:1.7.0_45]
        at java.lang.Thread.run(Thread.java:744) [rt.jar:1.7.0_45]

",2014/06/06 1:47 PM
WFCORE-220,"E.g. ./jboss-cli.sh -Djboss.cli.config=<PATH>/jboss-cli.xml

The system property won't be set, instead the argument will treated as simply a command line argument.
This has to be fixed in the scripts themselves launching the CLI.",2014/06/04 10:08 AM
WFCORE-27,"A really old commit[1] had the effect that both exploded and zipped deployments in the deployments/ dir are treated as unmanaged content. The original intent was zipped content should be uploaded to the content repo.

This may be ok as I haven't heard about issues it causes. Emmanuel Hugonnet noted that there's an issue with JSP compilation work files from an deployment with a later timestamp not getting discarded if the scanner file has an older timestamp, but that is more an issue with how the JSP compilation work files are maintained than a problem with the scanner creating unmanaged deployments. Switching to managed deployments would fix that, but only for archives.



[1] https://github.com/wildfly/wildfly/commit/fd2d9bc1",2014/05/06 6:51 PM
WFCORE-248,NoData,2014/04/22 2:44 PM
WFCORE-309,"When a system property was defined as:
  /system-property=foo:add(value=""    spaces  "");

it gets written with the correct spaces around it to the configuration file.
When the configuration is read the value gets trimmed and the prefix/suffix of spaces is lost.
",2014/03/26 8:05 AM
WFCORE-313,"When creating reply descriptions, DefaultOperationDescriptionProvider calls attributeDescriptionResolver.getOperationParameterDescription instead of attributeDescriptionResolver.getOperationReplyValueTypeDescription.

A fix needs to not break compatibility for existing users of the incorrect behavior; i.e. call the correct method in a try block, catch any MissingResourceException, and if caught call the incorrect method.",2014/02/17 8:35 PM
WFCORE-280,In DMR expressions can be escaped with {{$$}}. Two passes are made in the [ExpressionResolverImpl|https://github.com/wildfly/wildfly/blob/master/controller/src/main/java/org/jboss/as/controller/ExpressionResolverImpl.java#L119]. The first pass changes {code}$${key}{code} to {code}${key}{code}. The second pass fully expands the expression.,2014/01/22 2:05 PM
WFCORE-378,"Portion of the parent task related to rolling out changes to a domain.

The expectation is that single process timeouts (WFLY-2741) will handle most failure conditions related to domain rollouts (e.g. if a single server hangs, preventing completion of the rollout, eventually that server will time out, allowing the domain wide rollout to continue.) Timeouts in the domain rollout code serve as a second line of defense:

1) In case of protocol or other problems that prevent the calling process learning about the timeout on the remote process
2) In case of bugs in the single process timeout handling on the remote process
3) In mixed domain cases where remote hosts are running previous versions and do not have the timeout function

Potential places to add timeouts:

DomainSlaveHandler->HostControllerUpdateTask.ProxyOperationListener.retrievePreparedOperation()
-- where the master HC waits for responses from slaves

RollingServerGroupUpdateTask.run() -> ServerTaskExecutor.ServerOperationListener.retrievePreparedOperation()
-- timeout here means 1 server didn't respond, but need to move on to next

ConcurrentServerGroupUpdateTask.run() -> ServerTaskExecutor.ServerOperationListener.retrievePreparedOperation()
-- timeout here means none of the remaining servers have responded w/in the timeout

DomainRolloutStepHandler.finalizeOp() -> future.get()
---- the ServerGroupUpdateTask should fail in the normal phase, so any timeout here would indicate a problem committing the tx or a comms problem getting back the response",2014/01/10 4:24 PM
WFCORE-640,"Just getting started w/Wildfly after a long absence from Java.  Fresh download, trying to hit admin console, got instructed to use add-user to add an admin user.

c:\usr\local\wildfly-8.0.0.Beta1\bin>.\add-user.bat

What type of user do you wish to add?
 a) Management User (mgmt-users.properties)
 b) Application User (application-users.properties)
(a): a

 * Error *
JBAS015234: No mgmt-groups.properties files found.

Press any key to continue . . .

c:\usr\local\wildfly-8.0.0.Beta1\bin>echo %JBOSS_HOME%
C:\usr\local\wildfly-8.0.0.Beta1

c:\usr\local\wildfly-8.0.0.Beta1\bin>echo %JAVA_HOME%
C:\java\jdk1.7.0_45

c:\usr\local\wildfly-8.0.0.Beta1\bin>echo %M2_HOME%
C:\usr\local\Maven\3.1.1

c:\usr\local\wildfly-8.0.0.Beta1\bin>mvn -version
Apache Maven 3.1.1 (0728685237757ffbf44136acec0402957f723d9a; 2013-09-17 11:22:2
2-0400)
Maven home: C:\usr\local\Maven\3.1.1
Java version: 1.7.0_45, vendor: Oracle Corporation
Java home: C:\java\jdk1.7.0_45\jre
Default locale: en_US, platform encoding: Cp1252
OS name: ""windows 7"", version: ""6.1"", arch: ""x86"", family: ""windows""
c:\usr\local\wildfly-8.0.0.Beta1\bin>",2013/11/06 9:58 PM
WFCORE-13,"It's not possible to call ""non-published"" operations (those that are not visible in the resource tree, e.g. {{describe}}) via JMX, while it's entirely possible to call them via CLI (e.g. {{/subsystem=security:describe}}) and other management interfaces.

The problem lies in the fact that {{ModelControllerMBeanHelper.invoke}} method checks {{if (!accessControl.isExecutableOperation(operationName))}} and the {{isExecutableOperation}} method assumes that the operation will be visible in the resource tree. In fact, there is a comment stating _should not happen_, but now we know that it indeed _can_ happen.

What's more, it gives a misleading error message. The {{isExecutableOperation}} returns {{false}} for unknown operations, which results in {{Not authorized to invoke operation}} message. Which is wrong in two different ways simultaneously: 1. the problem isn't authorization, but the fact that the operation can't be found; 2. the user (e.g. in the {{SuperUser}} role) _is_ authorized.

I'm considering this low priority, because 1. JMX is likely to be very rarely used to access the management interface, 2. hiding information isn't nearly as important as leaking them, 3. non-published operations aren't nearly as important as the published ones. It's worth a JIRA nevertheless.",2013/10/24 11:26 AM
WFCORE-315,"{noformat}
[ERROR] Request
[ERROR] {
[ERROR]     ""operation"" => ""composite"",
[ERROR]     ""address"" => [],
[ERROR]     ""steps"" => [
[ERROR]         {
[ERROR]             ""address"" => [(""server-group"" => ""*"")],
[ERROR]             ""operation"" => ""read-resource-description"",
[ERROR]             ""access-control"" => ""trim-descriptions"",
[ERROR]             ""operations"" => true
[ERROR]         },
[ERROR]         {
[ERROR]             ""address"" => [
[ERROR]                 (""host"" => ""master""),
[ERROR]                 (""server"" => ""*"")
[ERROR]             ],
[ERROR]             ""operation"" => ""read-resource-description"",
[ERROR]             ""access-control"" => ""trim-descriptions"",
[ERROR]             ""operations"" => true
[ERROR]         },
[ERROR]         {
[ERROR]             ""address"" => [(""extension"" => ""*"")],
[ERROR]             ""operation"" => ""read-resource-description"",
[ERROR]             ""access-control"" => ""trim-descriptions"",
[ERROR]             ""operations"" => true
[ERROR]         }
[ERROR]     ],
[ERROR]     ""operation-headers"" => {""roles"" => ""OPERATOR""}
[ERROR] }

{noformat}


leads to  


{noformat}
[Host Controller] 16:34:53,544 ERROR [org.jboss.as.controller.management-operation] (XNIO-1 task-12) JBAS014612: Operation (""composite"") failed - address: ([]): java.lang.NullPointerException
[Host Controller]   at org.jboss.as.domain.controller.operations.coordination.HostControllerExecutionSupport$Factory.create(HostControllerExecutionSupport.java:167)
[Host Controller]   at org.jboss.as.domain.controller.operations.coordination.HostControllerExecutionSupport$Factory.create(HostControllerExecutionSupport.java:181)
[Host Controller]   at org.jboss.as.domain.controller.operations.coordination.OperationSlaveStepHandler.addSteps(OperationSlaveStepHandler.java:108)
[Host Controller]   at org.jboss.as.domain.controller.operations.coordination.OperationCoordinatorStepHandler.executeTwoPhaseOperation(OperationCoordinatorStepHandler.java:201)
[Host Controller]   at org.jboss.as.domain.controller.operations.coordination.OperationCoordinatorStepHandler.execute(OperationCoordinatorStepHandler.java:124)
[Host Controller]   at org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler.execute(PrepareStepHandler.java:103)
[Host Controller]   at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:610) [wildfly-controller-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:488) [wildfly-controller-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.controller.AbstractOperationContext.completeStepInternal(AbstractOperationContext.java:277) [wildfly-controller-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:272) [wildfly-controller-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:257) [wildfly-controller-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:142) [wildfly-controller-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.domain.http.server.DomainApiHandler.handleRequest(DomainApiHandler.java:154) [wildfly-domain-http-interface-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.domain.http.server.security.SubjectDoAsHandler$2.run(SubjectDoAsHandler.java:96) [wildfly-domain-http-interface-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.domain.http.server.security.SubjectDoAsHandler$2.run(SubjectDoAsHandler.java:92) [wildfly-domain-http-interface-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at java.security.AccessController.doPrivileged(Native Method) [rt.jar:1.7.0_17]
[Host Controller]   at javax.security.auth.Subject.doAs(Subject.java:415) [rt.jar:1.7.0_17]
[Host Controller]   at org.jboss.as.domain.http.server.security.SubjectDoAsHandler.handleRequest(SubjectDoAsHandler.java:92) [wildfly-domain-http-interface-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at org.jboss.as.domain.http.server.security.SubjectDoAsHandler.handleRequest(SubjectDoAsHandler.java:86) [wildfly-domain-http-interface-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at io.undertow.server.handlers.BlockingHandler.handleRequest(BlockingHandler.java:50) [undertow-core-1.0.0.Beta12.jar:1.0.0.Beta12]
[Host Controller]   at org.jboss.as.domain.http.server.DomainApiCheckHandler.handleRequest(DomainApiCheckHandler.java:87) [wildfly-domain-http-interface-8.0.0.Beta1-SNAPSHOT.jar:8.0.0.Beta1-SNAPSHOT]
[Host Controller]   at io.undertow.security.handlers.AuthenticationCallHandler.handleRequest(AuthenticationCallHandler.java:52) [undertow-core-1.0.0.Beta12.jar:1.0.0.Beta12]
[Host Controller]   at io.undertow.server.HttpHandlers.executeRootHandler(HttpHandlers.java:36) [undertow-core-1.0.0.Beta12.jar:1.0.0.Beta12]
[Host Controller]   at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:614) [undertow-core-1.0.0.Beta12.jar:1.0.0.Beta12]
[Host Controller]   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [rt.jar:1.7.0_17]
[Host Controller]   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [rt.jar:1.7.0_17]
[Host Controller]   at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_17]
[Host Controller] 


{noformat}",2013/09/04 10:36 AM
WFCORE-51,"Deploying VDB with invalid XML (closed translator tag). Causes following error:

[org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1)  JBAS015009: Scan found incompletely copied file content for deployment standalone/deployments/loop-vdb.xml. Deployment changes will not be processed until all content is complete.
",2013/04/17 6:24 AM
WFCORE-213,"The algorithm for removing unused deployments from the content repository is based on doing this as part of undeploy operation execution. This doesn't cover cases where the content is never explicitly undeployed. For example:

1) Scanner content that is updated when the server is offline; the old content will not have been ""undeployed"" during shutdown, and on startup the new content will be installed.

2) Similar issues with deployments generated from module resources (see ""A Mixed Approach on https://community.jboss.org/wiki/ExtendingAS7). When the server shuts down, there is no ""subsystem remove"" as part of shutdown, so the content added during start will not be removed.

Note that the content repository can include things other than deployments. Currently it also includes management-client-content (specifically rollout plans) and can potentially include anything. This is why it's a ""content repository"" and not a ""deployment repository."" The solution for this needs to deal with all cases.",2013/03/26 10:22 AM
WFCORE-365,"The usages of min/max-occurs in the model description are not consistent - e.g. missing in ResourceDescription, mostly wrong when used in the descriptionProvider or outdated examples in the documentation.

I'll attach a simple patch which should actually fix that issue in line with the documentation [1] (incl. recursive usage) and the usage of the CLI (ls -l). However there might be more to it.

[1] https://docs.jboss.org/author/display/AS71/Description+of+the+Management+Model",2012/07/17 2:46 AM
WFCORE-362,"We need to update the JVM child resource definition for server-groups and servers to only allow a single JVM configuration (i.e. configuration=JVM) resource. Currently only the first configured VM is used, where the name is the reference to the corresponding host level JVM.",2012/04/17 5:22 AM
WFCORE-317,"When starting a slave host controller with *-backup -cached-dc* at the same time, the servers fail to start. Tested with 7.1.1.Final and 7.1.2.Final-SNAPSHOT today.

Also tried starting only with -backup first (starts OK) and then for the second time with both options, to make sure that cached configuration is already present if it would help, but it didn't.

Host controller should determine availability of domain controller and either backup domain configuration or use the cached one if domain controller is unavailable.

{code}
10:35:36,093 INFO  [org.jboss.modules] (main) JBoss Modules version 1.1.1.GA
10:35:36,176 INFO  [org.jboss.msc] (main) JBoss MSC version 1.0.2.GA
10:35:36,225 INFO  [org.jboss.as] (MSC service thread 1-3) JBAS015899: JBoss AS 7.1.2.Final-SNAPSHOT ""Brontes"" starting
10:35:36,612 WARN  [org.jboss.as.host.controller] (Controller Boot Thread) JBAS010930: Cannot load the domain model using using --backup
10:35:36,617 INFO  [org.xnio] (MSC service thread 1-6) XNIO Version 3.0.3.GA
10:35:36,631 INFO  [org.xnio.nio] (MSC service thread 1-6) XNIO NIO Implementation Version 3.0.3.GA
10:35:36,649 INFO  [org.jboss.remoting] (MSC service thread 1-6) JBoss Remoting version 3.2.4.GA
10:35:36,970 ERROR [org.jboss.as.host.controller] (Controller Boot Thread) JBAS010907: Failed to start server (server-one): java.util.NoSuchElementException: No child 'server-group' exists
	at org.jboss.dmr.ModelValue.requireChild(ModelValue.java:362) [jboss-dmr-1.1.1.Final.jar:1.1.1.Final]
	at org.jboss.dmr.ObjectModelValue.requireChild(ObjectModelValue.java:298) [jboss-dmr-1.1.1.Final.jar:1.1.1.Final]
	at org.jboss.dmr.ModelNode.require(ModelNode.java:812) [jboss-dmr-1.1.1.Final.jar:1.1.1.Final]
	at org.jboss.as.host.controller.ModelCombiner.<init>(ModelCombiner.java:139) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.ServerInventoryImpl.createManagedServer(ServerInventoryImpl.java:474) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.ServerInventoryImpl.startServer(ServerInventoryImpl.java:160) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.ServerInventoryImpl.startServer(ServerInventoryImpl.java:150) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.DomainModelControllerService$DelegatingServerInventory.startServer(DomainModelControllerService.java:521) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.operations.StartServersHandler.cleanStartServers(StartServersHandler.java:114) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.operations.StartServersHandler.access$300(StartServersHandler.java:50) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.operations.StartServersHandler$1.execute(StartServersHandler.java:94) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:385) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:272) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.completeStep(AbstractOperationContext.java:200) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler.executeDirect(PrepareStepHandler.java:122) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler.execute(PrepareStepHandler.java:74) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:385) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:272) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.completeStep(AbstractOperationContext.java:200) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:121) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.DomainModelControllerService.startServers(DomainModelControllerService.java:443) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.DomainModelControllerService.boot(DomainModelControllerService.java:403) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:155) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_30]

10:35:36,989 INFO  [org.jboss.as.remoting] (MSC service thread 1-8) JBAS017100: Listening on /127.0.0.1:29999
10:35:37,015 ERROR [org.jboss.as.host.controller] (Controller Boot Thread) JBAS010907: Failed to start server (server-two): java.util.NoSuchElementException: No child 'server-group' exists
	at org.jboss.dmr.ModelValue.requireChild(ModelValue.java:362) [jboss-dmr-1.1.1.Final.jar:1.1.1.Final]
	at org.jboss.dmr.ObjectModelValue.requireChild(ObjectModelValue.java:298) [jboss-dmr-1.1.1.Final.jar:1.1.1.Final]
	at org.jboss.dmr.ModelNode.require(ModelNode.java:812) [jboss-dmr-1.1.1.Final.jar:1.1.1.Final]
	at org.jboss.as.host.controller.ModelCombiner.<init>(ModelCombiner.java:139) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.ServerInventoryImpl.createManagedServer(ServerInventoryImpl.java:474) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.ServerInventoryImpl.startServer(ServerInventoryImpl.java:160) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.ServerInventoryImpl.startServer(ServerInventoryImpl.java:150) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.DomainModelControllerService$DelegatingServerInventory.startServer(DomainModelControllerService.java:521) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.operations.StartServersHandler.cleanStartServers(StartServersHandler.java:114) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.operations.StartServersHandler.access$300(StartServersHandler.java:50) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.operations.StartServersHandler$1.execute(StartServersHandler.java:94) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:385) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:272) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.completeStep(AbstractOperationContext.java:200) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler.executeDirect(PrepareStepHandler.java:122) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler.execute(PrepareStepHandler.java:74) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:385) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:272) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractOperationContext.completeStep(AbstractOperationContext.java:200) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:121) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.DomainModelControllerService.startServers(DomainModelControllerService.java:443) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.host.controller.DomainModelControllerService.boot(DomainModelControllerService.java:403) [jboss-as-host-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:155) [jboss-as-controller-7.1.2.Final-SNAPSHOT.jar:7.1.2.Final-SNAPSHOT]
	at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_30]

10:35:37,082 INFO  [org.jboss.as] (Controller Boot Thread) JBAS015874: JBoss AS 7.1.2.Final-SNAPSHOT ""Brontes"" (Host Controller) started in 1249ms - Started 11 of 11 services (0 services are passive or on-demand)
{code}

",2012/03/24 6:19 AM
WFCORE-3175,"The {{BootLoggingPatchingStateTestCase}} tests two patches which use a different version and product id for the patch. The tests currently pass because of the order of the [{{Collection.containsAll()}}|https://github.com/wildfly/wildfly-core/blob/0b51f7c1cce7286bf4f4e3f5c9250bf351bbdf1b/testsuite/patching/src/test/java/org/jboss/as/test/patching/BootLoggingPatchingStateTestCase.java#L151]. However if this is flipped the tests fail.

It appears that the messages logged always contain the ""WildFly"" product id. Also the UUID for the failing examples seems to not be logged either.

Example of logged messages for the ""lp1"" patch in the test:
{code}
WildFly cumulative patch ID is: 936c95a3-f08e-4fc0-9917-f7feead4ef25, one-off patches include: 00699c2c-84a5-4bdb-b469-8c2fd66afe2a, c6df609e-1620-4369-af48-8041d4be093f
WildFly cumulative patch ID is: 936c95a3-f08e-4fc0-9917-f7feead4ef25, one-off patches include: 00699c2c-84a5-4bdb-b469-8c2fd66afe2a, c6df609e-1620-4369-af48-8041d4be093f
{code}

It looks like the same message is logged twice. However the following is what's expected:
{code}
lp1 cumulative patch ID is: base, one-off patches include: 50a820e4-3659-437d-86f2-fa1d64728adb
WildFly cumulative patch ID is: 936c95a3-f08e-4fc0-9917-f7feead4ef25, one-off patches include: 00699c2c-84a5-4bdb-b469-8c2fd66afe2a, c6df609e-1620-4369-af48-8041d4be093f
{code}

I'm not sure if this is just an issue with the test or if there is a bug in patching.",2017/08/09 1:41 PM
WFCORE-3174,When the internationalized messages are added to WildFly Core some of the tests fail as they make assumptions based on English messages. Anyone running the test suite with a language that has translations would see test failures once these message bundles are added.,2017/08/09 1:10 PM
WFCORE-3151,"Operation {{reload-certificate-revocation-list}} on Elytron {{trust-manager}} should fail when invalid CRL file is provided.

When invalid file is provided, the operation succeed and an error raises in server log only with the first request. Old CRL is kept in use.

An administrator should be immediately aware that reload of the CRL failed.",2017/08/07 6:37 AM
WFCORE-3149,"Here's a description of the problem from [~sguilhen]:

{quote}
Farah Juma Not sure if this is relevant but do you remember a quick chat we had about a month ago when I was converting this QS and I was getting a $local identity when IntermediateEJB attempted to invoke the SecuredEJB? No matter what I did in terms of configuration I was getting $local even if I used a sasl-mech-selector that explicitly defined DIGEST-MD5 as the only mech.
I found another sample app that was working correctly and the only difference was that the intermediate EJB was injecting the reference to the remote EJB instead of doing a lookup. So I've changed the QS to inject the reference to the SecuredEJB in the IntermediateEJB and it started working. I don't know if this has anything to do with the current issue but I was also getting the $local identity when running this QS.
{quote}

The problem occurs for EJB invocations from a remote server when doing a lookup using a PROVIDER_URL when no protocol is set on the {{AuthenticationConfiguration}} that should be used for the remote EJB invocation. In particular, in {{RemoteOutboundConnectionService#start}} when an {{AuthenticationContext}} is specified for a remote outbound connection and no protocol is set on the resolved {{AuthenticationConfiguration}}, we currently use ""http-remoting"" as the default protocol when constructing the destination URI. In {{EjbClientContextSetupProcessor.RegistrationService#transformOne}}, we create an {{AuthenticationContext}} with a rule that attempts to match on ""http-remoting"". However, because the {{InitialContext}} is created using ""remote+http://localhost:8080"" as the PROVIDER_URL, our rule doesn't match this PROVIDER_URL, so the desired {{AuthenticationConfiguration}} doesn't actually get used. We could update {{RemoteOutboundConnectionService#start}} so that ""remote+http"" is used as the default protocol instead of the ""http-remoting"" protocol when no protocol is set on {{AuthenticationConfiguration}} that is resolved for an Elytron remote outbound connection. ",2017/08/04 2:51 PM
WFCORE-3134,"When is operation add-alias run more times for same alias name then is displayed \"" instead of only "" in failure description.

There is expected quotation without backslash in failure description.

*How to reproduce*
*create credential store*
{code}
/subsystem=elytron/credential-store=cs001:add(create=true, credential-reference={clear-text=pass123},location=cs001.jceks)
{code}

*Try to add-alias twice and for second run you get failure description.*
{code}
/subsystem=elytron/credential-store=cs001:add-alias(alias=alias001, secret-value=""secret_value"")
/subsystem=elytron/credential-store=cs001:add-alias(alias=alias001, secret-value=""secret_value"")
{
    ""outcome"" => ""failed"",
    ""result"" => undefined,
    ""failure-description"" => ""WFLYELY00913: Credential alias \""alias001\"" of credential type \""org.wildfly.security.credential.PasswordCredential\"" already exists in the store"",
    ""rolled-back"" => true
}
{code}",2017/08/02 4:18 AM
WFCORE-3133,"Part of solution for: https://issues.jboss.org/browse/WFLY-9155.

Server has to be able to start after such migration -> with empty keystore password.

---
In WildFly there is required to set keystore-password for truststore even though at least in case of JKS, it is possible to read public certificates even without providing the password.

Does it really make sense to require it?

In regards to migration operation, wouldn't it make sense in case of undefined {{ca-certificate-password}} to provide the security-realm truststore configuration default value ""changeit"" instead of failing the whole migrate operation?


",2017/08/02 2:34 AM
WFCORE-3126,"JBEAP-11565 add the following line into the EAP launching scripts:
{noformat}
export MALLOC_ARENA_MAX=""${MALLOC_ARENA_MAX:-1}""
{noformat}

This is problematic on *Solaris 10 sparc*
{noformat}
$ ./standalone.sh
./standalone.sh: MALLOC_ARENA_MAX=1: is not an identifier

$ ./domain.sh                                               
./domain.sh: MALLOC_ARENA_MAX=1: is not an identifier
{noformat}

See https://issues.apache.org/jira/browse/MNG-5829 description:
{noformat}
The $(cmd) idiom is used extensively in bin/mvn from lines 199-220, but this is not supported by older incarnations of /bin/sh (used on the shebang line). The `cmd` idiom is slightly more portable, and looks like it can probably be directly substituted.
{noformat}",2017/07/31 6:09 AM
WFCORE-3125,"I'm seeing this test fail frequently in various CI jobs.

We've got plenty of tests that bounce the various domain processes so making this reliable should be doable.",2017/07/29 11:20 AM
WFCORE-3123,"The set of legal elements in the ""management"" part of a config file is different for domain.xml vs host and standalone.xml. For domain.xml it's meant to be limited to rbac. But ManagementXml does not reflect that, making it easier to introduce mistakes like WFCORE-3121.",2017/07/27 7:09 PM
WFCORE-3121,"The Elytron integration added a resource registration for /core-service=management/access=identity on an HC. It should only be registered at /host=*/core-service=management/access=identity

The domain-wide /core-service=management resource MUST NOT HAVE CHILDREN REGISTERED other than access-authorization. It is not the place to configure HC-specific behavior.

I see use of this resource in enable-elytron.cli scripts used to configure the testsuite. At least in the one in WF full's testsuite/shared; I'm guessing elsewhere too. That must be changed.

If use of this domain-wide resource has ended up in any docs those must be corrected.

[~dlofthouse] FYI. ",2017/07/27 6:40 PM
WFCORE-3119,"The following classes are used only by the subsystem but are public: -
  org.wildfly.extension.elytron.validators.SizeValidator
  org.wildfly.extension.elytron.validators.SuffixValidator",2017/07/27 11:43 AM
WFCORE-3111,"If ldap cache by access time is used cached entry will be evicted by timeout even if it is accessed again within timeout interval. 


",2017/07/26 10:36 AM
WFCORE-3110,"ModelControllerMBeanServerPlugin.accepts throws a NPE if getLegacyDomain returns null.
{code}
java.lang.NullPointerException
at java.util.regex.Matcher.getTextLength(Unknown Source)
at java.util.regex.Matcher.reset(Unknown Source)
at java.util.regex.Matcher.(Unknown Source)
at java.util.regex.Pattern.matcher(Unknown Source)
at org.jboss.as.jmx.model.ModelControllerMBeanServerPlugin.accepts(ModelControllerMBeanServerPlugin.java:111)
at org.jboss.as.jmx.PluggableMBeanServerImpl.queryMBeans(PluggableMBeanServerImpl.java:821)
{code}",2017/07/26 10:31 AM
WFCORE-3109,"WFCORE-3078 fix causes that only one AuditLogItem is written
https://github.com/wildfly/wildfly-core/pull/2627#discussion_r129549452

queuedItems.clear() is inside for (AuditLogItem record : queuedItems)
so only one AuditLogItem is written ?",2017/07/26 8:05 AM
WFCORE-3090,"The message we output when a process is restarted is inconsistent:

standalone.sh ""Restarting application server...""
domain.sh ""Restarting JBoss...""
standalone.ps1 ""Restarting application server..."" (from common.ps1)
domain.ps1 ""Restarting application server..."" (from common.ps1)
standalone.bat nothing
domain.bat nothing

Problems:

1) domain.ps1 is inaccurate as it's not just an application server being restarted
2) The bat files are inconsistent with the others
3) domain.sh's ""Restarting JBoss..."" is a bit vague and is odd theoretically given that WildFly Core is meant to be usable for all sorts of things that may not be regarded as ""JBoss"".

Perhaps just KISS ""Restarting..."" in all cases? If we want to keep ""application server"" for the standalone.xxx cases then common.ps1's function will need to have a param added, and then we need to decide a meaningful value for that param (empty text being a valid choice.)",2017/07/21 10:48 AM
WFCORE-3088,"Testing BouncyCastle external store. Intermittently (25% in lab, 0% locally) it happens alias from dependent credential store is not avalaible on server start.

Could that be problem of ""late"" required service start?

Although, I don't see similar problem with default JKES credential store, neither PKCS11 external credential store. PKCS11 store is however special case, because is loaded once per jvm.

Could that be problem of external credential store with file based keystore?


[1] https://jenkins.hosts.mwqe.eng.bos.redhat.com/hudson/view/EAP7/view/EAP7-Security/view/EAP-7.x-FIPS-mode/job/eap-7x-security-fips-matrix/156/testReport/",2017/07/21 9:39 AM
WFCORE-3087,"*Description of problem:*
add-user.sh duplicates user records in ""mgmt-users.properties"" file if special character is used in user name.

*How reproducible:*
Always

*Steps to Reproduce:*
# cd ${JBOSS_HOME}/bin
# ./add-user.sh -u ""dmin"" -p Pes1234* -s
# ./add-user.sh -u ""admn"" -p Pes1234* -s
# ./add-user.sh -u ""user1"" -p Pes1234* -s
# ./add-user.sh -u ""user2"" -p Pes1234* -s
# cat ../standalone/configuration/mgmt-users.properties

*Actual results:*
{noformat}
...
dmin=add08a6a96a2470830558e37e7cf5894
admn=6702e36900191d0a5438075e9298c950
dmin=add08a6a96a2470830558e37e7cf5894
admn=6702e36900191d0a5438075e9298c950
dmin=add08a6a96a2470830558e37e7cf5894
user1=f111b15c70bc1db3637e0b1dc6848b74
admn=6702e36900191d0a5438075e9298c950
user2=6671636ed99ff984187cd70a159df9af
dmin=add08a6a96a2470830558e37e7cf5894
...
{noformat}",2017/07/21 9:20 AM
WFCORE-3083,"The WFCORE-1106 fix has a big flaw in how it tracks what capabilities are affected when a resource reports reload-required or restart-required. It only examines currently registered caps, but in the resource removal case the op that is calling reloadRequired() will have removed the cap in an earlier stage. So the fact the cap should be reload-required is not recorded.

The WFCORE-1106 integration test doesn't capture this because it uses write-attribute ops to trigger reload-required.

I discovered this when manually verifying the WFLY-4970 scenario was fixed. Turns out it wasn't.

I think the simple solution is to have the CapabilityRegistry cache the removed capabilities and also use that cache when checking what caps are affected by reload/restart required. The cache can be cleared on each publish or rollback of the registry because the data does not need to be retained beyond the span of the op that is making the changes.",2017/07/20 9:19 PM
WFCORE-3080,"Elytron tool scripts use script name as the first parameter.
PS1 script is not working as the last change broke list of parameters. ",2017/07/20 11:53 AM
WFCORE-3079,"I'm not able to use PKCS11 keystore type if the security provider is defined in Elytron's provider-loader resource.

{code}
/subsystem=elytron/provider-loader=opensc:add(class-names=[""sun.security.pkcs11.SunPKCS11""], configuration={name=OpenSC, library=/usr/lib/x86_64-linux-gnu/opensc-pkcs11.so, slotListIndex=1})
{""outcome"" => ""success""}
/subsystem=elytron/key-store=pkcs11ks:add(credential-reference={clear-text=123456}, type=PKCS11, providers=opensc)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {""WFLYCTL0080: Failed services"" => {""org.wildfly.security.key-store.pkcs11ks"" => ""WFLYELY00004: Unable to start the service.
    Caused by: org.jboss.msc.service.StartException in anonymous service: WFLYELY00012: No suitable provider found for type 'PKCS11'""}},
    ""rolled-back"" => true
}
{code}

The server log contains:
{noformat}
10:54:17,503 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-3) MSC000001: Failed to start service org.wildfly.security.key-store.pkcs11ks: org.jboss.msc.service.StartException in service org.wildfly.security.key-store.pkcs11ks: WFLYELY00004: Unable to start the service.
	at org.wildfly.extension.elytron.KeyStoreService.start(KeyStoreService.java:146)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.jboss.msc.service.StartException in anonymous service: WFLYELY00012: No suitable provider found for type 'PKCS11'
	at org.wildfly.extension.elytron.KeyStoreService.resolveProvider(KeyStoreService.java:154)
	at org.wildfly.extension.elytron.KeyStoreService.start(KeyStoreService.java:109)
	... 5 more

10:54:17,508 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 3) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""subsystem"" => ""elytron""),
    (""key-store"" => ""pkcs11ks"")
]) - failure description: {""WFLYCTL0080: Failed services"" => {""org.wildfly.security.key-store.pkcs11ks"" => ""WFLYELY00004: Unable to start the service.
    Caused by: org.jboss.msc.service.StartException in anonymous service: WFLYELY00012: No suitable provider found for type 'PKCS11'""}}
{noformat}",2017/07/20 5:31 AM
WFCORE-3078,"There is an issue at boot for CredentialStore integration in SyslogHandler : this is due to the fact that AuditLogLoggerAddHandler will change the AuditLogger status in the RUNTIME phase that will log an event while the service may not be UP (since the fake service is at the handler level).
https://github.com/wildfly/wildfly-core/blob/master/domain-management/src/main/java/org/jboss/as/domain/management/audit/AuditLogLoggerResourceDefinition.java#L158

Sample of such a failure: https://ci.wildfly.org/viewLog.html?buildId=67476&buildTypeId=WildFlyCore_PullRequestWindows",2017/07/20 3:40 AM
WFCORE-3076,"There is an issue with elytron audit.log handle being open until next GC cycle.

We hit it in installer testing (JBEAP-1404) so the usecase is rather specific. Installer first starts an embedded server via CLI wrapper, do some configuration, stop the embeded server and then tries to delete newly created files from previous procedure (like all log files) - all running in the same JVM. The problem is the deletion step intermittently fails on Windows (it won't let you delete a file with open handle, unlike Linux) but the handle would be open in any OS. Intermittently because it depends on GC activity.

I created a simple project that reproduce the issue with arbitrary EAP/WF distribution https://github.com/jbliznak/embedded-server-filelocking

Run it with:
{{mvn clean test ""-Dwildfly.home=C:\dev\jboss-eap-7.1"" ""-Denforcer.skip"" -Dtest=AuditLogFileLockingTestCase}}

Manual steps to reproduce in Java code:
* start a CLI wrapper
* start embed-server in given server path
* stop embed-server
* terminate CLI wrapper
* try to delete given server path",2017/07/19 1:02 PM
WFCORE-3072,"The test added by WFLY-8990 highlight a problem on windows.
A path containing a ':' makes Paths.get to fail. (Eg: profile/clone-profile-test-case-default/subsystem/mail/mail-session/java:jboss/mail/Default)

[Host Controller] 12:00:52,091 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 3) WFLYCTL0013: Operation (""suggest-capabilities"") failed - address: ([
[Host Controller]     (""host"" => ""master""),
[Host Controller]     (""core-service"" => ""capability-registry"")
[Host Controller] ]): java.nio.file.InvalidPathException: Illegal char <:> at index 73: /profile/clone-profile-test-case-default/subsystem/mail/mail-session/java:jboss/mail/Default
[Host Controller]     at sun.nio.fs.WindowsPathParser.normalize(WindowsPathParser.java:182)
[Host Controller]     at sun.nio.fs.WindowsPathParser.parse(WindowsPathParser.java:153)
[Host Controller]     at sun.nio.fs.WindowsPathParser.parse(WindowsPathParser.java:77)
[Host Controller]     at sun.nio.fs.WindowsPath.parse(WindowsPath.java:94)
[Host Controller]     at sun.nio.fs.WindowsFileSystem.getPath(WindowsFileSystem.java:255)
[Host Controller]     at java.nio.file.Paths.get(Paths.java:84)
[Host Controller]     at org.jboss.as.controller.CapabilityRegistry.lambda$null$4(CapabilityRegistry.java:952)
[Host Controller]     at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
[Host Controller]     at java.util.Iterator.forEachRemaining(Iterator.java:116)
[Host Controller]     at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)",2017/07/18 7:39 AM
WFCORE-3070,"When multiple PKCS11 keystores are configured in domain [1][2]. And PKCS11 store contains secret key. Then this exception is thrown on startup intermittently (but very often, cca 50%). 

{code:server.log}
[Host Controller] 10:15:05,526 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC000001: Failed to start service org.wildfly.security.key-store.oneWayKS: org.jboss.msc.service.StartException in service org.wildfly.security.key-store.oneWayKS: WFLYELY00004: Unable to start the service.
[Host Controller] 	at org.wildfly.extension.elytron.KeyStoreService.start(KeyStoreService.java:146)
[Host Controller] 	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
[Host Controller] 	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
[Host Controller] 	at java.lang.Thread.run(Thread.java:745)
[Host Controller] Caused by: java.io.IOException: load failed
[Host Controller] 	at sun.security.pkcs11.P11KeyStore.engineLoad(P11KeyStore.java:763)
[Host Controller] 	at java.security.KeyStore.load(KeyStore.java:1445)
[Host Controller] 	at org.wildfly.security.keystore.AtomicLoadKeyStoreSpi.engineLoad(AtomicLoadKeyStoreSpi.java:55)
[Host Controller] 	at java.security.KeyStore.load(KeyStore.java:1445)
[Host Controller] 	at org.wildfly.extension.elytron.KeyStoreService.start(KeyStoreService.java:137)
[Host Controller] 	... 5 more
[Host Controller] Caused by: java.security.KeyStoreException: invalid KeyStore state: found multiple secret keys sharing same CKA_LABEL [my-key]
[Host Controller] 	at sun.security.pkcs11.P11KeyStore.mapLabels(P11KeyStore.java:2408)
[Host Controller] 	at sun.security.pkcs11.P11KeyStore.engineLoad(P11KeyStore.java:755)
[Host Controller] 	... 9 more
{code}

Storing secret key into PKCS11 store is necessary for FIPS Credential store implementation.

{code:java|title=sun.security.pkcs11.P11KeyStore.java}
           for (long handle : handles) {
                attrs = new CK_ATTRIBUTE[] { new CK_ATTRIBUTE(CKA_LABEL) };
                token.p11.C_GetAttributeValue(session.id(), handle, attrs);
                if (attrs[0].pValue != null) {
                    // there is a CKA_LABEL
                    String cka_label = new String(attrs[0].getCharArray());
                    if (sKeyMap.get(cka_label) == null) {
                        sKeyMap.put(cka_label, new AliasInfo(cka_label));
                    } else {
                        throw new KeyStoreException(""invalid KeyStore state: "" +
                                ""found multiple secret keys sharing same "" +
                                ""CKA_LABEL ["" +
                                cka_label +
                                ""]"");
                    }
                }
            }
{code}

It seems to me problem will be PKCS11 store (system wide) is loaded concurrently multiple times and therefore sometimes JDK check triggers false positive alarm [3].

[1] https://gitlab.mw.lab.eng.bos.redhat.com/jbossqe-eap/tests-security/blob/7.x/fips/src/test/resources/host-configs/elytron/host-master-ssl-2way.xml
[2] https://gitlab.mw.lab.eng.bos.redhat.com/jbossqe-eap/tests-security/blob/7.x/fips/src/test/resources/host-configs/elytron/host-slave-ssl-2way.xml
[3] http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/sun/security/pkcs11/P11KeyStore.java#2408",2017/07/18 4:14 AM
WFCORE-3069,"Only MD5 and SHA-1 hash algorithms are valid in OneTimePasswordImpl.

{code:title=/subsystem=elytron/filesystem-realm=a:read-operation-description(name=set-password)}
           ""otp"" => {
                ""type"" => OBJECT,
                ""description"" => ""A one-time password, used by the OTP SASL mechanism."",
                ""expressions-allowed"" => false,
                ""required"" => false,
                ""nillable"" => true,
                ""value-type"" => {
                    ""algorithm"" => {
                        ""type"" => STRING,
                        ""description"" => ""The algorithm used to encrypt the password."",
                        ""expressions-allowed"" => false,
                        ""required"" => false,
                        ""nillable"" => true,
                        ""default"" => ""otp-sha1"",
                        ""allowed"" => [
                            ""otp-md5"",
                            ""otp-sha1""
                        ]
                    },
                    ""hash"" => {
                        ""type"" => STRING,
                        ""description"" => ""The hash represented by this password."",
                        ""expressions-allowed"" => true,
                        ""required"" => true,
                        ""nillable"" => false,
                        ""min-length"" => 1L,
                        ""max-length"" => 2147483647L
                    },
                    ""seed"" => {
                        ""type"" => STRING,
                        ""description"" => ""The seed used to generate the hash."",
                        ""expressions-allowed"" => true,
                        ""required"" => true,
                        ""nillable"" => false,
                        ""min-length"" => 1L,
                        ""max-length"" => 2147483647L
                    },
                    ""sequence"" => {
                        ""type"" => INT,
                        ""description"" => ""The sequence number used to generate the hash."",
                        ""expressions-allowed"" => true,
                        ""required"" => true,
                        ""nillable"" => false
                    }
                }
            }
{code}

Extend list to more secure hash algorithms, e.g. digest-sha-256 digest-sha-512?

For example MD5 is not allowed in FIPS mode [1]. Although SHA-1 is, it is generally considered to be not secure anymore.


[1] http://csrc.nist.gov/publications/fips/fips140-2/fips1402annexa.pdf
",2017/07/17 1:49 PM
WFCORE-3064,"Suffix in Elytron periodic-rotating-file-audit-log cannot include second-of-minute or fraction-of-second symbol. However this symbol is checked even in text (some string in ''). This means that symbols 's' or 'S' cannot be used in text. It is probably caused by incorrectly implemented condition in {{org.wildfly.extension.elytron.validators.SuffixValidator.validateParameter}} method [1].

[1] https://github.com/wildfly/wildfly-core/blob/7032d8b6cf5a87ab32cc27b2712b4d89c1683c88/elytron/src/main/java/org/wildfly/extension/elytron/validators/SuffixValidator.java#L49",2017/07/13 6:58 AM
WFCORE-3062,"When reading the description of attributes of type OBJECT, the access constraints of the value types contained in the object attribute are not displayed.

Example: In BaseHttpInterfaceResourceDefinition we have an http-upgrade attribute of type OBJECT that contains the sasl-authentication-factory attribute, which is a simple attribute with an access constraint.

When running /core-service=management/management-interface=http-interface:read-resource-description(recursive=true) in the CLI the constraint is not displayed for the attribute:
{noformat}
            ""http-upgrade"" => {
                ""type"" => OBJECT,
                ""description"" => ""HTTP Upgrade specific configuration"",
                ""expressions-allowed"" => false,
                ""required"" => false,
                ""nillable"" => true,
                ""value-type"" => {
                    ""enabled"" => {
                        ""type"" => BOOLEAN,
                        ""description"" => ""Flag that indicates HTTP Upgrade is enabled, which allows HTTP requests to be upgraded to native remoting connections"",
                        ""expressions-allowed"" => false,
                        ""required"" => false,
                        ""nillable"" => true,
                        ""default"" => false
                    },
                    ""sasl-authentication-factory"" => {
                        ""type"" => STRING,
                        ""description"" => ""The server side SASL authentication policy to use to secure the interface where the connection is after a HTTP upgrade."",
                        ""expressions-allowed"" => false,
                        ""required"" => false,
                        ""nillable"" => true,
                        ""capability-reference"" => ""org.wildfly.security.sasl-authentication-factory"",
                        ""min-length"" => 1L,
                        ""max-length"" => 2147483647L,
                    }
                },
                ""access-type"" => ""read-write"",
                ""storage"" => ""configuration"",
                ""restart-required"" => ""all-services""
            }
{noformat}",2017/07/12 2:47 PM
WFCORE-3054,"*Description of problem:*
Connection timeout CLI issue on HTTPS, if more cli clients are used in a loop. 

*Steps to Reproduce:*
# configure https
# loop, more clients in parralel:
#* ./jboss-cli.sh -c "":read-attribute(name=server-state)"" -Djavax.net.ssl.trustStore=... -Djavax.net.ssl.trustStorePassword=...

*How reproducible:*
Intermittently

*Actual results:*
Thread dump is attached",2017/07/10 5:41 AM
WFCORE-3039,"With the following three commands the server becomes unable to boot due to a missing dependency: -

{noformat}
/subsystem=elytron:write-attribute(name=initial-providers, value=combined-providers)
/subsystem=elytron:undefine-attribute(name=final-providers)
/subsystem=elytron/aggregate-providers=combined-providers:remove
{noformat}

If however I execute :reload after the first two commands, the final command will fail correctly.

{noformat}
[standalone@localhost:9990 /] /subsystem=elytron/aggregate-providers=combined-providers:remove
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0367: Cannot remove capability 'org.wildfly.security.providers.combined-providers' as it is required by other capabilities:
capability 'org.wildfly.security.elytron' requires it for attribute 'initial-providers' at address '/subsystem=elytron'"",
    ""rolled-back"" => true
}
{noformat}

I am only listing the 'Domain Management' component as I believe the security example is just the reproducer.
",2017/07/04 5:58 AM
WFCORE-3029,"This image appears on the welcome page of a fresh WildFly install when you access the admin console port:

!image-2017-06-28-12-27-00-808.png! 

Users should not normally run WildFly as root, so this should probably be changed.",2017/06/28 1:28 PM
WFCORE-3024,"When setting up the {{AuthenticationConfiguration}} during the start of {{RemoteOutboundConnectionService}}, the {{SecurityDomain}} defined to forward/propagate identities is lost making impossible to propagate identities when connecting to a remote service (e.g.: EJB).

The reference to the {{AuthenticationConfiguration}} can not be kept by the service but obtained at runtime during invocations in order to be able to obtain the current identity for a given {{SecurityDomain}}.",2017/06/28 8:45 AM
WFCORE-3017,"Some /subsystem=elytron/key-store operations should probably be marked runtime-only. (edit: this is already part of JBEAP-11790) Their handlers extends ElytronRuntimeOnlyHandler and they don't seem to change anything in model. 

load
store
read-alias
read-aliases
remove-alias

{code}
[standalone@embedded /] /subsystem=elytron/key-store=aa:read-operation-description(name=load      
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""load"",
        ""description"" => ""Load the KeyStore, if the KeyStore is file backed this will involve re-reading the contents of the file."",
        ""request-properties"" => {},
        ""reply-properties"" => {},
        ""read-only"" => false,
        ""runtime-only"" => false
    }
}
[standalone@embedded /] /subsystem=elytron/key-store=aa:read-operation-description(name=store
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""store"",
        ""description"" => ""Store the KeyStore to file, this operation will fail for any KeyStore instances not backed by a file.  If the file does not exist and it was not flagged as required it will be created."",
        ""request-properties"" => {},
        ""reply-properties"" => {},
        ""read-only"" => false,
        ""runtime-only"" => false
    }
}
[standalone@embedded /] /subsystem=elytron/key-store=aa:read-operation-description(name=read-alias
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""read-alias"",
        ""description"" => ""Read an alias from a KeyStore."",
        ""request-properties"" => {""alias"" => {
            ""type"" => STRING,
            ""description"" => ""The alias of the KeyStore item to read."",
            ""expressions-allowed"" => false,
            ""required"" => true,
            ""nillable"" => false,
            ""min-length"" => 1L,
            ""max-length"" => 2147483647L
        }},
        ""reply-properties"" => {},
        ""read-only"" => true,
        ""runtime-only"" => false
    }
}
[standalone@embedded /] /subsystem=elytron/key-store=aa:read-operation-description(name=read-aliases
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""read-aliases"",
        ""description"" => ""Read aliases from a KeyStore."",
        ""request-properties"" => {},
        ""reply-properties"" => {},
        ""read-only"" => true,
        ""runtime-only"" => false
    }
}
[standalone@embedded /] /subsystem=elytron/key-store=aa:read-operation-description(name=remove-alias
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""remove-alias"",
        ""description"" => ""Remove an alias from a KeyStore."",
        ""request-properties"" => {""alias"" => {
            ""type"" => STRING,
            ""description"" => ""The alias of the KeyStore item to remove."",
            ""expressions-allowed"" => false,
            ""required"" => true,
            ""nillable"" => false,
            ""min-length"" => 1L,
            ""max-length"" => 2147483647L
        }},
        ""reply-properties"" => {},
        ""read-only"" => false,
        ""runtime-only"" => false
    }
}
{code}

*Also I'm not sure whether they should be registered at /profile resources in domain as they are rolled out to servers (servers might try to write to file concurrently).*

{code}
[domain@localhost:9990 /] /profile=default/subsystem=elytron/key-store=test:store()
{
    ""outcome"" => ""failed"",
    ""result"" => undefined,
    ""failure-description"" => {""WFLYDC0074: Operation failed or was rolled back on all servers. Server failures:"" => {""server-group"" => {""main-server-group"" => {""host"" => {""master"" => {
        ""server-one"" => ""WFLYELY00010: Unable to save KeyStore - KeyStore file '/tmp/test' does not exist."",
        ""server-two"" => ""WFLYELY00010: Unable to save KeyStore - KeyStore file '/tmp/test' does not exist.""
    }}}}}},
    ""rolled-back"" => true,
    ""server-groups"" => {""main-server-group"" => {""host"" => {""master"" => {
        ""server-one"" => {""response"" => {
            ""outcome"" => ""failed"",
            ""result"" => undefined,
            ""failure-description"" => ""WFLYELY00010: Unable to save KeyStore - KeyStore file '/tmp/test' does not exist."",
            ""rolled-back"" => true
        }},
        ""server-two"" => {""response"" => {
            ""outcome"" => ""failed"",
            ""result"" => undefined,
            ""failure-description"" => ""WFLYELY00010: Unable to save KeyStore - KeyStore file '/tmp/test' does not exist."",
            ""rolled-back"" => true
        }}
    }}}}
}
{code}

priority set to blocker to decide whether operations can be registered at profile resources. They can be added back later but they cannot be removed. ",2017/06/27 9:48 AM
WFCORE-3013,"The elytron subsystem is not checking for appropriate conditions before registering attributes and operations, leading to inappropriate things being registered on the managed domain /profile=*/subsystem=elytron resources. In some cases the OSH handling things attempts to avoid having things blow up if executed on the profile (e.g. ElytronRuntimeOnlyHandler) but really things should not be registered at all if they are not functional.

This JIRA is about attributes and resources, which are a simpler case from operations. A runtime-only resource or attribute really has no function in the /profile=* tree as any sort of runtime behind those is not allowed.

Following are uses of AbstractAttributeDefinitionBuilder.setStorageRuntime() in the subsystem. All or nearly all of these have an issue of some nature:

{code}
src/main/java/org/wildfly/extension/elytron/AvailableMechanismsRuntimeResource.java:        .setStorageRuntime() available-mechanisms -- FIXME not on profile
src/main/java/org/wildfly/extension/elytron/CertificateChainAttributeDefinitions.java:        .setStorageRuntime() ok; just a base AD for next one
src/main/java/org/wildfly/extension/elytron/CertificateChainAttributeDefinitions.java:                .setStorageRuntime() local-certificates and peer-certificates  -- FIXME not on profile
src/main/java/org/wildfly/extension/elytron/CredentialStoreResourceDefinition.java:            .setStorageRuntime() ""alias"" -- ok; not an attribute (minor fixme to drop pointless call)
src/main/java/org/wildfly/extension/elytron/CredentialStoreResourceDefinition.java:                .setStorageRuntime() ""entry-type"" -- ok; not an attribute (minor fixme to drop pointless call)
src/main/java/org/wildfly/extension/elytron/CredentialStoreResourceDefinition.java:            .setStorageRuntime() ""secret-value"" -- ok; not an attribute (minor fixme to drop pointless call)
src/main/java/org/wildfly/extension/elytron/KeyStoreDefinition.java:        .setStorageRuntime() size -- FIXME not on profile
src/main/java/org/wildfly/extension/elytron/KeyStoreDefinition.java:        .setStorageRuntime() synchronized -- FIXME not on profile
src/main/java/org/wildfly/extension/elytron/KeyStoreDefinition.java:        .setStorageRuntime() modified  -- FIXME not on profile
src/main/java/org/wildfly/extension/elytron/LdapKeyStoreDefinition.java:            .setStorageRuntime() size  -- FIXME not on profile 
src/main/java/org/wildfly/extension/elytron/PropertiesRealmDefinition.java:        .setStorageRuntime() synchronized   -- FIXME not on profile 
src/main/java/org/wildfly/extension/elytron/ProviderAttributeDefinition.java:        .setStorageRuntime() loaded-provider -- FIXME not on profile
src/main/java/org/wildfly/extension/elytron/ProviderAttributeDefinition.java:        .setStorageRuntime() service -- not relevant; inner field of ""loaded-providers""
src/main/java/org/wildfly/extension/elytron/ProviderAttributeDefinition.java:        .setStorageRuntime() loaded-providers -- FIXME not on profile
src/main/java/org/wildfly/extension/elytron/SSLDefinitions.java:            .setStorageRuntime() active-session-count  -- FIXME not on profile 
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/SSLSessionDefinition.java:            .setStorageRuntime() -- FIXME resource should not be on profile
src/main/java/org/wildfly/extension/elytron/ServiceStateDefinition.java:        .setStorageRuntime() state  -- FIXME not on profile 
{code}

I believe I'll resolve this via some sort of utility code that the registration logic can call in order to avoid invalid registrations. See also WFCORE-2829.",2017/06/26 4:37 PM
WFCORE-3012,"ReloadCertificateRevocationList in SSLDefinitions should extend ElytronRuntimeOnlyHandler so it won't try and execute runtime work on a profile resource.

Possibly this op shouldn't be registered at all on a profile resource, but changing this is a simple way to guard against problems if it is.",2017/06/26 1:11 PM
WFCORE-3007,"some xxx-realm operations should be marked runtime-only. Their handlers extends ElytronRuntimeOnlyHandler and they don't seem to change anything in model. 

properties-realm:load
caching-realm:clear-cache

{code}
[domain@localhost:9990 /] /profile=default/subsystem=elytron/properties-realm=ApplicationRealm:read-operation-description(name=load
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""load"",
        ""description"" => ""Reload the properties files from the file system."",
        ""request-properties"" => {},
        ""reply-properties"" => {},
        ""read-only"" => false,
        ""runtime-only"" => false
    }
}
[domain@localhost:9990 /] /profile=default/subsystem=elytron/caching-realm=test:read-operation-description(name=clear-cache
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""clear-cache"",
        ""description"" => ""Removes all entries from the cache."",
        ""request-properties"" => {},
        ""reply-properties"" => {},
        ""read-only"" => false,
        ""runtime-only"" => false
    }
}
{code}",2017/06/26 9:49 AM
WFCORE-3004,"credential-store operation read-aliases should be read-only, it only reads, does not modify
{code}
[standalone@embedded /] /subsystem=elytron/credential-store=test:read-operation-description(name=read-aliases
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""operation-name"" => ""read-aliases"",
        ""description"" => ""Read aliases (entries) from a credential store."",
        ""request-properties"" => {},
        ""reply-properties"" => {},
        ""read-only"" => false,
        ""runtime-only"" => true
    }
}
{code}",2017/06/26 12:40 AM
WFCORE-3003,"Trying to run secmgr testsuite under JDK9 results in

{noformat}
Caused by: java.util.ServiceConfigurationError: java.security.Provider: Provider com.sun.deploy.security.MozillaJSSProvider could not be instantiated
	at java.base/java.util.ServiceLoader.fail(ServiceLoader.java:581)
	at java.base/java.util.ServiceLoader.access$100(ServiceLoader.java:390)
	at java.base/java.util.ServiceLoader$ProviderImpl.newInstance(ServiceLoader.java:799)
	at java.base/java.util.ServiceLoader$ProviderImpl.get(ServiceLoader.java:721)
	at java.base/java.util.ServiceLoader$3.next(ServiceLoader.java:1389)
	at java.base/java.lang.Iterable.forEach(Iterable.java:74)
	at org.wildfly.extension.elytron//org.wildfly.extension.elytron.ProviderDefinitions$1$1.get(ProviderDefinitions.java:201)
	at org.wildfly.extension.elytron//org.wildfly.extension.elytron.ProviderDefinitions$1$1.get(ProviderDefinitions.java:158)
	at org.wildfly.extension.elytron//org.wildfly.extension.elytron.TrivialService.start(TrivialService.java:53)
	at org.jboss.msc//org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
	at org.jboss.msc//org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
{noformat}

and server doesn't start.",2017/06/25 6:34 PM
WFCORE-2999,"Currently model version of logging subsystem is 3.0.0 same as in EAP 7.0.
but model diff reports changes to the model.

So it needs model bump to 4.0.0, as well as transformers.

As a bonus point, it would be really good performance wise if we could move transformers registration to use non deprecated ExtensionTransformerRegistration API.

model diff:
{noformat}
====== Resource root address: [""subsystem"" => ""logging""] - Current version: 3.0.0; legacy version: 3.0.0 =======
--- Problems for relative address to root [""file-handler"" => ""*""]:
Missing operations in current: []; missing in legacy [path-info]
--- Problems for relative address to root [""log-file"" => ""*""]:
Different 'type' for attribute 'stream'. Current: STRING; legacy: LONG
--- Problems for relative address to root [""logging-profile"" => ""*"",""file-handler"" => ""*""]:
Missing operations in current: []; missing in legacy [path-info]
--- Problems for relative address to root [""logging-profile"" => ""*"",""log-file"" => ""*""]:
Different 'type' for attribute 'stream'. Current: STRING; legacy: LONG
--- Problems for relative address to root [""logging-profile"" => ""*"",""periodic-rotating-file-handler"" => ""*""]:
Missing operations in current: []; missing in legacy [path-info]
--- Problems for relative address to root [""logging-profile"" => ""*"",""periodic-size-rotating-file-handler"" => ""*""]:
Missing operations in current: []; missing in legacy [path-info]
--- Problems for relative address to root [""periodic-rotating-file-handler"" => ""*""]:
Missing operations in current: []; missing in legacy [path-info]
--- Problems for relative address to root [""periodic-size-rotating-file-handler"" => ""*""]:
Missing operations in current: []; missing in legacy [path-info]
{noformat}",2017/06/23 7:41 AM
WFCORE-2978,"[1:39 PM] Emmanuel Hugonnet: @BrianStansberry hi, could you take a look at https://github.com/wildfly/wildfly-core/pull/2514
[1:40 PM] Emmanuel Hugonnet: I've a bit of a doubt because i couldn't create a dependency on the credentialstore since auditlog handlers are not services
[1:41 PM] Brian Stansberry: ok. it does seem a bit nasty because of that
[1:41 PM] Brian Stansberry: at a glance
[1:41 PM] Emmanuel Hugonnet: yes
[1:41 PM] Brian Stansberry: a very quick glance
[1:42 PM] Brian Stansberry: ah , but SyslogAuditLogHandler is not an OSH so I won't comment until I really understand :)
[1:43 PM] Emmanuel Hugonnet: yes ;)
[2:04 PM] Brian Stansberry: I don't think that will be reliable; there's no guarantee that store will be started
[2:07 PM] Kabir Khan: I don't think the syslog handler tries to write until boot is done
[2:07 PM] Kabir Khan: could it be possible to lazy init those suppliers?
[2:11 PM] Emmanuel Hugonnet: I guess we would only need the attribute value and a serviceregistry
[2:12 PM] Emmanuel Hugonnet: I'm wondering if this is not lazy per default
[2:12 PM] Emmanuel Hugonnet: as the service is only called when the credential is required as far as I can see
[2:13 PM] Brian Stansberry: yes, it is lazy
[2:43 PM] Kabir Khan: @ehsavoie I think the problem @BrianStansberry mentions is whether the services have stabilised so the CR is ready by the time the syslog write happens
[2:44 PM] Emmanuel Hugonnet: @KabirKhan yes but I don't have any service in the audit log tree to be able to require for the CR to be ready
[2:45 PM] Kabir Khan: @ehsavoie I can try to discuss it on the pm call, perhaps we can do without it for the beta
[2:47 PM] Emmanuel Hugonnet: or I could add a service to get this one on
[2:48 PM] Emmanuel Hugonnet: a bit like whatis done for security realms
[2:53 PM] Kabir Khan: That could be good for the future, but I think for Beta it should be ok as it is
[2:57 PM] Brian Stansberry: @KabirKhan @ehsavoie +1
[2:57 PM] Brian Stansberry: I think it is fine at boot as no logging will happen until MSC has stabilized
[2:57 PM] Brian Stansberry: and probably post boot too
[2:57 PM] Emmanuel Hugonnet: well the boot test is ok
[2:58 PM] Kabir Khan: but we should have a blocker jira to investigate whether our assumptions are correct
[2:58 PM] Emmanuel Hugonnet: ok
[2:58 PM] Brian Stansberry: the scenario is a management op adds the credential store and the syslog handler, and then the syslog handler wants to log before the store service is up
[2:58 PM] Brian Stansberry: but, for audit logging we don't log until op commit/rollback
[2:58 PM] Brian Stansberry: and by then MSC is going to be stablized
[3:06 PM] Kabir Khan: that should be: 'we think we don't log', so that needs checking :)",2017/06/20 3:16 AM
WFCORE-2971,"See https://issues.jboss.org/browse/JBEAP-11190?focusedCommentId=13419465&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-13419465, point #4.

There's a typo in the deprecation warning - missing space. Look for operationto [1].

{noformat}
Operation add against the resource at address /subsystem=jgroups/stack=udp/protocol=org.jgroups.protocols.AUTH/property=auth_class is deprecated, and it might be removed in future version. See the the output of the read-operation-description ***operationto*** learn more about the deprecation.
{noformat}",2017/06/16 8:10 AM
WFCORE-2966,WildFly Elytron tool script has to pass the command name from the script to the tool in the format of {script_name}. This issue depends on the implementation of ELY-1228.,2017/06/15 5:18 PM
WFCORE-2964,"When the HC builds the boot commands for a server on initial boot there is no {{logging.properties}} file in the servers data directory. There's an attempt to discover which configuration file would be used. On some OS's the paths may be the same, but the string representation may be different due to different file separators. When attempting to decide which logging configuration file to use the match may fail which will lead to an incorrect configuration file being used on initial boot only.",2017/06/15 2:59 PM
WFCORE-2962,NoData,2017/06/15 3:34 AM
WFCORE-2958,"When performing composite operation on periodic-rotating-file-handler, it fails with [1] although individual steps passes. This affects Web Console form editing.

[1]
{code}
[standalone@localhost:9990 / #] run-batch 
The batch failed with the following error (you are remaining in the batch editing mode to have a chance to correct the error): 
WFLYCTL0062: Composite operation failed and was rolled back. Steps that failed:
Step: step-1
Operation: /subsystem=logging/periodic-rotating-file-handler=foo:undefine-attribute(name=formatter)
Failure: WFLYCTL0158: Operation handler failed: java.lang.IllegalArgumentException: Formatter ""foo"" is not found
{code}",2017/06/14 12:47 PM
WFCORE-2957,"read-resource without explicitly set include-runtime will show runtime-only resources
{code}
/extension=org.jboss.as.weld:read-resource()
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""module"" => ""org.jboss.as.weld"",
        ""subsystem"" => {""weld"" => undefined}
    }
}
{code}
however adding ""recursive"" will not show the resource at all:
{code}
/extension=org.jboss.as.weld:read-resource(recursive)
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""module"" => ""org.jboss.as.weld"",
        ""subsystem"" => undefined
    }
}
{code}",2017/06/14 11:15 AM
WFCORE-2954,"Application server does not offer SASL mechanisms in order defined in Elytron sasl-authentication-factory. See Steps to Reproduce for more details. 

Screenshot from wireshark 'follow TCP stream' is attached. {{JBOSS-LOCAL-USER}} is offered before {{DIGEST-MD5}}.",2017/06/13 2:13 PM
WFCORE-2938,NoData,2017/06/08 10:50 AM
WFCORE-2935,"PowerShell elytron-tool.ps1 script doesn't work with arguments.

When I add *$args* at the end of line in elytron-tool.ps1 script [1]
{code}
& $JAVA -jar $JBOSS_HOME'\bin\wildfly-elytron-tool.jar' $JAVA_OPTS $args
{code}
it works.

*How to reproduce*
{code}
 PowerShell -ExecutionPolicy Bypass -File elytron-tool.ps1 credential-store --add secret_alias --password pass123 --create -x secret_password -l testBasicWildflyElytronTool.jceks 
{code}
There is shown general help output for all commands in tool.


[1] https://github.com/wildfly/wildfly-core/blob/3.0.0.Beta24/core-feature-pack/src/main/resources/content/bin/elytron-tool.ps1#L14",2017/06/08 7:27 AM
WFCORE-2939,"Updating the contents of a WAR file in a domain controller content repository will usually lead to a disabled deployment in a server group being enabled.

",2017/06/07 5:05 PM
WFCORE-2932,"*Description of problem:*
Some Elytrons tests fails on IBM JDK in WF-CORE:
* org.wildfly.extension.elytron.LdapTestCase#testLdapRealmModifiability
* org.wildfly.extension.elytron.LdapTestCase#testDirContextSsl
* org.wildfly.extension.elytron.LdapTestCase#testLdapRealmDirectVerification
* org.wildfly.extension.elytron.LdapTestCase#testLdapKeyStoreMinimalCli
* org.wildfly.extension.elytron.LdapTestCase#testDirContextInsecure
* org.wildfly.extension.elytron.LdapTestCase#testDirContextSslCredential
* org.wildfly.extension.elytron.LdapTestCase#testLdapRealmIterating
* org.wildfly.extension.elytron.LdapTestCase#testLdapRealm
* org.wildfly.extension.elytron.LdapTestCase#testLdapKeyStoreMaximalService
* org.wildfly.extension.elytron.LdapTestCase#testLdapKeyStoreMaximalCli
* org.wildfly.extension.elytron.LdapTestCase#testLdapKeyStoreMinimalService
* org.wildfly.extension.elytron.LdapTestCase#testLdapKeyStoreCopyRemoveAlias
* org.wildfly.extension.elytron.RealmsTestCase#testOAuth2Realm
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_AuditLogging
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_AuthenticationClient
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_TLS
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_Mappers
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_CredentialSecurityFactories
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_ProviderLoader
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_IdentityManagement
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_SecurityProperties
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_Http
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_Ldap
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_Sasl
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_JaccWithProviders
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_CredentialStores
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testParseAndMarshalModel_Domain
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testSubsystem
* org.wildfly.extension.elytron.SubsystemParsingTestCase#testSchema
* org.wildfly.extension.elytron.TlsTestCase#testSslServiceAuth
* org.wildfly.extension.elytron.TlsTestCase#testProviderTrustManager
* org.wildfly.extension.elytron.TlsTestCase#testSslServiceAuthRequiredButNotProvided
* org.wildfly.extension.elytron.TlsTestCase#testSslServiceNoAuth

This test errors was not fixed in JBEAP-9620, so I create new jira for it (see [comment from JBEAP-9620|https://issues.jboss.org/browse/JBEAP-9620?focusedCommentId=13382141&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13382141])

*How reproducible:*
100%

*Actual results:*
I attached surefire logs to this jira.

*Expected results:*
No errors",2017/06/07 3:15 PM
WFCORE-2928,"If we add a non-existing key-store the error message description is incorrect. We get:
""WFLYELY00010: Unable to save KeyStore - path is not defined."" it should rather says something like ""Keystore test001.jks file does not exist""
",2017/06/07 6:59 AM
WFCORE-2926,"This flag has been introduced in 7.0. It is enabled by default, CLI class should have been updated to disable it by default.
In addition a connect(CommandContextConfiguration config) API should be added to the CLI class to allow for full control on the CommandContext configuration. 
CommandContextConfiguration is located in the impl package although it is exposed from public API  CommandContextFactory. It is already part of the public API.",2017/06/07 5:56 AM
WFCORE-2924,"
{code:java}
/subsystem=io/worker=*:read-attribute(name=max-pool-size)
{code}

Current model description: ""Max worker pool size""

Suggested improvement: ""The maximum number of threads to allow in the underlying java.util.concurrent.ThreadPoolExecutor. When this limit is reached, tasks which cannot be queued are rejected.""",2017/06/06 10:04 AM
WFCORE-2917,"There are some topics for revising in {{allow-all-mechanisms}}, {{allow-sasl-mechanisms}}, {{forbid-sasl-mechanisms}} and {{sasl-mechanism-selector}} of Elytron subsystem and client config file.

1) Since selectors have been introduced in EAP 7.1.0.DR19 what is the reason for {{allow-all-mechanisms}}, {{allow-sasl-mechanisms}} and {{forbid-sasl-mechanisms}}? AFAIK they just provides the subset of configuration which can be set by {{sasl-mechanism-selector}}. It that case {{allow-all-mechanisms}}, {{allow-sasl-mechanisms}} and {{forbid-sasl-mechanisms}} can be completely removed from Elytron configuration because they just duplicates another configuration. Or they provide something which cannot be configured by selectors?

2) These options are mutually exclusive in Elytron subsystem, but all of them can be configured together in Elytron client configuration file. There should be added some check for mutually exclusivity of these options in Elytron client configuration file.",2017/06/05 9:28 AM
WFCORE-2905,"Server-identity/secret integration with credential reference is not correct.

When is set Server-identity/secret to use password obtained from credential-store then there is a problem with it.
I observe that SecretIdentityService expects password as constructor argument [1][2] and afterwards is resolved password from credential-store. But it fails because of regular password isn't defined and it is used as method argument [3].

*Server log*
{code:collapse}
[Host Controller] [0m[31m12:27:48,205 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-8) MSC000001: Failed to start service org.wildfly.core.management.security.realm.ManagementRealm.secret: org.jboss.msc.service.StartException in service org.wildfly.core.management.security.realm.ManagementRealm.secret: Failed to start service[0m
[Host Controller] [31m	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1978)[0m
[Host Controller] [31m	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)[0m
[Host Controller] [31m	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)[0m
[Host Controller] [31m	at java.lang.Thread.run(Thread.java:745)[0m
[Host Controller] [31mCaused by: java.lang.IllegalArgumentException: Last unit does not have enough valid bits[0m
[Host Controller] [31m	at java.util.Base64$Decoder.decode0(Base64.java:734)[0m
[Host Controller] [31m	at java.util.Base64$Decoder.decode(Base64.java:526)[0m
[Host Controller] [31m	at java.util.Base64$Decoder.decode(Base64.java:549)[0m
[Host Controller] [31m	at org.jboss.as.domain.management.security.SecretIdentityService.start(SecretIdentityService.java:77)[0m
[Host Controller] [31m	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)[0m
[Host Controller] [31m	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)[0m
[Host Controller] [31m	... 3 more[0m
{code}




[1] https://github.com/wildfly/wildfly-core/blob/3.0.0.Beta22/domain-management/src/main/java/org/jboss/as/domain/management/security/SecurityRealmAddHandler.java#L753
[2] https://github.com/wildfly/wildfly-core/blob/3.0.0.Beta22/domain-management/src/main/java/org/jboss/as/domain/management/security/SecretIdentityService.java#L68
[3] https://github.com/wildfly/wildfly-core/blob/3.0.0.Beta22/domain-management/src/main/java/org/jboss/as/domain/management/security/SecretIdentityService.java#L77",2017/06/02 6:55 AM
WFCORE-2898,"For SASL and HTTP mechanisms it is possible to define *realm-mapping* as part of **-authentication-factory*. But this cannot be used for EXTERNAL/CLIENT_CERT mechanism, because *ServerAuthenticationContext* is not constructed by mechanism but by *SecurityDomainTrustManager* - without relation to any **-authentication-factory*.

It can be misleading for user, that *EXTERNAL* mechanism is present in *sasl-authentication-factory*, but if *realm-mapper* is defined here, it is ignored: (because SSL authentication finish before any SASL is initiated)
{code:xml}
<sasl-authentication-factory name=""client-cert-digest"" sasl-server-factory=""configured"" security-domain=""client-cert-domain"">
    <mechanism-configuration>
        <mechanism mechanism-name=""EXTERNAL"" realm-mapper=""key-store-realm""/>
    </mechanism-configuration>
</sasl-authentication-factory>
{code}

Should be considered adding way how to pass *realm-mapper* into SSL authentication - maybe add *realm-mapper* attribute into *server-ssl-context* definition?",2017/06/01 12:54 PM
WFCORE-2894,"Attempting to authenticate with authentication context defined in remote outbound connection will always fail unless a correct Elytron default context is defined with following security output on client side server:
{code}13:10:45,693 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=http-remoting://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[scheme=http-remoting,host=127.0.0.1,port=4447], AuthenticationConfiguration=[AuthenticationConfiguration:principal=admin,set-host=127.0.0.1,set-protocol=remote,set-port=4447,credentials-present,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,sasl-mechanism-selector=((!JBOSS-LOCAL-USER&&DIGEST-MD5)),mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
13:10:45,729 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=remote://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[null], AuthenticationConfiguration=[AuthenticationConfiguration:principal=anonymous,set-host=127.0.0.1,set-port=4447,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
13:10:45,756 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=http-remoting://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[scheme=http-remoting,host=127.0.0.1,port=4447], AuthenticationConfiguration=[AuthenticationConfiguration:principal=admin,set-host=127.0.0.1,set-protocol=remote,set-port=4447,credentials-present,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,sasl-mechanism-selector=((!JBOSS-LOCAL-USER&&DIGEST-MD5)),mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
13:10:45,758 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=remote://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[null], AuthenticationConfiguration=[AuthenticationConfiguration:principal=anonymous,set-host=127.0.0.1,set-port=4447,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
{code}

When a correct Elytron default context is defined, security output on client side server is the following:
{code}13:14:10,571 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=http-remoting://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[scheme=http-remoting,host=127.0.0.1,port=4447], AuthenticationConfiguration=[AuthenticationConfiguration:principal=admin,set-host=127.0.0.1,set-protocol=remote,set-port=4447,credentials-present,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,sasl-mechanism-selector=((!JBOSS-LOCAL-USER&&DIGEST-MD5)),mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
13:14:10,602 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=remote://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[], AuthenticationConfiguration=[AuthenticationConfiguration:principal=admin,set-host=127.0.0.1,set-protocol=remote,set-port=4447,credentials-present,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,sasl-mechanism-selector=((!JBOSS-LOCAL-USER&&DIGEST-MD5)),mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
13:14:10,612 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=http-remoting://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[scheme=http-remoting,host=127.0.0.1,port=4447], AuthenticationConfiguration=[AuthenticationConfiguration:principal=admin,set-host=127.0.0.1,set-protocol=remote,set-port=4447,credentials-present,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,sasl-mechanism-selector=((!JBOSS-LOCAL-USER&&DIGEST-MD5)),mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
13:14:10,613 TRACE [org.wildfly.security] (default task-1) getAuthenticationConfiguration uri=remote://127.0.0.1:4447, protocolDefaultPort=-1, abstractType=ejb, abstractTypeAuthority=jboss, purpose=null, MatchRule=[], AuthenticationConfiguration=[AuthenticationConfiguration:principal=admin,set-host=127.0.0.1,set-protocol=remote,set-port=4447,credentials-present,providers-supplier=org.wildfly.security.util.ProviderUtil$1@220487eb,sasl-mechanism-selector=((!JBOSS-LOCAL-USER&&DIGEST-MD5)),mechanism-properties={wildfly.sasl.local-user.quiet-auth=true}]
{code}",2017/05/31 3:28 PM
WFCORE-2891,"There is regression against DR16. When Elytron kerberos security factory is misconfigured - wrong principal name - 401 is returned. Till DR16 it was 500.
IMO 500 is more appropriate in this case as server is misconfigured and authenticatoin is not possible at all.
But 401 means user can try  authenticate with another credential. Also there is no other authentication mechanism configured, which could be tried to authenticate - just SPNEGO.

{code:title=server.log}
09:26:33,615 TRACE [org.wildfly.security] (default task-1) Handling MechanismInformationCallback type='HTTP' name='SPNEGO' host-name='localhost.localdomain' protocol='http'
09:26:33,616 TRACE [org.wildfly.security] (default task-1) Evaluating SPNEGO request: cached GSSContext = null
09:26:33,617 TRACE [org.wildfly.security] (default task-1) Obtaining GSSCredential for the service from callback handler...
09:26:33,617 TRACE [org.wildfly.security] (default task-1) No valid cached credential, obtaining new one...
09:26:33,618 TRACE [org.wildfly.security] (default task-1) Logging in using LoginContext and subject [Subject:
]
09:26:33,623 INFO  [stdout] (default task-1) Debug is  true storeKey true useTicketCache false useKeyTab true doNotPrompt false ticketCache is null isInitiator false KeyTab is /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap71/target/krb/krb.3649597682700651441.keytab refreshKrb5Config is false principal is WRONG_SERVICE/wrong.host tryFirstPass is false useFirstPass is false storePass is false clearPass is false
09:26:33,626 INFO  [stdout] (default task-1) Java config name: /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap71/target/krb/krb5-3763796955751468261.conf
09:26:33,626 INFO  [stdout] (default task-1) Loaded from Java config
09:26:33,627 INFO  [stdout] (default task-1) principal is WRONG_SERVICE/wrong.host@JBOSS.ORG
09:26:33,628 INFO  [stdout] (default task-1) Will use keytab
09:26:33,628 INFO  [stdout] (default task-1) Commit Succeeded 
09:26:33,628 INFO  [stdout] (default task-1) 
09:26:33,628 TRACE [org.wildfly.security] (default task-1) Logging in using LoginContext and subject [Subject:
	Principal: WRONG_SERVICE/wrong.host@JBOSS.ORG
	Private Credential: /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap71/target/krb/krb.3649597682700651441.keytab for WRONG_SERVICE/wrong.host@JBOSS.ORG
] succeed
09:26:33,630 TRACE [org.wildfly.security] (default task-1) Creating GSSName for Principal 'WRONG_SERVICE/wrong.host@JBOSS.ORG'
09:26:33,634 INFO  [stdout] (default task-1) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap71/target/krb/krb.3649597682700651441.keytab for WRONG_SERVICE/wrong.host@JBOSS.ORG
09:26:33,635 INFO  [stdout] (default task-1) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap71/target/krb/krb.3649597682700651441.keytab for WRONG_SERVICE/wrong.host@JBOSS.ORG
09:26:33,635 TRACE [org.wildfly.security] (default task-1) Obtained GSSCredentialCredential [org.wildfly.security.credential.GSSKerberosCredential@1f]
09:26:33,636 TRACE [org.wildfly.security] (default task-1) Handling ServerCredentialCallback: successfully obtained credential type type=class org.wildfly.security.credential.GSSKerberosCredential, algorithm=null, params=null
09:26:33,637 TRACE [org.wildfly.security] (default task-1) Using SpnegoAuthenticationMechanism to authenticate WRONG_SERVICE/wrong.host@JBOSS.ORG using the following mechanisms: [[Lorg.ietf.jgss.Oid;@3409081b]
09:26:33,637 TRACE [org.wildfly.security] (default task-1) Caching GSSContext sun.security.jgss.GSSContextImpl@480e78a0
09:26:33,637 TRACE [org.wildfly.security] (default task-1) Caching KerberosTicket null
09:26:33,637 TRACE [org.wildfly.security] (default task-1) Sent HTTP authorizations: [null]
09:26:33,637 TRACE [org.wildfly.security] (default task-1) Request lacks valid authentication credentials
09:26:33,666 WARN  [org.apache.http.impl.auth.HttpAuthenticator] (main) NEGOTIATE authentication error: No valid credentials provided (Mechanism level: No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt))
09:26:33,667 TRACE [org.wildfly.security] (default task-2) Handling MechanismInformationCallback type='HTTP' name='SPNEGO' host-name='localhost.localdomain' protocol='http'
09:26:33,667 TRACE [org.wildfly.security] (default task-2) Evaluating SPNEGO request: cached GSSContext = null
09:26:33,667 TRACE [org.wildfly.security] (default task-2) Obtaining GSSCredential for the service from callback handler...
09:26:33,668 TRACE [org.wildfly.security] (default task-2) Used cached GSSCredential [[GSSCredential: 
WRONG_SERVICE/wrong.host@JBOSS.ORG 1.2.840.113554.1.2.2 Accept [class sun.security.jgss.krb5.Krb5AcceptCredential]
WRONG_SERVICE/wrong.host@JBOSS.ORG 1.3.6.1.5.5.2 Accept [class sun.security.jgss.spnego.SpNegoCredElement]]]
09:26:33,668 TRACE [org.wildfly.security] (default task-2) Handling ServerCredentialCallback: successfully obtained credential type type=class org.wildfly.security.credential.GSSKerberosCredential, algorithm=null, params=null
09:26:33,668 TRACE [org.wildfly.security] (default task-2) Using SpnegoAuthenticationMechanism to authenticate WRONG_SERVICE/wrong.host@JBOSS.ORG using the following mechanisms: [[Lorg.ietf.jgss.Oid;@b065a6e]
09:26:33,668 TRACE [org.wildfly.security] (default task-2) Caching GSSContext sun.security.jgss.GSSContextImpl@5c1a57e
09:26:33,669 TRACE [org.wildfly.security] (default task-2) Caching KerberosTicket null
09:26:33,669 TRACE [org.wildfly.security] (default task-2) Sent HTTP authorizations: [null]
09:26:33,669 TRACE [org.wildfly.security] (default task-2) Request lacks valid authentication credentials
Debug is  true storeKey false useTicketCache false useKeyTab false doNotPrompt false ticketCache is null isInitiator true KeyTab is null refreshKrb5Config is true principal is null tryFirstPass is false useFirstPass is false storePass is false clearPass is false
Refreshing Kerberos configuration
		[Krb5LoginModule] user entered username: jdukef95f0ce7-ed0b-4086-b498-e11f0cbee025

principal is jdukef95f0ce7-ed0b-4086-b498-e11f0cbee025@JBOSS.ORG
Commit Succeeded 

09:26:33,691 TRACE [org.wildfly.security] (default task-3) Handling MechanismInformationCallback type='HTTP' name='SPNEGO' host-name='localhost.localdomain' protocol='http'
09:26:33,691 TRACE [org.wildfly.security] (default task-3) Evaluating SPNEGO request: cached GSSContext = null
09:26:33,691 TRACE [org.wildfly.security] (default task-3) Obtaining GSSCredential for the service from callback handler...
09:26:33,691 TRACE [org.wildfly.security] (default task-3) Used cached GSSCredential [[GSSCredential: 
WRONG_SERVICE/wrong.host@JBOSS.ORG 1.2.840.113554.1.2.2 Accept [class sun.security.jgss.krb5.Krb5AcceptCredential]
WRONG_SERVICE/wrong.host@JBOSS.ORG 1.3.6.1.5.5.2 Accept [class sun.security.jgss.spnego.SpNegoCredElement]]]
09:26:33,691 TRACE [org.wildfly.security] (default task-3) Handling ServerCredentialCallback: successfully obtained credential type type=class org.wildfly.security.credential.GSSKerberosCredential, algorithm=null, params=null
09:26:33,692 TRACE [org.wildfly.security] (default task-3) Using SpnegoAuthenticationMechanism to authenticate WRONG_SERVICE/wrong.host@JBOSS.ORG using the following mechanisms: [[Lorg.ietf.jgss.Oid;@ee77462]
09:26:33,692 TRACE [org.wildfly.security] (default task-3) Caching GSSContext sun.security.jgss.GSSContextImpl@209bce
09:26:33,692 TRACE [org.wildfly.security] (default task-3) Caching KerberosTicket null
09:26:33,692 TRACE [org.wildfly.security] (default task-3) Sent HTTP authorizations: [null]
09:26:33,692 TRACE [org.wildfly.security] (default task-3) Request lacks valid authentication credentials
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Handling MechanismInformationCallback type='HTTP' name='SPNEGO' host-name='localhost.localdomain' protocol='http'
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Evaluating SPNEGO request: cached GSSContext = null
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Obtaining GSSCredential for the service from callback handler...
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Used cached GSSCredential [[GSSCredential: 
WRONG_SERVICE/wrong.host@JBOSS.ORG 1.2.840.113554.1.2.2 Accept [class sun.security.jgss.krb5.Krb5AcceptCredential]
WRONG_SERVICE/wrong.host@JBOSS.ORG 1.3.6.1.5.5.2 Accept [class sun.security.jgss.spnego.SpNegoCredElement]]]
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Handling ServerCredentialCallback: successfully obtained credential type type=class org.wildfly.security.credential.GSSKerberosCredential, algorithm=null, params=null
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Using SpnegoAuthenticationMechanism to authenticate WRONG_SERVICE/wrong.host@JBOSS.ORG using the following mechanisms: [[Lorg.ietf.jgss.Oid;@511a63e2]
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Caching GSSContext sun.security.jgss.GSSContextImpl@5fdd87b1
09:26:33,757 TRACE [org.wildfly.security] (default task-4) Caching KerberosTicket null
09:26:33,759 TRACE [org.wildfly.security] (default task-4) Sent HTTP authorizations: [Negotiate YIIE1gYGKwYBBQUCoIIEyjCCBMagDTALBgkqhkiG9xIBAgKhBAMCAfaiggStBIIEqWCCBKUGCSqGSIb3EgECAgEAboIElDCCBJCgAwIBBaEDAgEOogcDBQAgAAAAo4IBKGGCASQwggEgoAMCAQWhCxsJSkJPU1MuT1JHoigwJqADAgEAoR8wHRsESFRUUBsVbG9jYWxob3N0LmxvY2FsZG9tYWluo4HhMIHeoAMCARGigdYEgdNZUz5w85v5Lg3rdGjYo4b+X5C6BpUMjg7SMoS+xl5ChgJMY0VQjvizbudYm0UXRRHgDXLE8rH1dx4VjK/yZ4W7GL4yP7wqrZLu9bqG+V6bNu0q5OijcV08XzwvE2EuL7SLhJ+3MtGsAclO/BkZwppYuMMJzFPN0nwguITxE8m+9Y/X+ikRtM2XsXINqduMFM5BfAZIcskA0yQ6ZqqB/gtDq6VGWKZ+KMr9fAMVfqH3DFE+Rwm4Ei6WMg2sJ9bAGpZgHOKjYhQDvMa49fxDth5tL8COpIIDTTCCA0mgAwIBEaKCA0AEggM82CoQag7UyA/xrAduZ14kwQUQiFvL0FNubJqi+r+hDtVd+ip549Veh7/XqskzaSQ/5+MJUhbx879YxkEUrUnnmnkQvtVxlZo7bhQMhhbuoJCA8aeBwOsBLd/DMvk9FxjP7axEfOSB2ENZ02mvEPqy8c039rGmWKpgimrJOjn9v3MkIV6dTtYVutdyW9o9cJGzT2+qOcOcylS19u2MNzIYH5XcpMWzGAX+ij7jNy/w7jHWnh7eXgl89et4L0zNVSsRmSNG6/95/zqvzAUpgmM6OyMTT2Zpd79vFAL/rI9bTsFCkGzB0pBFhcEuNmNiaLD3xKTLzsEpJqruue+7+FYmF9vOFTy1mFxMt5twkkGC48x8bPLFf2F8RAXKlrZp5HAD3MbmrTdCOzFW77yzFbCrCB1Fw0qtzLuWFZFJnMtZL4074WmOMR9upTNR6D76yhUJw8+HV5iPpJzxq84usRUI/jHkF7TdBJll0MpJQbXJMteYGAVp04jaisKsAQVPLfcmgEuamb9nrdTJ3E+zkviB80NhK2JwTZzsnGIudoPWaSl7eM7/XajgM/9MFwWkiB/z7iCtiXdrTLkJg0ZQeBlImNK6MO79NHaO6e5fG+jKEd7SuEa/MJmBRCpTjkc3g87N5wDMzz16wmzgRE96AoF9vS9hJaoM6CkPSigvno1x5A+e4e3+kOObY1QYzR5bJLwG+kzQGhKxkjI5CwS9M0rVkvxIU+BEIWgVCp8447EtXFmrsbREAwQ432kbTDdQLJZeUDjJFY9aoqVoUpePukD3H92icwvQkEvahm6U2q3bstLSKq47VRwtJr7q28PLllFlkFI7WPbsOgl5ZZ+SzvleskVPvNoX5I+HyQJHLO3cz/DGRpswGLxTmCSpRYe3Ul/33AE+sSnhqC9Ndl8e+z7uZgVaCMZci8JJ2/ZUfv72BDKou4BiFIo+G6IzFEFMs0O+x8fueJ/3aKoHSxV5WEANhW9W8mzpewf0wvYojlRL4zgAorVCamSIuG3OB4vq5OSlDEC9raRTR5Sl2EU+5WvDF2UzA6VDpkb58DGVm8FA7O5JFehY7ErEyD8gTM98i5FCK+kUORguAXK3fKVt]
09:26:33,759 TRACE [org.wildfly.security] (default task-4) Processing incoming response to a challenge...
09:26:33,764 INFO  [stdout] (default task-4) Entered Krb5Context.acceptSecContext with state=STATE_NEW
09:26:33,768 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): JBOSS.ORG
09:26:33,768 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): HTTP
09:26:33,768 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): localhost.localdomain
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTab: load() entry length: 79; type: 16
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): JBOSS.ORG
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): HTTP
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): localhost.localdomain
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTab: load() entry length: 87; type: 18
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): JBOSS.ORG
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): HTTP
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): localhost.localdomain
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTab: load() entry length: 63; type: 3
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): JBOSS.ORG
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): HTTP
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): localhost.localdomain
09:26:33,769 INFO  [stdout] (default task-4) >>> KeyTab: load() entry length: 71; type: 17
09:26:33,770 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): JBOSS.ORG
09:26:33,770 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): HTTP
09:26:33,770 INFO  [stdout] (default task-4) >>> KeyTabInputStream, readName(): localhost.localdomain
09:26:33,770 INFO  [stdout] (default task-4) >>> KeyTab: load() entry length: 71; type: 23
09:26:33,770 INFO  [stdout] (default task-4) Looking for keys for: WRONG_SERVICE/wrong.host@JBOSS.ORG
09:26:33,816 TRACE [org.wildfly.security] (default task-4) GSSContext message exchange failed: GSSException: Failure unspecified at GSS-API level (Mechanism level: Invalid argument (400) - Cannot find key of appropriate type to decrypt AP REP - AES128 CTS mode with HMAC SHA1-96)
	at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:856)
	at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342)
	at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285)
	at sun.security.jgss.spnego.SpNegoContext.GSS_acceptSecContext(SpNegoContext.java:906)
	at sun.security.jgss.spnego.SpNegoContext.acceptSecContext(SpNegoContext.java:556)
	at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342)
	at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285)
	at org.wildfly.security.http.impl.SpnegoAuthenticationMechanism.lambda$evaluateRequest$2(SpnegoAuthenticationMechanism.java:164)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.wildfly.security.http.impl.SpnegoAuthenticationMechanism.evaluateRequest(SpnegoAuthenticationMechanism.java:164)
	at org.wildfly.security.http.util.SetMechanismInformationMechanismFactory$1.evaluateRequest(SetMechanismInformationMechanismFactory.java:114)
	at org.wildfly.security.http.util.SecurityIdentityServerMechanismFactory$1.evaluateRequest(SecurityIdentityServerMechanismFactory.java:77)
	at org.wildfly.security.http.HttpAuthenticator$AuthenticationExchange.authenticate(HttpAuthenticator.java:115)
	at org.wildfly.security.http.HttpAuthenticator$AuthenticationExchange.access$100(HttpAuthenticator.java:94)
	at org.wildfly.security.http.HttpAuthenticator.authenticate(HttpAuthenticator.java:78)
	at org.wildfly.elytron.web.undertow.server.SecurityContextImpl.authenticate(SecurityContextImpl.java:100)
	at io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:55)
	at io.undertow.server.handlers.DisableCacheHandler.handleRequest(DisableCacheHandler.java:33)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at io.undertow.security.handlers.AuthenticationConstraintHandler.handleRequest(AuthenticationConstraintHandler.java:53)
	at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:46)
	at io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:64)
	at io.undertow.servlet.handlers.security.ServletSecurityConstraintHandler.handleRequest(ServletSecurityConstraintHandler.java:59)
	at io.undertow.security.handlers.AbstractSecurityContextAssociationHandler.handleRequest(AbstractSecurityContextAssociationHandler.java:43)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at org.wildfly.extension.undertow.security.jacc.JACCContextIdHandler.handleRequest(JACCContextIdHandler.java:61)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at org.wildfly.extension.undertow.deployment.GlobalRequestControllerHandler.handleRequest(GlobalRequestControllerHandler.java:68)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:292)
	at io.undertow.servlet.handlers.ServletInitialHandler.access$100(ServletInitialHandler.java:81)
	at io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:138)
	at io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:135)
	at io.undertow.servlet.core.ServletRequestContextThreadSetupAction$1.call(ServletRequestContextThreadSetupAction.java:48)
	at io.undertow.servlet.core.ContextClassLoaderSetupAction$1.call(ContextClassLoaderSetupAction.java:43)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:272)
	at io.undertow.servlet.handlers.ServletInitialHandler.access$000(ServletInitialHandler.java:81)
	at io.undertow.servlet.handlers.ServletInitialHandler$1.handleRequest(ServletInitialHandler.java:104)
	at io.undertow.server.Connectors.executeRootHandler(Connectors.java:211)
	at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:809)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: KrbException: Invalid argument (400) - Cannot find key of appropriate type to decrypt AP REP - AES128 CTS mode with HMAC SHA1-96
	at sun.security.krb5.KrbApReq.authenticate(KrbApReq.java:278)
	at sun.security.krb5.KrbApReq.<init>(KrbApReq.java:149)
	at sun.security.jgss.krb5.InitSecContextToken.<init>(InitSecContextToken.java:108)
	at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:829)
	... 47 more
{code}
",2017/05/31 7:09 AM
WFCORE-3043,"When is operation add-alias run more times for same alias name then is displayed \"" instead of only "" in failure description.

There is expected quotation without backslash in failure description.

*How to reproduce*
*create credential store*
{code}
/subsystem=elytron/credential-store=cs001:add(create=true, credential-reference={clear-text=pass123},location=cs001.jceks)
{code}

*Try to add-alias twice and for second run you get failure description.*
{code}
/subsystem=elytron/credential-store=cs001:add-alias(alias=alias001, secret-value=""secret_value"")
/subsystem=elytron/credential-store=cs001:add-alias(alias=alias001, secret-value=""secret_value"")
{
    ""outcome"" => ""failed"",
    ""result"" => undefined,
    ""failure-description"" => ""WFLYELY00913: Credential alias \""alias001\"" of credential type \""org.wildfly.security.credential.PasswordCredential\"" already exists in the store"",
    ""rolled-back"" => true
}
{code}",2017/05/30 2:15 AM
WFCORE-2879,"Unable to configure ssl using credential reference.
 
{code:server.log}
08:00:24,687 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC000001: Failed to start service org.wildfly.core.management.security.realm.ManagementWebRealmCr.key-manager: org.jboss.msc.service.StartException in service org.wildfly.core.management.security.realm.ManagementWebRealmCr.key-manager: WFLYDM0018: Unable to start service
	at org.jboss.as.domain.management.security.AbstractKeyManagerService.start(AbstractKeyManagerService.java:91)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.security.UnrecoverableKeyException: Cannot recover key
	at sun.security.provider.KeyProtector.recover(KeyProtector.java:328)
	at sun.security.provider.JavaKeyStore.engineGetKey(JavaKeyStore.java:146)
	at sun.security.provider.JavaKeyStore$JKS.engineGetKey(JavaKeyStore.java:56)
	at sun.security.provider.KeyStoreDelegator.engineGetKey(KeyStoreDelegator.java:96)
	at sun.security.provider.JavaKeyStore$DualFormatJKS.engineGetKey(JavaKeyStore.java:70)
	at java.security.KeyStore.getKey(KeyStore.java:1023)
	at sun.security.ssl.SunX509KeyManagerImpl.<init>(SunX509KeyManagerImpl.java:133)
	at sun.security.ssl.KeyManagerFactoryImpl$SunX509.engineInit(KeyManagerFactoryImpl.java:70)
	at javax.net.ssl.KeyManagerFactory.init(KeyManagerFactory.java:256)
	at org.jboss.as.domain.management.security.AbstractKeyManagerService.createKeyManagers(AbstractKeyManagerService.java:136)
	at org.jboss.as.domain.management.security.AbstractKeyManagerService.start(AbstractKeyManagerService.java:89)
	... 5 more

08:00:24,692 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-7) WFLYUT0006: Undertow HTTPS listener https listening on 127.0.0.1:8443
08:00:24,696 INFO  [org.jboss.ws.common.management] (MSC service thread 1-4) JBWS022052: Starting JBossWS 5.1.8.Final-redhat-1 (Apache CXF 3.1.11.redhat-1) 
08:00:24,702 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""core-service"" => ""management""),
    (""security-realm"" => ""ManagementWebRealmCr"")
]) - failure description: {""WFLYCTL0080: Failed services"" => {""org.wildfly.core.management.security.realm.ManagementWebRealmCr.key-manager"" => ""WFLYDM0018: Unable to start service
    Caused by: java.security.UnrecoverableKeyException: Cannot recover key""}}
{code}

When I use {{key-password}} instead of {{key-password-credential-reference}} I am able to make it work.

{code}
/core-service=management/security-realm=ManagementWebRealmCr/server-identity=ssl:add(keystore-path=server.keystore, keystore-relative-to=jboss.server.config.dir,keystore-password-credential-reference={clear-text=123456}, key-password=123456)
{code}


Note, I also get UnrecoverableKeyException: Cannot recover key when I don't specify key-password nor key-password-credential-reference. 

{code}
/core-service=management/security-realm=ManagementWebRealmCr/server-identity=ssl:add(keystore-path=server.keystore, keystore-relative-to=jboss.server.config.dir,keystore-password-credential-reference={clear-text=123456})
{code}


In legacy if {{key-password}} is ommitted {{keystore-password}} is used instead.
",2017/05/29 3:14 AM
WFCORE-2877,"The add-user script is not prompting when entering a username that already exists (to update a user). It automatically overwrites the existing user information. This is what I see when I enter the username ""test"", which already exists:

{code}
[ahoffer@ahoffer bin] $ ./add-user.sh 

What type of user do you wish to add? 
 a) Management User (mgmt-users.properties) 
 b) Application User (application-users.properties)
(a): 

Enter the details of the new user to add.
Using realm 'ManagementRealm' as discovered from the existing property files.
Username : test
Password recommendations are listed below. To modify these restrictions edit the add-user.properties configuration file.
 - The password should be different from the username
 - The password should not be one of the following restricted values {root, admin, administrator}
 - The password should contain at least 8 characters, 1 alphabetic character(s), 1 digit(s), 1 non-alphanumeric symbol(s)
Password : 
{code}

Before I get asked for a password, I should see the following prompt for this existing user:

{code}
User 'test' already exists and is enabled, would you like to... 
 a) Update the existing user password and roles 
 b) Disable the existing user 
 c) Type a new username
{code}",2017/05/26 8:07 AM
WFCORE-2876,"This is follow up on discussion in WFCORE-1912. There is difference in behavior if deployment is deployed like:
{code}deploy ~/tmp/mdb1.jar --unmanaged --headers={rollback-on-runtime-failure=false}{code}
and if it's deployed by copying to deployments directory and setting {{rollback-on-runtime-failure=false}} in model:
{code}
/subsystem=deployment-scanner/scanner=default:write-attribute(name=runtime-failure-causes-rollback,value=false)
{code}

If it's deployed by the 1st way using CLI {{deploy}} command then If deployment is missing some dependencies (like connection factories, queues/topics) and those are added later then deployment is able recover from it and start working without need to reload/restart server or redeploy.

However if it's deployed the 2nd way then deployment does not recover when missing dependencies are added. It looks like attribute {{runtime-failure-causes-rollback}} does not have the effect in this case. 

This is causing problems when Artemis is configured in colocated HA topology with replicated journal where it takes some time for Artemis to activate but deployment which depends on some connection factories and queues has already tried to deploy. We need deployment to recover from this situation automatically. Restart/Reload will not help in this case as it would end up in the same situation. Only manual redeploy will help which is a workaround.",2017/05/26 2:07 AM
WFCORE-2873,"The definitions of the various global read-xxx handlers all include setRuntimeOnly() which is incorrect as these ops in one way or the other deal with the management model, either by reading the Resource tree or by reading the ManagementResourceRegistration tree.

Having these declare themselves as runtime-only interferes with resolving WFCORE-2858, because the WFCORE-2858 solution is to treat read-only + runtime-only ops targeting profile resources as requiring multiphase rollout across the domain instead of simply reading the DC. Doing a multiphase rollout for these ops is incorrect.",2017/05/24 4:31 PM
WFCORE-2870,"The collection manipulation operations show up in the r-r-d etc output on a domain server but they should not as they are writes that can only be executed via the HC.

This is because their description has the RUNTIME_ONLY flag set.",2017/05/24 12:36 PM
WFCORE-2864,The JMX audit logging is still using the {{javax.security.auth.Subject}} to get the user and remote IP address. This needs to use the {{AccessAuditContext}} for the remote IP and the {{SecurityIdentity}} for the user id.,2017/05/23 11:36 AM
WFCORE-2851,"*Description of problem:*
Cli output of HTTPSConnectionWithCLITestCase in wildfly-core-eap contains only ""-2147483648: "" (instead of correct result)

*How reproducible:*
intermittently: 1%

*Steps to Reproduce:*
# mvn install -Dts.manualmode -fae -Dmaven.test.failure.ignore=true -Dnode0=$MYTESTIP_1 -DfailIfNoTests=false -Dtest=HTTPSConnectionWithCLITestCase

*Actual results:*
* Maven report:
{noformat}
Running org.wildfly.core.test.standalone.mgmt.HTTPSConnectionWithCLITestCase
Tests run: 4, Failures: 1, Errors: 1, Skipped: 0, Time elapsed: 54.576 sec <<< FAILURE! - in org.wildfly.core.test.standalone.mgmt.HTTPSConnectionWithCLITestCase
testTrustedCLICertificate(org.wildfly.core.test.standalone.mgmt.HTTPSConnectionWithCLITestCase)  Time elapsed: 30.066 sec  <<< FAILURE! 
java.lang.AssertionError: Client with valid certificate should be authenticated.
Expected: a string containing ""\""outcome\"" => \""success\"""" 
     but: was ""-2147483648: ""
        at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)
        at org.junit.Assert.assertThat(Assert.java:956)
        at org.wildfly.core.test.standalone.mgmt.HTTPSConnectionWithCLITestCase.testTrustedCLICertificate(HTTPSConnectionWithCLITestCase.java:149)

org.wildfly.core.test.standalone.mgmt.HTTPSConnectionWithCLITestCase  Time elapsed: 16.5 sec  <<< ERROR!
org.jboss.as.cli.CommandLineException: Failed to establish connection in 6063ms
        at org.jboss.as.cli.handlers.ReloadHandler.ensureServerRebootComplete(ReloadHandler.java:235)
        at org.jboss.as.cli.handlers.ReloadHandler.doHandle(ReloadHandler.java:165)
        at org.jboss.as.cli.handlers.CommandHandlerWithHelp.handle(CommandHandlerWithHelp.java:88)
        at org.jboss.as.cli.impl.CommandContextImpl.handle(CommandContextImpl.java:776)
        at org.wildfly.core.test.standalone.mgmt.HTTPSManagementInterfaceTestCase.reloadServer(HTTPSManagementInterfaceTestCase.java:128)
        at org.wildfly.core.test.standalone.mgmt.HTTPSConnectionWithCLITestCase.resetTestConfiguration(HTTPSConnectionWithCLITestCase.java:162)

Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: -1,448,877.175 sec <<< FAILURE! - in org.wildfly.core.test.standalone.mgmt.HTTPSManagementInterfaceTestCase
org.wildfly.core.test.standalone.mgmt.HTTPSManagementInterfaceTestCase  Time elapsed: -1,448,877.178 sec  <<< ERROR!
java.lang.RuntimeException: ""WFLYCTL0212: Duplicate resource [
    (\""socket-binding-group\"" => \""standard-sockets\""),
    (\""socket-binding\"" => \""management-native\"")
]""
        at org.jboss.as.test.integration.security.common.CoreUtils.applyUpdate(CoreUtils.java:185)
        at org.wildfly.core.test.standalone.mgmt.HTTPSManagementInterfaceTestCase.serverSetup(HTTPSManagementInterfaceTestCase.java:269)
        at org.wildfly.core.test.standalone.mgmt.HTTPSManagementInterfaceTestCase.startAndSetupContainer(HTTPSManagementInterfaceTestCase.java:116)
{noformat}
* testcase logs are attached

*Expected results:*
No error",2017/05/22 3:49 AM
WFCORE-2849,"For WFCORE-389 we are considering relaxing our unenforced rule against registering runtime-only operations against domain profile resources. The reason for such registrations would be to allow the DC to roll out the op to all servers that are using the profile, not to introduce some notion of runtime services that back the profile on the DC process itself. To help emphasize this point and to guard against mistakes where subsystems register such op but neglect to code them properly to not execute their runtime work on the DC, this issue proposes that the kernel explicitly reject OSH attempts to add Stage.RUNTIME steps that target /profile=* child resource in the /profile=* tree.

This acts as a primary line of defense, with WFCORE-2815 acting as a secondary line.",2017/05/20 9:06 AM
WFCORE-2828,"Description of problem:
org.wildfly.core.test.standalone.mgmt.events.ProcessStateListenerTestCase from wf-core fails intermittently

How reproducible:
10-20%


StackTrace:

{noformat}
&amp#27;[0m&amp#27;[0m16:04:10,046 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: WildFly Core 3.0.0.Beta21-redhat-1 ""Kenny"" started in 207ms - Started 83 of 87 services (23 services are lazy, passive or on-demand)
&amp#27;[0m&amp#27;[0m16:04:10,079 INFO  [org.jboss.as.protocol] (management I/O-1) WFLYPRT0057:  cancelled task by interrupting thread Thread[management-handler-thread - 2,5,management-handler-thread]
&amp#27;[0m&amp#27;[31m16:04:10,082 ERROR [org.wildfly.extension.core.management] (management-handler-thread - 2) WFLYCM0003: Error invoking the process state listener my-listener: java.lang.InterruptedException
	at java.util.concurrent.FutureTask.awaitDone(FutureTask.java:404)
	at java.util.concurrent.FutureTask.get(FutureTask.java:204)
	at org.wildfly.extension.core.management.ProcessStateListenerService.transition(ProcessStateListenerService.java:146)
	at org.wildfly.extension.core.management.ProcessStateListenerService.lambda$new$0(ProcessStateListenerService.java:99)
	at java.beans.PropertyChangeSupport.fire(PropertyChangeSupport.java:335)
	at java.beans.PropertyChangeSupport.firePropertyChange(PropertyChangeSupport.java:327)
	at java.beans.PropertyChangeSupport.firePropertyChange(PropertyChangeSupport.java:263)
	at org.jboss.as.controller.ControlledProcessStateService.stateChanged(ControlledProcessStateService.java:105)
	at org.jboss.as.controller.ControlledProcessState.setStopping(ControlledProcessState.java:127)
	at org.jboss.as.controller.operations.common.ProcessReloadHandler$1$1$1.listenerAdded(ProcessReloadHandler.java:82)
	at org.jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1537)
	at org.jboss.msc.service.ServiceControllerImpl.addListener(ServiceControllerImpl.java:1254)
	at org.jboss.as.controller.OperationContextImpl$OperationContextServiceController.addListener(OperationContextImpl.java:2367)
	at org.jboss.as.controller.operations.common.ProcessReloadHandler$1$1.handleResult(ProcessReloadHandler.java:79)
	at org.jboss.as.controller.AbstractOperationContext$Step.invokeResultHandler(AbstractOperationContext.java:1484)
	at org.jboss.as.controller.AbstractOperationContext$Step.handleResult(AbstractOperationContext.java:1466)
	at org.jboss.as.controller.AbstractOperationContext$Step.finalizeInternal(AbstractOperationContext.java:1428)
	at org.jboss.as.controller.AbstractOperationContext$Step.finalizeStep(AbstractOperationContext.java:1401)
	at org.jboss.as.controller.AbstractOperationContext$Step.access$400(AbstractOperationContext.java:1275)
	at org.jboss.as.controller.AbstractOperationContext.executeResultHandlerPhase(AbstractOperationContext.java:847)
	at org.jboss.as.controller.AbstractOperationContext.executeDoneStage(AbstractOperationContext.java:833)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:742)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:440)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1390)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:418)
	at org.jboss.as.controller.ModelControllerImpl.lambda$execute$1(ModelControllerImpl.java:243)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:263)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:229)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:243)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:217)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$400(ModelControllerClientOperationHandler.java:137)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:161)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:287)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:244)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:254)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:225)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)

&amp#27;[0m&amp#27;[31m16:04:10,083 ERROR [org.wildfly.extension.core.management] (management-handler-thread - 2) WFLYCM0003: Error invoking the process state listener my-listener: java.lang.InterruptedException
	at java.util.concurrent.FutureTask.awaitDone(FutureTask.java:404)
	at java.util.concurrent.FutureTask.get(FutureTask.java:204)
	at org.wildfly.extension.core.management.ProcessStateListenerService.suspendTransition(ProcessStateListenerService.java:207)
	at org.wildfly.extension.core.management.ProcessStateListenerService.transition(ProcessStateListenerService.java:180)
	at org.wildfly.extension.core.management.ProcessStateListenerService.lambda$new$0(ProcessStateListenerService.java:99)
	at java.beans.PropertyChangeSupport.fire(PropertyChangeSupport.java:335)
	at java.beans.PropertyChangeSupport.firePropertyChange(PropertyChangeSupport.java:327)
	at java.beans.PropertyChangeSupport.firePropertyChange(PropertyChangeSupport.java:263)
	at org.jboss.as.controller.ControlledProcessStateService.stateChanged(ControlledProcessStateService.java:105)
	at org.jboss.as.controller.ControlledProcessState.setStopping(ControlledProcessState.java:127)
	at org.jboss.as.controller.operations.common.ProcessReloadHandler$1$1$1.listenerAdded(ProcessReloadHandler.java:82)
	at org.jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1537)
	at org.jboss.msc.service.ServiceControllerImpl.addListener(ServiceControllerImpl.java:1254)
	at org.jboss.as.controller.OperationContextImpl$OperationContextServiceController.addListener(OperationContextImpl.java:2367)
	at org.jboss.as.controller.operations.common.ProcessReloadHandler$1$1.handleResult(ProcessReloadHandler.java:79)
	at org.jboss.as.controller.AbstractOperationContext$Step.invokeResultHandler(AbstractOperationContext.java:1484)
	at org.jboss.as.controller.AbstractOperationContext$Step.handleResult(AbstractOperationContext.java:1466)
	at org.jboss.as.controller.AbstractOperationContext$Step.finalizeInternal(AbstractOperationContext.java:1428)
	at org.jboss.as.controller.AbstractOperationContext$Step.finalizeStep(AbstractOperationContext.java:1401)
	at org.jboss.as.controller.AbstractOperationContext$Step.access$400(AbstractOperationContext.java:1275)
	at org.jboss.as.controller.AbstractOperationContext.executeResultHandlerPhase(AbstractOperationContext.java:847)
	at org.jboss.as.controller.AbstractOperationContext.executeDoneStage(AbstractOperationContext.java:833)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:742)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:440)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1390)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:418)
	at org.jboss.as.controller.ModelControllerImpl.lambda$execute$1(ModelControllerImpl.java:243)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:263)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:229)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:243)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:217)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$400(ModelControllerClientOperationHandler.java:137)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:161)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:287)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:244)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:254)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:225)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)

&amp#27;[0m&amp#27;[0m16:04:10,114 INFO  [org.jboss.as] (MSC service thread 1-2) WFLYSRV0050: WildFly Core 3.0.0.Beta21-redhat-1 ""Kenny"" stopped in 29ms
&amp#27;[0m&amp#27;[0m16:04:10,115 INFO  [org.jboss.as] (MSC service thread 1-2) WFLYSRV0049: WildFly Core 3.0.0.Beta21-redhat-1 ""Kenny"" starting
{noformat}
",2017/05/18 9:26 AM
WFCORE-2976,"Wildfly Elytron Tool has not a way how to set own security provider with custom credential store implementation when we want to work with credential-store command.
Now you can only set it through java.security settings for JVM but as is mentioned here https://issues.jboss.org/browse/JBEAP-9310?focusedCommentId=13375779&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13375779
it is not supported way.

There must be some other approach how to set it.

",2017/05/18 2:31 AM
WFCORE-2823,"The patching module OSHs do their work in the execute(....) method of the OSH registered with the ManagementResourceRegistration. This runs in Stage.MODEL which means the patching work is in MODEL even though it's not about the configuration model stuff that should be the only concern of Stage.MODEL.

Simple fix is to move the logic to an added Stage.RUNTIME step.

This is no big deal except it prevents the WFCORE-2816 fix that would allow the kernel to guard against improper behavior by subsystems.",2017/05/17 12:08 PM
WFCORE-2820,"Changing attributes {{security-domain}} and {{mechanism-configurations}}  of http-authentication-factory does not apply immediatelly even though header allow-resource-service-restart=true is used

{code}
[standalone@localhost:9990 /] /subsystem=elytron/http-authentication-factory=application-http-authentication:write-attribute(name=security-domain,value=ApplicationDomain){allow-resource-service-restart=true}
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.UnsupportedOperationException"",
    ""rolled-back"" => true
}

[standalone@localhost:9990 /] /subsystem=elytron/http-authentication-factory=application-http-authentication:write-attribute(name=mechanism-configurations[0].host-name,value=localhost){allow-resource-service-restart=true}
{
    ""outcome"" => ""success"",
    ""response-headers"" => {
        ""operation-requires-reload"" => true,
        ""process-state"" => ""reload-required""
    }
}
{code}

Header should work as attributes are declared as {{""restart-required"" => ""resource-services""}}
{code}
""security-domain"" => {
    ""type"" => STRING,
    ""description"" => ""The SecurityDomain to associate with this resource"",
    ""expressions-allowed"" => false,
    ""required"" => true,
    ""nillable"" => false,
    ""capability-reference"" => ""org.wildfly.security.security-domain"",
    ""min-length"" => 1L,
    ""max-length"" => 2147483647L,
    ""access-type"" => ""read-write"",
    ""storage"" => ""configuration"",
    ""restart-required"" => ""resource-services""
}
{code}

And according to documentation [1]:

resource-services  The operation can only immediately update the persistent configuration; applying the operation to the runtime will require a subsequent restart of some services associated with the resource. If the operation includes the request header ""allow-resource-service-restart"" => true, the handler for the operation will go ahead and restart the runtime service. Otherwise executing the operation will put the server into a ""reload-required"" state. (See the discussion of ""all-services"" above for more on the ""reload-required"" state.)

[1] https://docs.jboss.org/author/display/WFLY10/Description+of+the+Management+Model

Make allow-resource-service-restart=true work or if it is not achievable redefine restart-required model metadata appropriately, e.g. ""all-services""",2017/05/17 8:32 AM
WFCORE-2816,"Runtime modifications should not be made in Stage.MODEL.

OperationContextImpl specifically allows this but with a TODO asking why.",2017/05/16 6:40 PM
WFCORE-2812,"When 'ls' operation is performed over 'provider-loader' element, the output is very ugly - I get many empty lines with one very long attribute value and few more attributes with simple values.

Expected: no empty lines between printed attributes so the output does not take like 4 screen size.",2017/05/16 5:42 AM
WFCORE-2807,"Comparing subsystem configuration options of client-ssl-context to wildfly-config.xml I am missing these attributes:

* client-ssl-context
    ** use-cipher-suites-order
    ** maximum-session-cache-size
    ** session-timeout

* key-managers/trust-managers: 
    ** algorithm (is IBM - IBMX509 handled properly? e.g. *ManagerFactory.getDefaultAlgorithm() is called internally)

* trust-manager
    ** certificate-revocation-list

* key-managers
    ** key-password",2017/05/15 11:36 AM
WFCORE-2792,"AttributeDefinition includes a 'parser' field but it isn't consistently used for parsing calls in subclasses. ListAttributeDefinition at least isn't using it; it hard codes splitting on ',' forcing attributes that want other delimiters to roll their own parsing (e.g. https://github.com/wildfly/wildfly-core/pull/2408/commits/a3e97f5ebadce19c768af67d1d4d109f3525179d)",2017/05/10 11:08 AM
WFCORE-2791,"Not every DUP properly removes deployment unit attachments on undeploy.  To ensure that singleton deployments can restart the deployment chain, we should auto-remove any lingering deployment unit attachments when the DUP chain is restarted.",2017/05/10 10:11 AM
WFCORE-2782,"Executing the CLI with file encoding ANSI (Windows-1252) where characters include German umlauts (, , ) fails.
This worked in EAP 7.0.0, but fails in 7.1.0 Alpha.  Also present in DR17",2017/05/09 10:51 AM
WFCORE-2779,"Improve help message in module CLI operation:
{{module --help}}

--resources and --absolute-resources description contains example of path separator, example is java.io.File.pathSeparatorChar. This example could be confusing for EAP administrators without experience with java. It would be better to mention example for Windows and Linux OS:

So I suggest to replace this:
{{separated by a filesystem-specific path separator, i.e. java.io.File.pathSeparatorChar.}}
by something like this:
{{separated by a filesystem-specific path separator, i.e. '/' for Linux and '\' for Windows.}}


This help message is stored in WF-Core in /cli/src/main/resources/help/module.txt",2017/05/09 6:02 AM
WFCORE-2777,"Elytron credential-store resources should offer operations instead of alias resource, as for key-stores, as it can be based on any key-store too.

The reason is more described in WFCORE-2691 or related mailing thread on wildfly-dev.
Setting priority to blocker by WFCORE-2691 and WFCORE-2737.",2017/05/09 3:04 AM
WFCORE-2772,"DomainDefinition.ADD installs a service named for the capability, plus another that has that name with ""initial"" appended. But DomainDefinition.REMOVE only removes the former. The result is if you do a remove of the domain with allow-resource-service-restart=true, it fails because the 'initial' service is left behind with missing dependencies. Rollback also fails because the 'initial' service is already present so can't be restored.",2017/05/07 9:12 PM
WFCORE-2771,"When binding Wildfly Management Console to an ephemeral port (i.e., by specifying port 0), Wildfly states that the management console is not enabled:

{code}
23:15:55,138 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0063: Http management interface is not enabled
23:15:55,138 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0054: Admin console is not enabled
{code}

This isn't right. For example, using {{lsof}} I can see that Wildfly bound to an ephemeral port. After starting Wildfly with {{-Djboss.management.http.port=0}}:

{code}
$ lsof -p `jps | grep jboss-modules.jar | awk '{print $1}'` -P -n | grep TCP
java    59501 jason  379u     IPv4 0xd038b817c1abd6a5       0t0      TCP 127.0.0.1:8080 (LISTEN)
java    59501 jason  387u     IPv4 0xd038b817acfc6a85       0t0      TCP 127.0.0.1:65238 (LISTEN)
java    59501 jason  390u     IPv4 0xd038b817b86956a5       0t0      TCP 127.0.0.1:8443 (LISTEN)
$ curl -v -XGET localhost:65238
Note: Unnecessary use of -X or --request, GET is already inferred.
* Rebuilt URL to: localhost:65238/
*   Trying ::1...
* TCP_NODELAY set
* Connection failed
* connect to ::1 port 65238 failed: Connection refused
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 65238 (#0)
> GET / HTTP/1.1
> Host: localhost:65238
> User-Agent: curl/7.51.0
> Accept: */*
> 
< HTTP/1.1 301 Moved Permanently
< Connection: keep-alive
< Location: http://localhost:65238/console/index.html
< Content-Length: 0
< Date: Sun, 07 May 2017 03:25:04 GMT
< 
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
{code}

showing that Wildfly is indeed listening and giving the usual redirect to the Console index.

Instead, Wildfly should log the ephemeral port that it actually bound to:

{code}
23:27:09,347 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0060: Http management interface listening on http://127.0.0.1:65301/management
23:27:09,347 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0051: Admin console listening on http://127.0.0.1:65301
{code}",2017/05/06 11:27 PM
WFCORE-2761,"Since all other DUPs are contributing to {{org.jboss.as.server.deployment.Attachments#DEPLOYMENT_COMPLETE_SERVICES}} nothing actually clears the list on {{org.jboss.as.server.deployment.DeploymentUnitProcessor#undeploy}} (or cleanup phase).

This seems to be the responsibility of {{org.jboss.as.server.deployment.DeploymentCompleteServiceProcessor}}.",2017/05/03 4:57 PM
WFCORE-2755,"The format of _rotating-file-audit-log's_ timestamp is insufficient. It lacks the information about seconds which might be a problem in an environment with thousands of active users.
Furthermore the format of timestamp is inconsistent with the _file-audit-log_.

_file-audit-log:_
{code}
2017-05-03 13:44:07
{code}
_rotating-file-audit-log:_
{code}
5/3/17 1:44 PM
{code}

Suggestions for improvement:
Use the same format of timestamp in_rotating-file-audit-log_ as is already used in _file-audit-log_.",2017/05/03 8:08 AM
WFCORE-2756,"{{rotating-file-audit}} throws {{IllegalArgumentException}} if user tries to add a new {{rotating-audit-file}} and does not specify {{suffix}} property.

Steps to reproduce: {{/subsystem=elytron/rotating-file-audit-log=rotating-audit:add(path=rotating-audit.log)}}

Following output is given in jboss-cli
{code}
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {""WFLYCTL0080: Failed services"" => {""org.wildfly.security.security-event-listener.rotating-audit"" => ""Failed to start service
    Caused by: java.lang.IllegalArgumentException: Illegal pattern character 'n'""}},
    ""rolled-back"" => true
}
{code}

and following one in server log:
{code}
12:45:41,381 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-2) MSC000001: Failed to start service org.wildfly.security.security-event-listener.rotating-audit: org.jboss.msc.service.StartException in service org.wildfly.security.security-event-listener.rotating-audit: Failed to start service
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1978)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalArgumentException: Illegal pattern character 'n'
	at java.text.SimpleDateFormat.compile(SimpleDateFormat.java:826)
	at java.text.SimpleDateFormat.initialize(SimpleDateFormat.java:634)
	at java.text.SimpleDateFormat.<init>(SimpleDateFormat.java:605)
	at java.text.SimpleDateFormat.<init>(SimpleDateFormat.java:580)
	at org.wildfly.security.audit.RotatingFileAuditEndpoint$Builder.setSuffix(RotatingFileAuditEndpoint.java:289)
	at org.wildfly.extension.elytron.AuditResourceDefinitions$2.lambda$getValueSupplier$2(AuditResourceDefinitions.java:235)
	at org.wildfly.extension.elytron.TrivialService.start(TrivialService.java:53)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
	... 3 more

12:45:41,382 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 5) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""subsystem"" => ""elytron""),
    (""rotating-file-audit-log"" => ""rotating-audit"")
]) - failure description: {""WFLYCTL0080: Failed services"" => {""org.wildfly.security.security-event-listener.rotating-audit"" => ""Failed to start service
    Caused by: java.lang.IllegalArgumentException: Illegal pattern character 'n'""}}
{code}

Note: there is an easy workaround - if user specifies {{suffix}} property then adding a new {{rotating-audit-file}} works fine, e.g. {{/subsystem=elytron/rotating-file-audit-log=rotating-audit:add(path=rotating-audit.log,suffix=y-M-d)}} passes successfully.",2017/05/03 6:54 AM
WFCORE-2754,"sasl-mechanism-selector was introduced to Elytron client configuration to allow whitelisting specific SASL mechanism in the client. See WFCORE-2615 for the discussion.

This element should be also propagated to Elytron subsystem so it's available server side.",2017/05/03 6:34 AM
WFCORE-2750,"Block singleton deployments. Hangs after 

{noformat}23:40:37,420 INFO  [org.wildfly.clustering.server] (DistributedSingletonService - 1) WFLYCLSV0003: node1 elected as the singleton provider of the jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".installer service
23:40:37,424 INFO  [org.wildfly.clustering.server] (DistributedSingletonService - 1) WFLYCLSV0001: This node will now operate as the singleton provider of the jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".installer service
23:40:37,435 INFO  [org.infinispan.remoting.transport.jgroups.JGroupsTransport] (thread-2) ISPN000094: Received new cluster view for channel server: [node1|4] (1) [node1]
23:40:37,436 INFO  [org.infinispan.remoting.transport.jgroups.JGroupsTransport] (thread-2) ISPN000094: Received new cluster view for channel web: [node1|4] (1) [node1]
23:40:37,436 INFO  [org.infinispan.remoting.transport.jgroups.JGroupsTransport] (thread-2) ISPN000094: Received new cluster view for channel ejb: [node1|4] (1) [node1]
23:40:37,437 INFO  [org.infinispan.remoting.transport.jgroups.JGroupsTransport] (thread-2) ISPN000094: Received new cluster view for channel hibernate: [node1|4] (1) [node1]
23:40:37,451 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-8) WFLYSRV0207: Starting subdeployment (runtime-name: ""clusterbench-ee7-web-passivating.war"")
23:40:37,451 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) WFLYSRV0207: Starting subdeployment (runtime-name: ""clusterbench-ee7-web-default.war"")
23:40:37,451 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) WFLYSRV0207: Starting subdeployment (runtime-name: ""clusterbench-ee7-ejb.jar"")
{noformat}

due to unsatisfied dependencies 

{noformat}19:18:40,907 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-ejb.jar"".FIRST_MODULE_USE"" (class org.jboss.as.server.deployment.DeploymentUnitPhaseService) mode ACTIVE state DOWN (PROBLEM) (parent: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-ejb.jar"".CONFIGURE_MODULE) (dependencies: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-ejb.jar"".CONFIGURE_MODULE, jboss.module.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main, jboss.deployment.chains, jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".FIRST_MODULE_USE) (has unavailable dependency)
19:18:40,908 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-default.war"".FIRST_MODULE_USE"" (class org.jboss.as.server.deployment.DeploymentUnitPhaseService) mode ACTIVE state DOWN (PROBLEM) (parent: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-default.war"".CONFIGURE_MODULE) (dependencies: jboss.module.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-default.war"".main, jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-default.war"".CONFIGURE_MODULE, jboss.deployment.chains, jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".FIRST_MODULE_USE) (has unavailable dependency)
19:18:40,908 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-passivating.war"".FIRST_MODULE_USE"" (class org.jboss.as.server.deployment.DeploymentUnitPhaseService) mode ACTIVE state DOWN (PROBLEM) (parent: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-passivating.war"".CONFIGURE_MODULE) (dependencies: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-passivating.war"".CONFIGURE_MODULE, jboss.module.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-passivating.war"".main, jboss.deployment.chains, jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".FIRST_MODULE_USE) (has unavailable dependency)
19:18:40,908 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".POST_MODULE"" (class org.jboss.as.server.deployment.DeploymentUnitPhaseService) mode ACTIVE state DOWN (PROBLEM) (parent: jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".FIRST_MODULE_USE) (dependencies: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-ejb.jar"".FIRST_MODULE_USE, jboss.deployment.chains, jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-default.war"".FIRST_MODULE_USE, jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-passivating.war"".FIRST_MODULE_USE, jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".FIRST_MODULE_USE) (has unavailable dependency)
19:18:40,925 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.module.resolve.phase.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main.1"" (class org.jboss.as.server.moduleservice.ModuleResolvePhaseService) mode ACTIVE state DOWN (PROBLEM) (parent: jboss.module.resolve.phase.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main.0) (dependencies: jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear"".main) (has unavailable dependency)
19:18:40,925 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.module.resolve.phase.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-default.war"".main.1"" (class org.jboss.as.server.moduleservice.ModuleResolvePhaseService) mode ACTIVE state DOWN (PROBLEM) (parent: jboss.module.resolve.phase.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-default.war"".main.0) (dependencies: jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear"".main, jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main) (has unavailable dependency)
19:18:40,925 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.module.resolve.phase.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-passivating.war"".main.1"" (class org.jboss.as.server.moduleservice.ModuleResolvePhaseService) mode ACTIVE state DOWN (PROBLEM) (parent: jboss.module.resolve.phase.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-passivating.war"".main.0) (dependencies: jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear"".main, jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main) (has unavailable dependency)
19:18:40,925 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.module.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main"" (class org.jboss.as.server.moduleservice.ModuleLoadService) mode ON_DEMAND state DOWN (PROBLEM) (parent: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-ejb.jar"".CONFIGURE_MODULE) (dependencies: jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear"".main, module.resolved.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main, jboss.as.service-module-loader, jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main) (has unavailable dependency)
19:18:40,925 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.module.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-default.war"".main"" (class org.jboss.as.server.moduleservice.ModuleLoadService) mode ON_DEMAND state DOWN (PROBLEM) (parent: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-default.war"".CONFIGURE_MODULE) (dependencies: jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear"".main, module.resolved.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-default.war"".main, jboss.as.service-module-loader, jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-default.war"".main, jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main) (has unavailable dependency)
19:18:40,925 INFO  [stdout] (MSC service thread 1-1) Service ""jboss.module.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-passivating.war"".main"" (class org.jboss.as.server.moduleservice.ModuleLoadService) mode ON_DEMAND state DOWN (PROBLEM) (parent: jboss.deployment.subunit.""clusterbench-ee7-singleton-jbossall.ear"".""clusterbench-ee7-web-passivating.war"".CONFIGURE_MODULE) (dependencies: jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-passivating.war"".main, jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear"".main, jboss.as.service-module-loader, jboss.module.spec.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-ejb.jar"".main, module.resolved.service.""deployment.clusterbench-ee7-singleton-jbossall.ear.clusterbench-ee7-web-passivating.war"".main) (has unavailable dependency)
{noformat}",2017/05/02 5:48 PM
WFCORE-2867,"Credential store reload operation doesn't have effect in dependent resources.
When we have keystore which obtains password from credential store, we change on file system backed storage file which contains wrong password to keystore and reload it. Credential store is right state, but keystore still works.

There is expected fail.

*How to reproduce*
For simplifying we only update value in credential store and reload it (it should work too JBEAP-6614).
In my opinion is there same problem and solving one will solve both problems.

{code}
/subsystem=elytron/credential-store=cs001:add(uri=""cr-store://cs001.jceks?create=true"", relative-to=""jboss.server.data.dir"", credential-reference={clear-text=pass123})
/subsystem=elytron/credential-store=cs001/alias=ff:add(secret-value=Elytron)
/subsystem=elytron/key-store=firefly:add(path=firefly.keystore,relative-to=jboss.server.data.dir,type=JKS,credential-reference= {store=cs001,alias=ff}
this command show all aliases
/subsystem=elytron/key-store=firefly:read-children-names(child-type=alias)
{code}

*Now we change keystore password to wrong and reload credential store*
OR
*You can replace storage file which contains wrong password to keystore and call RELOAD command only*
{code}
/subsystem=elytron/credential-store=cs001/alias=ff:remove
/subsystem=elytron/credential-store=cs001/alias=ff:add(secret-value=ElytronWrong)
/subsystem=elytron/credential-store=cs001:reload
{code}

*This command wrongly prints all aliases*
{code}
/subsystem=elytron/key-store=firefly:read-children-names(child-type=alias)
{code}
*We expect error message about wrong password to access to keystore*",2017/05/02 3:36 AM
WFCORE-2739,"org.wildfly.managment.notification-handler-registry
org.wildfly.managment.model-controller-client-factory",2017/04/28 5:40 PM
WFCORE-2738,"{noformat}
19:33:36,944 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC000001: Failed to start service jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".DEPENDENCIES: org.jboss.msc.service.StartException in service jboss.deployment.unit.""clusterbench-ee7-singleton-jbossall.ear"".DEPENDENCIES: WFLYSRV0153: Failed to process phase DEPENDENCIES of deployment ""clusterbench-ee7-singleton-jbossall.ear""
	at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:172)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException
	at org.jboss.as.server.deployment.module.SubDeploymentDependencyProcessor.deploy(SubDeploymentDependencyProcessor.java:74)
	at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:165)
	... 5 more
{noformat}",2017/04/28 1:37 PM
WFCORE-2737,"Elytron {{*-key-store}} resources should offer operations instead of {{alias}} resource, at least {{ldap-key-store}} should. The reason is the same like for {{identity}} resource of Elytron modifiable realms, see [WFCORE-2691|https://issues.jboss.org/browse/WFCORE-2691?focusedCommentId=13398683&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13398683] or related mailing thread on [wildfly-dev|http://lists.jboss.org/pipermail/wildfly-dev/2017-April/005899.html].

Setting priority to blocker, like for WFCORE-2691.",2017/04/28 8:31 AM
WFCORE-2814,"There is description of ""case-sensitive"" attribute inconsistency between model and XSD.

In XSD is missing default value.

Please add to XSD default value and unify description.
I suggest use description from model as right one:  ""Case sensitivity of the credential store. If case insensitive only lower case names are allowed for aliases."".

*MODEL*
{code}
""case-sensitive"" => {
                            ""type"" => BOOLEAN,
                            ""description"" => ""Case sensitivity of the credential store. If case insensitive only lower case names are allowed for aliases."",
                            ""attribute-group"" => ""implementation"",
                            ""expressions-allowed"" => false,
                            ""required"" => false,
                            ""nillable"" => true,
                            ""default"" => false,
                            ""access-type"" => ""read-write"",
                            ""storage"" => ""configuration"",
                            ""restart-required"" => ""resource-services""
                        },
{code}

*DMR*
{code}
<xs:attribute name=""case-sensitive"" type=""xs:boolean"" use=""optional"">
            <xs:annotation>
                <xs:documentation>
                    Indicates that the credential store is case sensitive and should then allow for upper case in alias.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
{code}
",2017/04/28 7:11 AM
WFCORE-2735,"There is no description at server attributes:
{code}
[standalone@localhost:9990 /] /subsystem=io/worker=default/server=*:read-resource-description
{       
    ""outcome"" => ""success"",
    ""result"" => [{
        ""address"" => [
            (""subsystem"" => ""io""),
            (""worker"" => ""default""),
            (""server"" => ""*"")
        ],
        ""outcome"" => ""success"",
        ""result"" => {
            ""description"" => ""description"",
            ""storage"" => ""runtime-only"",
            ""attributes"" => {
                ""connection-count"" => {
                    ""type"" => INT,
                    ""description"" => ""connection-count"",
                    ""expressions-allowed"" => false,
                    ""required"" => true,
                    ""nillable"" => false,
                    ""access-type"" => ""metric"",
                    ""storage"" => ""runtime""
                },
                ""connection-limit-high-water-mark"" => {
                    ""type"" => INT,
                    ""description"" => ""connection-limit-high-water-mark"",
                    ""expressions-allowed"" => false,
                    ""required"" => true,
                    ""nillable"" => false,
                    ""access-type"" => ""read-only"",
                    ""storage"" => ""runtime""
                },
                ""connection-limit-low-water-mark"" => {
                    ""type"" => INT,
                    ""description"" => ""connection-limit-low-water-mark"",
                    ""expressions-allowed"" => false,
                    ""required"" => true,
                    ""nillable"" => false,
                    ""access-type"" => ""read-only"",
                    ""storage"" => ""runtime""
                }
            },
            ""operations"" => undefined,
            ""notifications"" => undefined,
            ""children"" => {}
        }
    }]
}
{code}",2017/04/28 5:53 AM
WFCORE-2722,"The set-password operation on identities in filesystem-realm doesn't support OTP credentials.  So identity with OneTimePassword can't be created in the filesystem-realm (Elytron subsystem).

",2017/04/25 2:01 PM
WFCORE-2718,"Having defined CLIENT_CERT auth on HTTP management API with legacy security-realm causes that after requesting client cert, there is also required password.

This is regression in comparison to EAP 7.0 and EAP 7.1.0.DR7, as such marking as blocker.

For details how to reproduce see steps to reproduce",2017/04/24 12:52 PM
WFCORE-2717,"Try-catch block doesn't work if catch block doesn't contains anything

*Steps to reproduce:*
{noformat}
rm -f a.cli
cat << EOF > a.cli
try
  echo try-block
  /system-property=nonsence:read-resource()
catch
  # echo catch-block
end-try
echo after-block
EOF
./jboss-cli.sh  -c --file=a.cli
{noformat}



*Actual results:*
{noformat}
[mkopecky@dhcp-10-40-4-227 bin]$ ./jboss-cli.sh  -c --file=a.cli
try-block
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0216: Management resource '[(\""system-property\"" => \""nonsence\"")]' not found"",
    ""rolled-back"" => true
}
[mkopecky@dhcp-10-40-4-227 bin]$ 
{noformat}

*Expected results:*
{noformat}
[mkopecky@dhcp-10-40-4-227 bin]$ ./jboss-cli.sh  -c --file=a.cli
try-block
after-block
[mkopecky@dhcp-10-40-4-227 bin]$ 
{noformat}

*Additional info:*
This issue is not regression",2017/04/24 11:40 AM
WFCORE-2716,"To avoid possibility when two different ssl-contexts are configured in Elytron dir-context, its attributes {{ssl-context}} and {{authentication-context}} should be mutually exclusive.

It is similar issue as WFCORE-2396.",2017/04/24 3:04 AM
WFCORE-2705,"The {{RemotingModelControllerClient}} closes some of it's resources asynchronously. This could cause issues consumers of the client that may attempt to change class loaders after the client is closed. The {{ModelControllerClient.close()}} should block until resources are closed. 

Example stack trace from the wildfly-maven-plugin:
{code}
Exception in thread ""Remoting ""management-client"" task-8"" java.lang.NoClassDefFoundError: org/xnio/XnioWorker$2
	at org.xnio.XnioWorker.shutDownTaskPool(XnioWorker.java:770)
	at org.xnio.nio.NioXnioWorker.shutdown(NioXnioWorker.java:285)
	at org.jboss.remoting3.EndpointImpl.finishPhase1(EndpointImpl.java:255)
	at org.jboss.remoting3.EndpointImpl.closeTick1(EndpointImpl.java:238)
	at org.jboss.remoting3.EndpointImpl.access$200(EndpointImpl.java:93)
	at org.jboss.remoting3.EndpointImpl$TrackingExecutor.finishWork(EndpointImpl.java:835)
	at org.jboss.remoting3.EndpointImpl$TrackingExecutor.lambda$execute$0(EndpointImpl.java:822)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.ClassNotFoundException: org.xnio.XnioWorker$2
	at org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy.loadClass(SelfFirstStrategy.java:50)
	at org.codehaus.plexus.classworlds.realm.ClassRealm.unsynchronizedLoadClass(ClassRealm.java:271)
	at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:247)
	at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:239)
	... 10 more
{code}

See WFMP-77 for more details on one place this error seemed intermittent.",2017/04/20 4:27 PM
WFCORE-2691,"Elytron {{filesystem-realm}} should load existing identities from file system. The steps to reproduce results in:

{noformat}
[standalone@localhost:9990 /] /subsystem=elytron/filesystem-realm=realm/identity=user:read-identity
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0216: Management resource '[
    (\""subsystem\"" => \""elytron\""),
    (\""filesystem-realm\"" => \""realm\""),
    (\""identity\"" => \""user\"")
]' not found"",
    ""rolled-back"" => true
}
[standalone@localhost:9990 /] /subsystem=elytron/filesystem-realm=realm/identity=user:add
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYELY01000: Identity with name [user] already exists."",
    ""rolled-back"" => true
}
{noformat}",2017/04/19 3:43 PM
WFCORE-2678,"When an error occurs at startup, LDAP credential is shown in the log file. It should not appear.",2017/04/17 8:38 PM
WFCORE-2676,"The AttributeDefinition for the 'content' attribute is sharing ADs for its fields with those created for the 'content' param to various deployment ops. This resulted in incorrect metadata as those fields have different ""require"" and ""alternatives"" settings in the two different use cases.

Besides being wrong data in the read-resoure-description this blocks WFCORE-2317 and WFCORE-2674 by introducing incorrect data that results in spurious validation that can't succeed.",2017/04/15 11:59 AM
WFCORE-2674,"Right now ValidateModelStepHandler checks whether all attributes a defined attribute lists in 'requires' are themselves defined. It ignore the presence of alternatives settings. However in discussion with [~jfdenise_jira] we've concluded that allowing undefined do to any 'alternatives' isn't right either. Rather, for a 'requires' to be superceded by an 'alternatives', only alternatives that are themselves part of the same set of 'requires' are relevant.

Imagine three scenarios:

I.
1) A requires B, C 
2) B and C are alternatives to each other 

User configures A and B is ok. Or, user configures A and C is ok. Configuring A, B, C is not ok. 

II.
1) A requires B, C 
2) B and C are alternatives to each other 
3) B and D are also alternatives

User configures A and D and therefore must configure C, but not B. Configuring C satisfies the ""requires"" B.

III.
1) A requires B, C 
2) B and C are NOT alternatives to each other 
3) B and D are alternatives

User configures A therefore cannot configure D, must configure B and C. Configuring D does not satisfy the ""requires"" B.
",2017/04/13 5:37 PM
WFCORE-2672,"Previously it was possible to use the list-add, list-remove operations to add and remove items from a principal-query (type LIST), but doesn't work at the recent version:

The list operation is important for web console, as it should manipulate the list items individually, instead to use write-attribute as this is going to handle all items in the list.

Add a jdbc-realm
{code}
/profile=full/subsystem=elytron/jdbc-realm=jdbc3:add(principal-query=[{data-source=ExampleDS,sql=""select test from table""}])
{code}

Display its content
{code}
/profile=full/subsystem=elytron/jdbc-realm=jdbc3:list-get(name=principal-query,index=0)
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""data-source"" => ""ExampleDS"",
        ""sql"" => ""select test from table""
    }
}
{code}

However to add more principal-query items doesn't work
{code}
/profile=full/subsystem=elytron/jdbc-realm=jdbc3:list-add(name=principal-query,value={sql=""select other from table2"",data-source=""ExampleDS""})
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {""domain-failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.IllegalArgumentException""},
    ""rolled-back"" => true
}
{code}",2017/04/13 7:40 AM
WFCORE-2671,"When keystore (or cerficate in keystore) is changed during server runtime then CLI opertation {{load}} can be used for {{/subsystem=elytron/key-store=...}} to re-reading this keystore in server. However after calling this operation server still works with original keystore/certificate. Then CLI reads current keystore correctly, but in case when ssl-context which uses that key-store is used then original keystore is still used by server. Reload of server is required to correctly re-read the new keystore. See Steps to Reproduce for more details.",2017/04/13 1:42 AM
WFCORE-2670,"The list-add doesn't work for a child of an attribute as in the example below

Add a dir-context first
{code}
/profile=full/subsystem=elytron/dir-context=dir2:add(url=""ldap://test"")
{code}

Add a ldap-realm
{code}
/profile=full/subsystem=elytron/ldap-realm=foobar2:add(dir-context=dir2,identity-mapping={rdn-identifier=test})
{
    ""outcome"" => ""success"",
    ""result"" => undefined,
    ""server-groups"" => {""main-server-group"" => {""host"" => {""master"" => {""server-one"" => {""response"" => {
        ""outcome"" => ""success"",
        ""response-headers"" => {""process-state"" => ""reload-required""}
    }}}}}}
}
{code}

This is the command to add the item to the list
{code}
/profile=full/subsystem=elytron/ldap-realm=foobar2:list-add(name=identity-mapping.new-identity-attributes,value={name=key2,value=[""val1"",""val2""]})
{
    ""outcome"" => ""failed"",
    ""result"" => undefined,
    ""server-groups"" => undefined,
    ""rolled-back"" => true
}
{code}",2017/04/12 2:44 PM
WFCORE-2668,The explode content of deployment plan doesn't work,2017/04/12 9:29 AM
WFCORE-2667,"*Description of problem:*
CLI returns always ""0"" if CLI is started with ""cmd /c "" on Windows

This issue is regression against EAP 7.0.0, but priority of this jira is not blocker, because this issue is corner case.

*Steps to Reproduce:*
# jboss-cli.bat --command=version_error
# echo Exit Code is %errorlevel%
# REM verify correct return value: 1
# cmd /c jboss-cli.bat --command=version_error
# echo Exit Code is %errorlevel%
# REM return value is 0 in EAP 7.1.0.DR16. Correct return value should be 1

*Actual results:*
{noformat}
C:\Users\Administrator\playground\7.1.0.DR16\jboss-eap-7.1\bin>jboss-cli.bat --command=version_error
Unexpected command 'version_error'. Type 'help --commands' for the list of supported commands.

C:\Users\Administrator\playground\7.1.0.DR16\jboss-eap-7.1\bin>echo Exit Code is %errorlevel%
Exit Code is 1

C:\Users\Administrator\playground\7.1.0.DR16\jboss-eap-7.1\bin>


C:\Users\Administrator\playground\7.1.0.DR16\jboss-eap-7.1\bin>cmd /c jboss-cli.bat --command=version_error
Unexpected command 'version_error'. Type 'help --commands' for the list of supported commands.

C:\Users\Administrator\playground\7.1.0.DR16\jboss-eap-7.1\bin>echo Exit Code is %errorlevel%
Exit Code is 0

C:\Users\Administrator\playground\7.1.0.DR16\jboss-eap-7.1\bin>
{noformat}

*Expected results:*
{noformat}
C:\Users\Administrator\playground\7.0.0\jboss-eap-7.0\bin>jboss-cli.bat --command=version_error
Unexpected command 'version_error'. Type 'help --commands' for the list of supported commands.

C:\Users\Administrator\playground\7.0.0\jboss-eap-7.0\bin>echo Exit Code is %errorlevel%
Exit Code is 1

C:\Users\Administrator\playground\7.0.0\jboss-eap-7.0\bin>


C:\Users\Administrator\playground\7.0.0\jboss-eap-7.0\bin>cmd /c jboss-cli.bat --command=version_error
Unexpected command 'version_error'. Type 'help --commands' for the list of supported commands.

C:\Users\Administrator\playground\7.0.0\jboss-eap-7.0\bin>echo Exit Code is %errorlevel%
Exit Code is 1

C:\Users\Administrator\playground\7.0.0\jboss-eap-7.0\bin>
{noformat}

*Additional info:*
We see this issue also if jboss-cli.bat script is called from groovy or java
",2017/04/12 8:33 AM
WFCORE-2658,"Trying to create kerberos-security-factory specifying KRB5 (1.2.840.113554.1.2.2) mechanism in both mechanism-names and mechanism-oids is succesfull
{code}
[standalone@localhost:9990 /] /subsystem=elytron/kerberos-security-factory=c:add(principal=""HTTP/localhost@JBOSS.ORG"", path=""/path/to/keytab"", mechanism-names=[KRB5,SPNEGO], mechanism-oids=[""1.2.840.113554.1.2.2""])
{""outcome"" => ""success""}
{code}

However, later that leads to error {{GSSException: Duplicate element found: 1.2.840.113554.1.2.2 usage: Accept}}
{code:title=server.log}
07:32:19,873 TRACE [org.wildfly.security] (default task-1) SPNEGO: org.wildfly.security.http.HttpAuthenticationException: ELY05053: [SPNEGO] Callback handler failed for unknown reason
	at org.wildfly.security.http.impl.SpnegoAuthenticationMechanism.evaluateRequest(SpnegoAuthenticationMechanism.java:118)
	at org.wildfly.security.http.util.SetMechanismInformationMechanismFactory$1.evaluateRequest(SetMechanismInformationMechanismFactory.java:115)
	at org.wildfly.security.http.util.SecurityIdentityServerMechanismFactory$1.evaluateRequest(SecurityIdentityServerMechanismFactory.java:77)
	at org.wildfly.security.http.HttpAuthenticator$AuthenticationExchange.authenticate(HttpAuthenticator.java:115)
	at org.wildfly.security.http.HttpAuthenticator$AuthenticationExchange.access$100(HttpAuthenticator.java:94)
	at org.wildfly.security.http.HttpAuthenticator.authenticate(HttpAuthenticator.java:78)
	at org.wildfly.elytron.web.undertow.server.SecurityContextImpl.authenticate(SecurityContextImpl.java:97)
	at io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:55)
	at io.undertow.server.handlers.DisableCacheHandler.handleRequest(DisableCacheHandler.java:33)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at io.undertow.security.handlers.AuthenticationConstraintHandler.handleRequest(AuthenticationConstraintHandler.java:53)
	at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:46)
	at io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:64)
	at io.undertow.servlet.handlers.security.ServletSecurityConstraintHandler.handleRequest(ServletSecurityConstraintHandler.java:59)
	at io.undertow.security.handlers.AbstractSecurityContextAssociationHandler.handleRequest(AbstractSecurityContextAssociationHandler.java:43)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at org.wildfly.extension.undertow.security.jacc.JACCContextIdHandler.handleRequest(JACCContextIdHandler.java:61)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at org.wildfly.extension.undertow.deployment.GlobalRequestControllerHandler.handleRequest(GlobalRequestControllerHandler.java:68)
	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:43)
	at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:292)
	at io.undertow.servlet.handlers.ServletInitialHandler.access$100(ServletInitialHandler.java:81)
	at io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:138)
	at io.undertow.servlet.handlers.ServletInitialHandler$2.call(ServletInitialHandler.java:135)
	at io.undertow.servlet.core.ServletRequestContextThreadSetupAction$1.call(ServletRequestContextThreadSetupAction.java:48)
	at io.undertow.servlet.core.ContextClassLoaderSetupAction$1.call(ContextClassLoaderSetupAction.java:43)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService$UndertowThreadSetupAction.lambda$create$0(UndertowDeploymentInfoService.java:1704)
	at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:272)
	at io.undertow.servlet.handlers.ServletInitialHandler.access$000(ServletInitialHandler.java:81)
	at io.undertow.servlet.handlers.ServletInitialHandler$1.handleRequest(ServletInitialHandler.java:104)
	at io.undertow.server.Connectors.executeRootHandler(Connectors.java:211)
	at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:809)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: ELY01156: Cannot obtain a credential from a security factory
	at org.wildfly.security.credential.source.CredentialSource$4.getCredential(CredentialSource.java:327)
	at org.wildfly.security.auth.server.ServerAuthenticationContext$1.handleOne(ServerAuthenticationContext.java:858)
	at org.wildfly.security.auth.server.ServerAuthenticationContext$1.handle(ServerAuthenticationContext.java:730)
	at org.wildfly.security.http.util.SecurityIdentityServerMechanismFactory$SecurityIdentityCallbackHandler.handle(SecurityIdentityServerMechanismFactory.java:113)
	at org.wildfly.security.http.impl.SpnegoAuthenticationMechanism.evaluateRequest(SpnegoAuthenticationMechanism.java:114)
	... 37 more
Caused by: java.security.GeneralSecurityException: GSSException: Duplicate element found: 1.2.840.113554.1.2.2 usage: Accept
	at org.wildfly.security.auth.util.GSSCredentialSecurityFactory$Builder.createGSSCredential(GSSCredentialSecurityFactory.java:302)
	at org.wildfly.security.auth.util.GSSCredentialSecurityFactory$Builder.lambda$build$0(GSSCredentialSecurityFactory.java:251)
	at org.wildfly.security.auth.util.GSSCredentialSecurityFactory.create(GSSCredentialSecurityFactory.java:98)
	at org.wildfly.security.auth.util.GSSCredentialSecurityFactory.create(GSSCredentialSecurityFactory.java:60)
	at org.wildfly.security.credential.source.CredentialSource$4.getCredential(CredentialSource.java:325)
	... 41 more
Caused by: GSSException: Duplicate element found: 1.2.840.113554.1.2.2 usage: Accept
	at sun.security.jgss.GSSCredentialImpl.add(GSSCredentialImpl.java:419)
	at sun.security.jgss.GSSCredentialImpl.<init>(GSSCredentialImpl.java:77)
	at sun.security.jgss.GSSManagerImpl.createCredential(GSSManagerImpl.java:160)
	at org.wildfly.security.auth.util.GSSCredentialSecurityFactory$Builder$1.run(GSSCredentialSecurityFactory.java:291)
	at org.wildfly.security.auth.util.GSSCredentialSecurityFactory$Builder$1.run(GSSCredentialSecurityFactory.java:277)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.wildfly.security.auth.util.GSSCredentialSecurityFactory$Builder.createGSSCredential(GSSCredentialSecurityFactory.java:277)
	... 45 more
{code}

mechanism-names and mechanism-oids attributes should be
* either ""deduplicated"" - that in result each OID mechanism occures at most once
* or validated - that duplicate values are not configured",2017/04/11 1:47 AM
WFCORE-2656,"https://ci.wildfly.org/project.html?projectId=WildFlyCore_PullRequest&testNameId=5510538220891037036&tab=testDetails

I fear this has something to do with the capability registry and nothing to do with the scanner itself. It started happening when I added a capability to the scanner so it could consume a capability for the path it references.

The test does a quick add/remove/add of a scanner resource and it's the 2nd add that fails with a dupicate capability error. But the remove mean the dup is gone. It's intermittent so I fear some race, but there's nothing obvious.",2017/04/10 6:25 PM
WFCORE-2650,"Currently, Elytron Audit Logging supports only UDP and TCP transport protocols for sending messages to Syslog server. There should be a possibility to send messages over TLS as well.",2017/04/10 9:47 AM
WFCORE-2659,"User isn't able to use masked password from Wildfly-elytron-tool.
When I generate masked password through tool from EAP7.1.0.DR15 it's worked!

I expect that I will be able to use masked string from actual version of wildfly-elytron-tool.

*How to reproduce*
{code}
java -jar wildfly-elytron-tool.jar mask -x secret_password -s 12345678 -i 230 
MASK-1GhfMaq4jSY0.kFFU3QG4T;12345678;230
{code}
{code}
[standalone@localhost:9990 /] /subsystem=elytron/credential-store=csmasked002:add(uri=""cr-store://csmasked002.jceks?create=true"", credential-reference={clear-text=""MASK-1GhfMaq4jSY0.kFFU3QG4T;12345678;230""})
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {""WFLYCTL0080: Failed services"" => {""org.wildfly.security.credential-store.csmasked002"" => ""WFLYELY00004: Unable to start the service.
    Caused by: java.io.IOException: javax.crypto.BadPaddingException: Given final block not properly padded
    Caused by: javax.crypto.BadPaddingException: Given final block not properly padded""}},
    ""rolled-back"" => true
}
{code}


*NOTE:*
When I use in DR16 masked string from DR15 then it's working. And password in plain text is original one -> ""secret_password"".",2017/04/10 8:44 AM
WFCORE-2646,"Regression against DR15.
Authentication by legacy security realm is taken in account even if just Elytron authentication should be used. I don't say legacy authentication is used in priority before Elytron (that works as expected). Just that legacy authentication is somehow ""initialized"". In this case check ""There are no user in mngmt-user.properties file"" is performed

Reproducer:
* Configure Elytron authentication for management interface
{code}
/subsystem=elytron/filesystem-realm=exampleFsRealm:add(path=fs-realm-users,relative-to=jboss.server.config.dir)
/subsystem=elytron/filesystem-realm=exampleFsRealm/identity=user1:add()
/subsystem=elytron/filesystem-realm=exampleFsRealm/identity=user1:set-password( clear={password=""password123""})
/subsystem=elytron/simple-role-decoder=from-roles-attribute:add(attribute=Roles)
/subsystem=elytron/security-domain=exampleFsSD:add(realms=[{realm=exampleFsRealm,role-decoder=from-roles-attribute}],default-realm=exampleFsRealm,permission-mapper=default-permission-mapper)
/subsystem=elytron/http-authentication-factory=example-fs-http-auth:add(http-server-mechanism-factory=global,security-domain=exampleFsSD,mechanism-configurations=[{mechanism-name=BASIC,mechanism-realm-configurations=[{realm-name=exampleApplicationDomain}]}])
/core-service=management/management-interface=http-interface:write-attribute(name=http-authentication-factory, value=example-fs-http-auth)
{code}
* impossible to acces management interface
{code}
curl --user user1:password123 http://localhost.localdomain:9990/management?operation=attribute\&name=server-state
{
    ""outcome"" : ""failed"",
    ""failure-description"" : ""WFLYDMHTTP0006: The security realm is not ready to process requests, see http://localhost.localdomain:9990/error"",
    ""rolled-back"" : ""true""
}
{code}

Access is granted once 
* security realm is undefined from management interface
{code}
/core-service=management/management-interface=http-interface:undefine-attribute(name=security-realm)
{code}

* Or user is added into ManagementRealm
{code}
./add-user.sh -u admin -p admin -r ManagementRealm
{code}

{code}
curl --user user1:password123 http://localhost.localdomain:9990/management?operation=attribute\&name=server-state
""running""
{code}",2017/04/10 2:43 AM
WFCORE-2642,"completion and history are enabled when prompting user for certificate acceptance.
That is not the case for userName/password. Code refactoring is required to share the same logic for all these users interaction.
",2017/04/07 10:54 AM
WFCORE-2631,"In case when resource in Elytron subsystem includes {{attributes}} which have set {{""restart-required"" => ""resource-services""}} and includes also some {{""value-type""}} for inner attributes, then flag {{allow-resource-service-restart=true}} cannot be used correctly for those inner attributes.

See example:
{code}
/subsystem=elytron/properties-realm=ManagementRealm:write-attribute(name=users-properties.plain-text,value=true)
{
    ""outcome"" => ""success"",
    ""response-headers"" => {
        ""operation-requires-reload"" => true,
        ""process-state"" => ""reload-required""
    }
}
{code}
This command set server to {{""reload-required""}} state. However In case, when flag {{allow-resource-service-restart=true}} is set, then UnsupportedOperationException is returned for the same command. 
{code}
/subsystem=elytron/properties-realm=ManagementRealm:write-attribute(name=users-properties.plain-text,value=true){allow-resource-service-restart=true}
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.UnsupportedOperationException"",
    ""rolled-back"" => true
}
{code}

In case when operation set server to {{""process-state"" => ""reload-required""}} then flag {{allow-resource-service-restart=true}} should be supported. Otherwise whole server needs to be reloaded.

Exception thrown to server log for mentioned above CLI command:
{code}
ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 1) WFLYCTL0013: Operation (""write-attribute"") failed - address: ([
    (""subsystem"" => ""elytron""),
    (""properties-realm"" => ""ManagementRealm"")
]): java.lang.UnsupportedOperationException
	at org.jboss.as.controller.RestartParentWriteAttributeHandler.recreateParentService(RestartParentWriteAttributeHandler.java:145)
	at org.jboss.as.controller.RestartParentWriteAttributeHandler.recreateParentService(RestartParentWriteAttributeHandler.java:126)
	at org.jboss.as.controller.RestartParentWriteAttributeHandler.applyUpdateToRuntime(RestartParentWriteAttributeHandler.java:72)
	at org.jboss.as.controller.AbstractWriteAttributeHandler$1.execute(AbstractWriteAttributeHandler.java:104)
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:979)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:722)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:441)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1397)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:421)
	at org.jboss.as.controller.ModelControllerImpl.lambda$execute$1(ModelControllerImpl.java:243)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:263)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:229)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:243)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:217)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$400(ModelControllerClientOperationHandler.java:137)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:161)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:287)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:244)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:254)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:225)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}",2017/04/06 2:38 AM
WFCORE-2630,"*Description of problem:*
InterfaceManagementUnitTestCase from wf-core fail intermittently. This test is unit test from server module.

*How reproducible:*
5%

*Actual results:*
StackTrace:
{noformat}
java.lang.AssertionError: {""outcome"" => ""success""}
	at org.junit.Assert.fail(Assert.java:88)
	at org.junit.Assert.assertTrue(Assert.java:41)
	at org.jboss.as.server.test.InterfaceManagementUnitTestCase.executeForServiceFailure(InterfaceManagementUnitTestCase.java:447)
	at org.jboss.as.server.test.InterfaceManagementUnitTestCase.testInterfacesAlternatives(InterfaceManagementUnitTestCase.java:175)
{noformat}
 Standard Output 
{noformat}
Failure for {
    ""operation"" => ""add"",
    ""address"" => [(""interface"" => ""test"")],
    ""any-address"" => true,
    ""inet-address"" => ""127.0.0.1"",
    ""link-local-address"" => true,
    ""loopback"" => true,
    ""loopback-address"" => ""127.0.0.1"",
    ""multicast"" => true,
    ""nic"" => ""lo"",
    ""nic-match"" => ""lo"",
    ""point-to-point"" => true,
    ""public-address"" => true,
    ""site-local-address"" => true,
    ""subnet-match"" => ""127.0.0.0/24"",
    ""up"" => true,
    ""virtual"" => true
}
 is:
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0099: any-address is invalid"",
    ""rolled-back"" => true
}
Failure for {
    ""operation"" => ""add"",
    ""address"" => [(""interface"" => ""test"")],
    ""inet-address"" => ""127.0.0.1"",
    ""link-local-address"" => true,
    ""loopback"" => true,
    ""loopback-address"" => ""127.0.0.1"",
    ""multicast"" => true,
    ""nic"" => ""lo"",
    ""nic-match"" => ""lo"",
    ""point-to-point"" => true,
    ""public-address"" => true,
    ""site-local-address"" => true,
    ""subnet-match"" => ""127.0.0.0/24"",
    ""up"" => true,
    ""virtual"" => true
}
 is:
{""outcome"" => ""success""}
{noformat}

*Expected results:*
No error",2017/04/05 9:18 PM
WFCORE-2627,"org.jboss.as.test.integration.management.cli.CliAliasTestCase consumes an extra 20sec

org.jboss.as.test.integration.management.cli.CliConfigTestCase consumes an extra 40sec

By fixing these 2 tests, 1 minute gain should be expected.
",2017/04/05 5:26 AM
WFCORE-2626,"In the standalone.xml, there are {{<up/>}} criterion which is sufficient to identify a unique NIC under the environment described above.

{code}
    <interfaces>
        <interface name=""management"">
            <up/>
            <inet-address value=""${jboss.bind.address.management:127.0.0.1}""/>
        </interface>
        <interface name=""public"">
            <up/>
            <inet-address value=""${jboss.bind.address:127.0.0.1}""/>
        </interface>
    </interfaces>
{code}

But it says ""ambiguous"". WildFly 10.1.0.Final doesn't show this error.

{code}
# $JBOSS_HOME/bin/standalone.sh -b 192.168.1.1 -bmanagement=192.168.1.1
...
04:38:52,839 WARN  [org.jboss.as.controller] (MSC service thread 1-3) WFLYCTL0023: Value '192.168.1.1' for interface selection criteria 'inet-address' is ambiguous, as more than one address or network interface available on the machine matches it. Because of this ambiguity,
 no address will be selected as a match. Matching addresses: [/192.168.1.1].  Matching network interfaces: [ens9, ens10].
04:38:52,840 WARN  [org.jboss.as.controller] (MSC service thread 1-4) WFLYCTL0023: Value '192.168.1.1' for interface selection criteria 'inet-address' is ambiguous, as more than one address or network interface available on the machine matches it. Because of this ambiguity,
 no address will be selected as a match. Matching addresses: [/192.168.1.1].  Matching network interfaces: [ens9, ens10].
04:38:52,840 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-3) MSC000001: Failed to start service jboss.network.public: org.jboss.msc.service.StartException in service jboss.network.public: WFLYSRV0082: failed to resolve interface public
        at org.jboss.as.server.services.net.NetworkInterfaceService.start(NetworkInterfaceService.java:91)
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)

04:38:52,841 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC000001: Failed to start service jboss.network.management: org.jboss.msc.service.StartException in service jboss.network.management: WFLYSRV0082: failed to resolve interface management
        at org.jboss.as.server.services.net.NetworkInterfaceService.start(NetworkInterfaceService.java:91)
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)
...
{code}",2017/04/04 5:20 PM
WFCORE-2619,"*/subsystem=io/worker=\*:read-attribute(name=core-pool-size)*
Current model description: ""Core worker thread pool size""
Suggested improvement: ""Minimum number of threads to keep in the underlying java.util.concurrent.ThreadPoolExecutor even if they are idle. Threads over this limit will be terminated over time specified by task-keepalive attribute.""",2017/04/03 7:00 AM
WFCORE-2608,"{noformat}
[domain@localhost:9990 /] /deployment-overlay=test:redeploy-links(deployments=[simple-jsp.war])
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {""host-failure-descriptions"" => {""msimka-t450.brq.redhat.com"" => ""JBAS014884: No operation named 'redeploy-links' exists at address [(\""deployment-overlay\"" => \""test\"")]""}},
    ""rolled-back"" => true,
    ""result"" => {}
}
{noformat}",2017/03/31 8:16 AM
WFCORE-2600,"{{CLITestUtil}} creates a command context without setting any {{connectionTimeout}} for it. The default value of the {{connectionTimeout}} is 5 seconds. This value seems to be too low under some circumstances, see JBEAP-8244.

{{CLITestUtil}} at line 79 (see \[1\]) should use a different factory method to create the {{CommandContext}} and should provide a decent value for {{connectionTimeout}} too.

\[1\] https://github.com/wildfly/wildfly-core/blob/master/testsuite/shared/src/main/java/org/jboss/as/test/integration/management/util/CLITestUtil.java#L79 

",2017/03/30 6:57 AM
WFCORE-2598,"When attempting to add a requirement on the PathManager capability to a capability registered with some resource, e.g.
{noformat}
RuntimeCapability<Void> MY_CAPABILITY = RuntimeCapability.Builder.of(""foo"").addRequirements(""org.wildfly.management.path-manager"").build();
{noformat}
I get the following error during boot: 
16:30:55,229 ERROR [org.jboss.as.controller] (Controller Boot Thread) WFLYCTL0362: Capabilities required by resource '/subsystem=infinispan/cache-container=web/distributed-cache=dist/store=file' are not available:
    org.wildfly.management.path-manager; There are no known registration points which can provide this capability.

It seems like this capability registration isn't available to subsystem resources.

Here's the real world use case:
https://github.com/pferraro/wildfly/commit/d5a00ecb6975137e40848b45abfc668c513e849f
See org.jboss.as.clustering.infinispan.subsystem.FileStoreResourceDefinition",2017/03/29 5:48 PM
WFCORE-2617,"When failed credential store flush to file on the disk then we have inconsistency between credential store in memory and persisted file.

I expect consistent state, same aliases in memory and persisted on disk.
We must not add new aliases only to memory.

This problem is exported from issue https://issues.jboss.org/browse/JBEAP-6866 
where is noted as secondary problem.

*HOW TO REPRODUCE*
{code}
/subsystem=elytron/credential-store=cs001:add(uri=""cr-store://test/cs/credentialstore.jceks?create=true"", credential-reference={clear-text=pass123}, relative-to=""jboss.server.data.dir"")
{code}
{code}
/subsystem=elytron/credential-store=cs001/alias=alias001:add(secret-value=secretvalue)
{code}
Now is credentialstore.jceks file persisted on disk here *JBOSS_HOME/standalone/data/cs*
Please remove write permission for folder ""cs""
{code}
chmod g-w  cs
chmod u-w  cs
{code}
Try add another entry to credential store
/subsystem=elytron/credential-store=cs001/alias=alias002:add(secret-value=secretvalue)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYELY00009: Unable to complete operation. 'ELY09525: Unable to flush credential store to storage'"",
    ""rolled-back"" => true
}
And you get error message as above.
Now you list all aliases in credential store:
{code}
/subsystem=elytron/credential-store=cs001:read-children-names(child-type=alias)
{
    ""outcome"" => ""success"",
    ""result"" => [
        ""alias001"",
        ""alias002""
    ]
}
{code}
There is non persisted ""alias002"" too.

*Now we check aliases in persisted file**:*
{code}
reload
{code}
There isn't any alias ""alias002"" after reload.
{code}
/subsystem=elytron/credential-store=cs001:read-children-names(child-type=alias)
{
    ""outcome"" => ""success"",
    ""result"" => [""alias001""]
}
{code}

",2017/03/29 10:27 AM
WFCORE-2593,"When running with Security Manager enabled, {{DeploymentReflectionIndex}} requires additional permissions (see below) even if its creation is guarded by {{ServerPermission(""createDeploymentReflectionIndex"")}}. 

Required additional permissions:
{noformat}
new RuntimePermission(""accessDeclaredMembers"")
new ReflectPermission(""suppressAccessChecks""))
{noformat}

It is actually the constructor of {{ClassReflectionIndex}} invoked from {{DeploymentReflectionIndex#getClassIndex()}} method which requires these permissions.

This issue was catched by {{org.jboss.as.test.integration.pojo.test.BeanFactoryTestCase}}, see the stacktrace:
{noformat}
20:24:38,511 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-3) MSC000001: Failed to start service jboss.pojo.D.CREATE: org.jboss.msc.service.StartException in service jboss.pojo.D.CREATE: java.lang.reflect.InvocationTargetException
	at org.jboss.as.pojo.service.LifecyclePojoPhase.startInternal(LifecyclePojoPhase.java:51)
	at org.jboss.as.pojo.service.AbstractPojoPhase.start(AbstractPojoPhase.java:75)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.as.pojo.service.MethodJoinpoint.dispatch(MethodJoinpoint.java:41)
	at org.jboss.as.pojo.service.BeanUtils.dispatchLifecycleJoinpoint(BeanUtils.java:155)
	at org.jboss.as.pojo.service.LifecyclePojoPhase.dispatchJoinpoint(LifecyclePojoPhase.java:43)
	at org.jboss.as.pojo.service.LifecyclePojoPhase.startInternal(LifecyclePojoPhase.java:49)
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.as.test.integration.pojo.support.D.create(D.java:36)
	... 14 more
Caused by: java.lang.RuntimeException: WFLYSRV0177: Error getting reflective information for class org.jboss.as.test.integration.pojo.support.B with ClassLoader ModuleClassLoader for Module ""deployment.bean-factory.jar"" from Service Module Loader
	at org.jboss.as.server.deployment.reflect.DeploymentReflectionIndex.getClassIndex(DeploymentReflectionIndex.java:70)
	at org.jboss.as.pojo.service.DefaultBeanInfo.lookup(DefaultBeanInfo.java:78)
	at org.jboss.as.pojo.service.DefaultBeanInfo.getConstructor(DefaultBeanInfo.java:86)
	at org.jboss.as.pojo.service.BeanUtils.instantiateBean(BeanUtils.java:98)
	at org.jboss.as.pojo.descriptor.BaseBeanFactory.create(BaseBeanFactory.java:62)
	... 19 more
Caused by: java.security.AccessControlException: WFSM000001: Permission check failed (permission ""(""java.lang.RuntimePermission"" ""accessDeclaredMembers"")"" in code source ""(vfs:/content/bean-factory.jar <no signer certificates>)"" of ""ModuleClassLoader for Module ""deployment.bean-factory.jar"" from Service Module Loader"")
	at org.wildfly.security.manager.WildFlySecurityManager.checkPermission(WildFlySecurityManager.java:278)
	at org.wildfly.security.manager.WildFlySecurityManager.checkPermission(WildFlySecurityManager.java:175)
	at java.lang.Class.checkMemberAccess(Class.java:2348)
	at java.lang.Class.getDeclaredFields(Class.java:1915)
	at org.jboss.as.server.deployment.reflect.ClassReflectionIndex.<init>(ClassReflectionIndex.java:72)
	at org.jboss.as.server.deployment.reflect.DeploymentReflectionIndex.getClassIndex(DeploymentReflectionIndex.java:66)
	... 23 more
{noformat}",2017/03/28 2:26 PM
WFCORE-2591,"add operation
- content should be required.
- alternatives hash/bytes/url/path/input-stream-index/empty should be required.

add-content operation
- content should be required.
- alternatives input-stream-index/hash/bytes/url should be required.
- alternatives empty/relative-to/path should not be present in alternatives list.
",2017/03/28 10:42 AM
WFCORE-2585,"This is regression compared to EAP 7.0.0. 
See attached logs server-one.log , host-controller.log
{code}
ERROR [org.jboss.msc.service.fail] (ServerService Thread Pool -- 2) MSC000001: Failed to start service jboss.server-boot-operations: org.jboss.msc.service.StartException in service jboss.server-boot-operations: java.net.ConnectException: WFLYPRT0053: Could not connect to remote://0.0.0.0:9999. The connection failed
	at org.jboss.as.server.mgmt.domain.ServerBootOperationsService$1.run(ServerBootOperationsService.java:72)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
Caused by: java.net.ConnectException: WFLYPRT0053: Could not connect to remote://0.0.0.0:9999. The connection failed
	at org.jboss.as.protocol.ProtocolConnectionUtils.connectSync(ProtocolConnectionUtils.java:121)
	at org.jboss.as.protocol.ProtocolConnectionManager$EstablishingConnection.connect(ProtocolConnectionManager.java:259)
	at org.jboss.as.protocol.ProtocolConnectionManager.connect(ProtocolConnectionManager.java:70)
	at org.jboss.as.server.mgmt.domain.HostControllerConnection.openConnection(HostControllerConnection.java:128)
	at org.jboss.as.server.mgmt.domain.HostControllerClient.resolveBootUpdates(HostControllerClient.java:110)
	at org.jboss.as.server.mgmt.domain.ServerBootOperationsService$1.run(ServerBootOperationsService.java:68)
	... 4 more
Caused by: javax.security.sasl.SaslException: Authentication failed: none of the mechanisms presented by the server (JBOSS-LOCAL-USER, DIGEST-MD5) are supported
	at org.jboss.remoting3.remote.ClientConnectionOpenListener$Capabilities.handleEvent(ClientConnectionOpenListener.java:426)
	at org.jboss.remoting3.remote.ClientConnectionOpenListener$Capabilities.handleEvent(ClientConnectionOpenListener.java:241)
	at org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:92)
	at org.xnio.conduits.ReadReadyHandler$ChannelListenerHandler.readReady(ReadReadyHandler.java:66)
	at org.xnio.nio.NioSocketConduit.handleReady(NioSocketConduit.java:89)
	at org.xnio.nio.WorkerThread.run(WorkerThread.java:567)
	at ...asynchronous invocation...(Unknown Source)
	at org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:465)
	at org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:427)
	at org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:415)
	at org.jboss.as.protocol.ProtocolConnectionUtils.connect(ProtocolConnectionUtils.java:177)
	at org.jboss.as.protocol.ProtocolConnectionUtils.connectSync(ProtocolConnectionUtils.java:113)
	... 9 more
{code}",2017/03/27 5:51 PM
WFCORE-2582,"jboss-cli.bat script is unable to start on Windows, if JBOSS_HOME folder contains '!' character, if '!' character is not at the end of the name of JBOSS_HOME folder.

jboss-cli.bat script is unable to start on Windows if JBOSS_HOME ends with exclamation mark, but it is covered by JBEAP-249

{noformat}
C:\Users\Administrator\playground\7.1.0.DR15\jboss!eap\bin>jboss-cli.bat
The system cannot find the path specified.
The system cannot find the path specified.
Could not locate ""C:\Users\Administrator\playground\7.1.0.DR15\jbosseap\bin\jboss-modules.jar"".
Please check that you are in the bin directory when running this script.
Press any key to continue . . .

C:\Users\Administrator\playground\7.1.0.DR15\jboss!eap\bin>jboss-cli.bat
{noformat}

* This issue is caused by JBEAP-9699

*Workaround:*
Rename JBOSS_HOME folder",2017/03/27 11:14 AM
WFCORE-2576,"An example failure from JBEAP-6887:

{code}
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {
        ""WFLYCTL0080: Failed services"" => {""org.wildfly.security.credential-store-client.cs_not_found_exception"" => ""org.jboss.msc.service.StartException in service org.wildfly.security.credential-store-client.cs_not_found_exception: WFLYELY00004: Unable to start the service.
    Caused by: org.wildfly.security.credential.store.CredentialStoreException: ELY09506: Cannot read credential storage file '/home/hsvabek/securityworkspace/VERIFICATION/2016_11_02_UX_testing/jboss-eap-7.1.0.DR7/standalone/data/cs/keystore-not_exists.jceks' for the store named 'cs_not_found_exception'
    Caused by: java.io.FileNotFoundException: /home/hsvabek/securityworkspace/VERIFICATION/2016_11_02_UX_testing/jboss-eap-7.1.0.DR7/standalone/data/cs/keystore-not_exists.jceks (No such file or directory)""},
        ""WFLYCTL0412: Required services that are not installed:"" => [""org.wildfly.security.credential-store-client.cs_not_found_exception""],
        ""WFLYCTL0180: Services with missing/unavailable dependencies"" => undefined
    },
    ""rolled-back"" => true
}
{code}

There is no requirement not to show an exception or stack trace snippet. IMHO it's the best part of the message. And it's not feasible to show nothing else, as there are a number of layers in between.

But, this can certainly be improved, which is what this issue is about:

1) ""WFLYCTL0180: Services with missing/unavailable dependencies"" => undefined

This is just noise. I'm quite certain this is already fixed and verified in a different issue though. Reproducing this against current code doesn't show this bit any longer.

2) ""org.jboss.msc.service.StartException in service org.wildfly.security.credential-store-client.cs_not_found_exception: ""

This is superfluous, since it follows """"WFLYCTL0080: Failed services"" => {""org.wildfly.security.credential-store-client.cs_not_found_exception"""" which says the same thing. This can go.

3) """"WFLYCTL0412: Required services that are not installed:"" => [""org.wildfly.security.credential-store-client.cs_not_found_exception""]""

Seems redundant since the only non-installed service listed is the one already reported as failed. This I'm not certain I'll fix as doing so may introduce some other issue. But I'll have a look.",2017/03/24 10:24 AM
WFCORE-2564,"The :resolve-path operation will always resolve the path based on the relative-to attribute.
In the messaging subsystem, we have a different behaviour where the relative-to attribute is *ignored* (whether it is defined or not) when the path value correponds to an absolute path.

To be consistent with this behaviour, the :resolve-path operation builder would need customization and specify that the relative-to attribute must be ignored when the path is absolute.
",2017/03/21 5:14 AM
WFCORE-2563,"In case when {{module}} attribute from Elytron {{dir-context}} includes module which does not exist, then insufficient failure description is provided - it only prints name of given module. It should rather inform that given module does not exist.

See:
{code}
/subsystem=elytron/dir-context=someDirContext:add(url=localhost,module=wrong.module)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""wrong.module"",
    ""rolled-back"" => true
}
{code}",2017/03/21 3:23 AM
WFCORE-2561,"This CLI command \[1\] was working with EAP 7.1.0.DR13 and previous versions of EAP including EAP 7.0, but stopped working with jboss-cli.bat from EAP 7.1.0.DR14 with \[2\].

As this is regression marking as blocker. Workaround for customer would mean need to update all its commands in scripts to use quotes and quotes escaping.

\[1\] 
{noformat}
jboss-cli.bat --connect --controller=127.0.0.1:9990 --commands=:read-attribute(name=server-state)
{noformat}
Note we execute this command from JVM as list =>
{noformat}
[""jboss-cli.bat"", ""--connect"", ""--controller=127.0.0.1:9990"", ""--commands=:read-attribute(name=server-state)""].execute()
{noformat}, thus by JVM it should be provided as individual parameters.

\[2\]
{noformat}
else was unexpected at this time.
{noformat}
Most likely the regression is caused by fix for [JBEAP-8808]",2017/03/20 2:20 PM
WFCORE-2557,"This issue is a followup on WFLY-8021 where there was 2 complex attributes on the same resource:
- target-credential-reference (attribute group = target, xml element name = credential-reference)
- source-credential-reference (attribute group = source, xml element name = credential-reference)

with the corresponding XML structure:

{code}
<jms-bridge name=""myBridge"" ...>
   <source ...>
        <credential-reference clear-text=""passwordOut!""/>
   </source>
   <target ...>
        <credential-reference clear-text=""passwordOut!""/>
   </target>
</jms-bridge>
{code}

The parser fails to parse the source-credential-reference as the persistent XML description elementsAttribute map has a single entry for the credential-reference key that point to the target-credential-reference attribute.
",2017/03/17 9:45 AM
WFCORE-2554,"batch command could ignore empty lines in file 

{code}
domain@localhost:9990 /] batch --file=/tmp/ely.cli
Failed to create batch from /tmp/ely.cli: The line is null or empty.
{code}

cli file contains:
{code}
command
<empty_line>
command
{code}",2017/03/17 4:52 AM
WFCORE-2552,"The description (in management model *AND* the XSD file!) for {{max-outbound-messages}} is
bq. The maximum number of outbound channels to support for a connection.
and for {{max-inbound-messages}}
bq. The maximum number of inbound channels to support for a connection.
for {{max-outbound-channels}}:
bq. The maximum number of concurrent outbound messages on a channel.
for {{max-inbound-channels}}:
bq. The maximum number of concurrent inbound messages on a channel.

I guess these descriptions should be the other way around, they confuse channels and messages :)",2017/03/16 3:22 PM
WFCORE-2550,NoData,2017/03/16 12:23 PM
WFCORE-2549,"*User impact:* User can't configure kerberos authentication using Elytron
*Workaround:* There is no workaround

*Description:*
If I try command which worked previously I get error
{code}
[standalone@localhost:9990 /] /subsystem=elytron/kerberos-security-factory=a:add(principal=HTTP/localhost@JBOSS.ORG, path=/somewhere, mechanism-oids=[""1.2.840.113554.1.2.2"",""1.3.6.1.5.5.2""])
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0158: Operation handler failed: java.lang.IllegalArgumentException"",
    ""rolled-back"" => true
}
{code}

In server.log there is this stacktrace
{code}
15:00:53,476 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 4) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""subsystem"" => ""elytron""),
    (""kerberos-security-factory"" => ""a"")
]): java.lang.IllegalArgumentException
	at org.jboss.dmr.ModelValue.asPropertyList(ModelValue.java:103)
	at org.jboss.dmr.ModelNode.asPropertyList(ModelNode.java:503)
	at org.wildfly.extension.elytron.KerberosSecurityFactoryDefinition$2.getValueSupplier(KerberosSecurityFactoryDefinition.java:168)
	at org.wildfly.extension.elytron.TrivialAddHandler.performRuntime(TrivialAddHandler.java:77)
	at org.jboss.as.controller.AbstractAddStepHandler$1.execute(AbstractAddStepHandler.java:151)
	at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:979)
	at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:722)
	at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:441)
	at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1388)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:421)
	at org.jboss.as.controller.ModelControllerImpl.lambda$execute$1(ModelControllerImpl.java:243)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:263)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:229)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:243)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:217)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$400(ModelControllerClientOperationHandler.java:137)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:161)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:287)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:244)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:254)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:225)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)
{code}

Adding optional {{options}} attribute makes command work again
{code}
[standalone@localhost:9990 /] /subsystem=elytron/kerberos-security-factory=a:add(principal=HTTP/localhost@JBOSS.ORG, path=/somewhere, mechanism-oids=[""1.2.840.113554.1.2.2"",""1.3.6.1.5.5.2""],options={a=b})
{""outcome"" => ""success""}
{code}

But after reload, there is error in server log
{code}
18:30:37,430 ERROR [org.jboss.as.controller] (Controller Boot Thread) 

OPVDX001: Validation error in standalone.xml -----------------------------------
|
|  365:     </kerberos-security-factory>
|  366: </credential-security-factories>
|  367: <mappers>
|       ^^^^ 'mappers' isn't an allowed element here
|            
|            Elements allowed here are: 
|              audit-logging                  policy                         
|              authentication-client          providers                      
|              credential-security-factories  sasl                           
|              credential-stores              security-domains               
|              dir-contexts                   security-properties            
|              http                           security-realms                
|              mappers                        tls                            
|
|  368:     <constant-permission-mapper name=""default-permission-mapper"">
|  369:         <permission class-name=""org.wildfly.security.auth.permission.LoginPermission""/>
|  370:         <permission class-name=""org.wildfly.extension.batch.jberet.deployment.BatchPermission"" module=""org.wildfly.extension.batch.jberet"" target-name=""*""/>
|
| 'mappers' is allowed in elements: 
| - server > profile > {urn:wildfly:elytron:1.0}subsystem
| ""
|
| The primary underlying error message was:
| > ParseError at [row,col]:[367,13]
| > Message: WFLYCTL0198: Unexpected element
| >   '{urn:wildfly:elytron:1.0}mappers' encountered
|
|-------------------------------------------------------------------------------

18:30:37,430 ERROR [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0055: Caught exception during boot: org.jboss.as.controller.persistence.ConfigurationPersistenceException: WFLYCTL0085: Failed to parse configuration
	at org.jboss.as.controller.persistence.XmlConfigurationPersister.load(XmlConfigurationPersister.java:143)
	at org.jboss.as.server.ServerService.boot(ServerService.java:376)
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:337)
	at java.lang.Thread.run(Thread.java:745)

18:30:37,432 FATAL [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0056: Server boot has failed in an unrecoverable manner; exiting. See previous messages for details.
{code}

Attribute {{options}} is marked correctly optional in model. 
{code}
	""options"" => {
	    ""type"" => OBJECT,
	    ""description"" => ""The Krb5LoginModule additional options."",
	    ""expressions-allowed"" => false,
	    ""required"" => false,
	    ""nillable"" => true,
	    ""value-type"" => STRING,
	    ""access-type"" => ""read-write"",
	    ""storage"" => ""configuration"",
	    ""restart-required"" => ""no-services""
	},
{code}",2017/03/16 10:55 AM
WFCORE-2535,"*org.jboss.as.test.integration.management.cli.modules.ModuleResourceRootPathsTestCase#testModules*

{{cd testsuite/standalone/}}
{{mvn test -Dtest=ModuleResourceRootPathsTestCase -Dsecurity.manager -DtestLogToFile=false}}

{code}
13:26:00,583 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-6) MSC000001: Failed to start service jboss.deployment.unit.""test-archive.war"".INSTALL: org.jboss.msc.service.StartException in service jboss.deployment.unit.""test-archive.war"".INSTALL: WFLYSRV0153: Failed to process phase INSTALL of deployment ""test-archive.war""
	at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:172)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1153)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.lang.Thread.run(Thread.java:785)
Caused by: java.security.AccessControlException: WFSM000001: Permission check failed (permission ""(""java.util.PropertyPermission"" ""jboss.bind.address"" ""read"")"" in code source ""(vfs:/content/test-archive.war <no signer certificates>)"" of ""ModuleClassLoader for Module ""deployment.test-archive.war"" from Service Module Loader"")
	at org.wildfly.security.manager.WildFlySecurityManager.checkPermission(WildFlySecurityManager.java:278)
	at org.wildfly.security.manager.WildFlySecurityManager.checkPropertyAccess(WildFlySecurityManager.java:469)
	at java.lang.System.getProperty(System.java:443)
	at java.lang.System.getProperty(System.java:427)
	at org.jboss.as.test.shared.TestSuiteEnvironment.getSystemProperty(TestSuiteEnvironment.java:50)
	at org.jboss.as.test.shared.TestSuiteEnvironment.getHttpAddress(TestSuiteEnvironment.java:173)
	at org.wildfly.test.undertow.UndertowServiceActivator.getAddress(UndertowServiceActivator.java:100)
	at org.wildfly.test.undertow.UndertowServiceActivator.activate(UndertowServiceActivator.java:66)
	at org.jboss.as.server.deployment.service.ServiceActivatorProcessor.deploy(ServiceActivatorProcessor.java:91)
	at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:165)
	... 5 more
{code}
",2017/03/14 8:27 AM
WFCORE-2534,"*org.jboss.as.test.integration.domain.slavereconnect.SlaveReconnectTestCase#test01_OrderedExtensionsAndDeployments*
*org.jboss.as.test.integration.domain.slavereconnect.SlaveReconnectTestCase#test02_DeploymentOverlays*
{{cd testsuite/domain/}}
{{mvn test -Dtest=SlaveReconnectTestCase -Dsecurity.manager -DtestLogToFile=false}}
{code}
[Server:server-affected] 13:16:12,425 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-7) MSC000001: Failed to start service test.deployment.one: org.jboss.msc.service.StartException in service test.deployment.one: Failed to start service
[Server:server-affected] 	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1978) [jboss-msc-1.2.7.SP1-redhat-1.jar:1.2.7.SP1-redhat-1]
[Server:server-affected] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1153) [rt.jar:1.8.0]
[Server:server-affected] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [rt.jar:1.8.0]
[Server:server-affected] 	at java.lang.Thread.run(Thread.java:785) [vm.jar:1.8.0]
[Server:server-affected] Caused by: java.security.AccessControlException: WFSM000001: Permission check failed (permission ""(""java.util.PropertyPermission"" ""test.deployment.prop.one"" ""write"")"" in code source ""(vfs:/content/reconnect-slave-depone.jar <no signer certificates>)"" of ""ModuleClassLoader for Module ""deployment.reconnect-slave-depone.jar"" from Service Module Loader"")
[Server:server-affected] 	at org.wildfly.security.manager.WildFlySecurityManager.checkPermission(WildFlySecurityManager.java:278) [wildfly-elytron-1.1.0.Beta27-redhat-1.jar:1.1.0.Beta27-redhat-1]
[Server:server-affected] 	at org.wildfly.security.manager.WildFlySecurityManager.checkPermission(WildFlySecurityManager.java:175) [wildfly-elytron-1.1.0.Beta27-redhat-1.jar:1.1.0.Beta27-redhat-1]
[Server:server-affected] 	at java.lang.System.setProperty(System.java:476) [vm.jar:1.8.0]
[Server:server-affected] 	at org.jboss.as.test.integration.domain.slavereconnect.deployment.ServiceActivatorBaseDeployment.start(ServiceActivatorBaseDeployment.java:64)
[Server:server-affected] 	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032) [jboss-msc-1.2.7.SP1-redhat-1.jar:1.2.7.SP1-redhat-1]
[Server:server-affected] 	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955) [jboss-msc-1.2.7.SP1-redhat-1.jar:1.2.7.SP1-redhat-1]
[Server:server-affected] 	... 3 more
{code}",2017/03/14 8:20 AM
WFCORE-2532,"* *org.jboss.as.test.integration.logging.operations.CustomFormattersTestCase*
* *org.jboss.as.test.integration.logging.operations.CustomHandlerOperationsTestCase*
* *org.jboss.as.test.integration.logging.operations.CustomHandlerTestCase*
* *org.jboss.as.test.integration.logging.operations.Log4jCustomHandlerTestCase*
* *org.jboss.as.test.integration.logging.perdeploy.JBossLog4jXmlTestCase*
* *org.jboss.as.test.integration.logging.perdeploy.JBossLoggingPropertiesTestCase*
* *org.jboss.as.test.integration.logging.perdeploy.Log4jPropertiesTestCase*
* *org.jboss.as.test.integration.logging.perdeploy.Log4jXmlTestCase*
* *org.jboss.as.test.integration.logging.perdeploy.LoggingPropertiesTestCase*
* *org.jboss.as.test.integration.logging.profiles.LoggingProfilesTestCase*
* *org.jboss.as.test.integration.logging.profiles.NonExistingProfileTestCase*
* *org.jboss.as.test.integration.logging.syslog.SyslogHandlerTestCase*
{{cd testsuite/standalone/}}
{{mvn test -Dtest=org.jboss.as.test.integration.logging.**.* -Dsecurity.manager}}
{code}
org.jboss.as.controller.client.helpers.standalone.ServerDeploymentHelper$ServerDeploymentException: java.lang.Exception: {
    ""WFLYCTL0080: Failed services"" => {""jboss.deployment.unit.\""logging1.jar\"".INSTALL"" => ""org.jboss.msc.service.StartException in service jboss.deployment.unit.\""logging1.jar\"".INSTALL: WFLYSRV0153: Failed to process phase INSTALL of deployment \""logging1.jar\""
    Caused by: java.security.AccessControlException: WFSM000001: Permission check failed (permission \""(\""java.util.PropertyPermission\"" \""jboss.bind.address\"" \""read\"")\"" in code source \""(vfs:/content/logging1.jar <no signer certificates>)\"" of \""ModuleClassLoader for Module \""deployment.logging1.jar\"" from Service Module Loader\"")""},
    ""WFLYCTL0412: Required services that are not installed:"" => [""jboss.deployment.unit.\""logging1.jar\"".INSTALL""]
}
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.getActionResult(ServerDeploymentPlanResultFuture.java:134)
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.getResultFromNode(ServerDeploymentPlanResultFuture.java:123)
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.get(ServerDeploymentPlanResultFuture.java:85)
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.get(ServerDeploymentPlanResultFuture.java:42)
	at org.jboss.as.controller.client.helpers.standalone.ServerDeploymentHelper.deploy(ServerDeploymentHelper.java:55)
	at org.jboss.as.test.integration.logging.AbstractLoggingTestCase.deploy(AbstractLoggingTestCase.java:168)
	at org.jboss.as.test.integration.logging.profiles.LoggingProfilesTestCase.deploy(LoggingProfilesTestCase.java:314)
	at org.jboss.as.test.integration.logging.profiles.LoggingProfilesTestCase.deploy(LoggingProfilesTestCase.java:304)
	at org.jboss.as.test.integration.logging.profiles.LoggingProfilesTestCase.testProfiles(LoggingProfilesTestCase.java:201
{code}

* *org.jboss.as.test.manualmode.logging.Log4jAppenderTestCase*
* *org.jboss.as.test.manualmode.logging.LoggingPreferencesTestCase*
* *org.jboss.as.test.manualmode.logging.PerDeployLoggingTestCase*
* *org.jboss.as.test.manualmode.logging.ReconnectSyslogServerTestCase*
* *org.jboss.as.test.manualmode.logging.SizeAppenderRestartTestCase*
* *org.jboss.as.test.manualmode.logging.SyslogIsNotAvailableDuringServerBootTestCase*
{{cd testsuite/manualmode/}}
{{mvn test -Dtest=org.jboss.as.test.manualmode.logging.* -Dsecurity.manager}}
{code}
org.jboss.as.controller.client.helpers.standalone.ServerDeploymentHelper$ServerDeploymentException: java.lang.Exception: {
    ""WFLYCTL0080: Failed services"" => {""jboss.deployment.unit.\""logging-test.jar\"".INSTALL"" => ""org.jboss.msc.service.StartException in service jboss.deployment.unit.\""logging-test.jar\"".INSTALL: WFLYSRV0153: Failed to process phase INSTALL of deployment \""logging-test.jar\""
    Caused by: java.security.AccessControlException: WFSM000001: Permission check failed (permission \""(\""java.util.PropertyPermission\"" \""jboss.bind.address\"" \""read\"")\"" in code source \""(vfs:/content/logging-test.jar <no signer certificates>)\"" of \""ModuleClassLoader for Module \""deployment.logging-test.jar\"" from Service Module Loader\"")""},
    ""WFLYCTL0412: Required services that are not installed:"" => [""jboss.deployment.unit.\""logging-test.jar\"".INSTALL""]
}
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.getActionResult(ServerDeploymentPlanResultFuture.java:134)
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.getResultFromNode(ServerDeploymentPlanResultFuture.java:123)
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.get(ServerDeploymentPlanResultFuture.java:85)
	at org.jboss.as.controller.client.helpers.standalone.impl.ServerDeploymentPlanResultFuture.get(ServerDeploymentPlanResultFuture.java:42)
	at org.jboss.as.controller.client.helpers.standalone.ServerDeploymentHelper.deploy(ServerDeploymentHelper.java:55)
	at org.wildfly.core.testrunner.ServerController.deploy(ServerController.java:92)
	at org.jboss.as.test.manualmode.logging.AbstractLoggingTestCase.deploy(AbstractLoggingTestCase.java:197)
	at org.jboss.as.test.manualmode.logging.Log4jAppenderTestCase.startContainer(Log4jAppenderTestCase.java:93)
{code}",2017/03/14 7:44 AM
WFCORE-2531,"Currently, the {{org.jboss.as.controller.PersistentResourceXMLDescription}} does not perform any validation when using attribute groups or object type attribute definitions to check how many times an attribute was defined.

For instance, when using a resource description with an attribute group like this:

{code}
        static final AttributeDefinition clusterAttr1 = create(""cluster-attr1"", ModelType.STRING)
                .setAttributeGroup(""cluster"")
                .setXmlName(""attr1"")
                .build();
        static final AttributeDefinition clusterAttr2 = create(""cluster-attr2"", ModelType.STRING)
                .setAttributeGroup(""cluster"")
                .setXmlName(""attr2"")
                .build();
{code}

The parser allows a XML declaration as follows:

{code}
    <resource name=""foo3"">
        <cluster attr1=""bar1"" attr2=""baz1""/>
        <cluster attr1=""bar2"" attr2=""baz2""/>
    </resource>
{code}

The declaration does not throws any error and only the second declaration of {{cluster}} is populated into the model.

A similar problem exists when using object type attribute definitions as follows:

{code}
static final ObjectTypeAttributeDefinition USERS_PROPERTIES = ObjectTypeAttributeDefinition.Builder.of(""user-properties"",
                create(""path"", ModelType.STRING, false)
                        .setAllowExpression(false)
                        .build(),
                create(""relative-to"", ModelType.STRING, false)
                        .setAllowExpression(false)
                        .build())
                .build();
{code}

The parser also allows a declaration as follows:

{code}
    <object-type-test name=""foo5"">
        <user-properties path=""path1"" relative-to=""relative1""/>
        <user-properties path=""path2"" relative-to=""relative2""/>
    </object-type-test>
{code}

As a result, only the last {{user-properties}} is populated in the model and we don't get any error.",2017/03/14 7:22 AM
WFCORE-2530,"The reply properties of the {{:read-boot-errors()}} operation lists the attribute {{missing-transitive-dependency-problems}} which is defined as 

{code}
""missing-transitive-dependency-problems"" => {
    ""type"" => OBJECT,
    ""description"" => ""Missing transitive dependency issues found during execution of the operation."",
    ""expressions-allowed"" => false,
    ""required"" => false,
    ""nillable"" => true,
    ""value-type"" => {
        ""services-missing-transitive-dependencies"" => {
            ""type"" => LIST,
            ""description"" => ""Services that had a missing transitive dependency."",
            ""expressions-allowed"" => false,
            ""required"" => true,
            ""nillable"" => false,
            ""value-type"" => STRING
        },
        ""possible-causes"" => {
            ""type"" => LIST,
            ""description"" => ""Services that are missing and may be the cause of the missing transitive dependency."",
            ""expressions-allowed"" => false,
            ""required"" => true,
            ""nillable"" => false,
            ""value-type"" => STRING
        }
    }
}
{code}

However the result uses the strings ""Services that were unable to start:"" and ""Services that may be the cause:"" instead of {{services-missing-transitive-dependencies}} and {{possible-causes}}: 

{code}
...
    ""missing-transitive-dependency-problems"" => {
        ""Services that were unable to start:"" => [""jboss.messaging-activemq.default.jms.manager""],
        ""Services that may be the cause:"" => [
            ""jboss.http-upgrade-registry.default"",
            ""jboss.remoting.remotingConnectorInfoService.http-remoting-connector""
        ]
    }
...
{code}",2017/03/14 5:27 AM
WFCORE-2874,"Following IO worker attributes can be set to negative values which in this context doesn't make sense:
* {{io-threads}}
* {{stack-size}}
* {{task-keepalive}}
* {{task-max-threads}}",2017/03/13 7:33 AM
WFCORE-2520,"Expressions (system properties, variables and command substitutions) aren't resolved and replaced during parsing of argument and parameter values in case the value is:
* quoted;
*  a value of an attribute of a complex type;
* list item;
* in parenthesis.
E.g. op:add(param=""$var"")",2017/03/11 3:09 PM
WFCORE-2514,"If it doesn't have proper write access to an existing backupgc.log, standalone.sh will hang. The file mv should use the -f flag.",2017/03/09 10:33 AM
WFCORE-2511,"When this operation has been first specified, it has been required to fail if the deployment was not existing. That is not right. Linked deployments can be non existing and a pattern can return an empty set of deployments.



The high level operation from the CLI might pass an unexisting deployment name (taking the one from the overlay link to be created for example) which would break the final operation (aka the built composite from the CLI).",2017/03/09 6:58 AM
WFCORE-2502,"In case when cache is used for legacy LDAP security realm and any access to secured resource occures, then entry is added into cache even if user has not been authenticated correctly. This can cause that valid entries are evicted due to max-cache-size. This reduce benefit of LDAP cache and impacts performance.

Same behavior can be seen in 7.0.0.GA.",2017/03/08 6:12 AM
WFCORE-2486,Contradics JBEAP-8125,2017/03/07 4:04 AM
WFCORE-2483,"Priority is BLOCKER because this issue blocks RFE verification https://issues.jboss.org/browse/EAP7-538

There must be credential store integration with core management as is mentioned in requirements of RFE.

*management/security-realm*
*management/security-realm/authentication/truststore* keystore-password
*management/security-realm/server-identity/ssl* key-password and keystore-password
*management/security-realm/server-identity/secret*
*management/security-realm/authentication/users*

But *security-realm* is deprecated, these resources have this description:
{code}
The security-realm configuration is deprecated and may be removed or moved in future versions.
{code}


",2017/03/06 8:19 AM
WFCORE-2360,"When trying to remove a running {{server-config}} on slave host from {{host-master}} controller, the following message is produced in CLI:
{code}[domain@localhost:9990 /] /host=hc1/server-config=server-two:remove()
{
    ""outcome"" => ""failed"",
    ""result"" => {},
    ""failure-description"" => {""host-failure-descriptions"" => {""hc1"" => ""WFLYHC0201: Error synchronizing the host model with the domain controller model with failure : WFLYCTL0063: Composite operation was rolled back.""}},
    ""rolled-back"" => true
}
{code}

This is not very informative. The error message from just removing running {{server-config}} managed by controller is different, and also much more informative:
{code}[domain@localhost:9990 /] /host=master/server-config=server-two:remove()
{
    ""outcome"" => ""failed"",
    ""result"" => {},
    ""failure-description"" => {""host-failure-descriptions"" => {""master"" => ""WFLYHC0078: Server (server-two) still running""}},
    ""rolled-back"" => true
}
{code}",2017/03/03 11:20 AM
WFCORE-2359,"{code}
[standalone@embedded /] /socket-binding-group=standard-sockets/socket-binding=test:add(interface=bogus,port=12345)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""WFLYCTL0369: Required capabilities are not available:
    org.wildfly.network.interface.bogus; There are no known registration points which can provide this capability."",
    ""rolled-back"" => true
}
{code}

The failure message is not fully helpful, since while there are no reg points for org.wildfly.network.interface.bogus there are points for caps whose dynamic part is org.wildfly.network.interface.

The message is created using the results of CapabilityRegistry.getPossibleProviderPoints(), which just does a map lookup of the passed in capability name.

Any fix that changes getPossibleProviderPoints() will need to be careful not to break other uses of that method.",2017/03/03 10:23 AM
WFCORE-2348,"When starting WildFly as a service in domain mode using init scripts there appears in  console.log error:

/usr/bin/dirname: unrecognized option '--domain-config=domain.xml'
Try '/usr/bin/dirname --help' for more information.",2017/03/02 8:15 AM
WFCORE-2347,"Some tests FileArgumentTestCase and FileWithPropertiesTestCase are making use of a private way to interact with a CLI process. We know that this inter-process communication is subject to timing issues. I suspect these intermittent failures to be caused by this private implementation.

A lot of effort has been put in the class CliProcessWrapper to stabilise this interaction. These 2 tests should use this class.
",2017/03/01 5:19 AM
WFCORE-2343,"ExpressionResolverUnitTestCase does the and then checks the resolution of the expression returns ""defaulted"":

{code}
input.get(""defaulted"").set(new ValueExpression(""${test:default}""));
{code}

That's fragile since the commonly used -Dtest=xxxx arg to maven will break it. ",2017/02/28 1:45 PM
WFCORE-2338,NoData,2017/02/27 9:58 AM
WFCORE-2332,"org.jboss.as.test.manualmode.management.cli.ReloadRedirectTestCase from Wildfly core manual mode module stuck on HP-UX

{{destroy()}} is unable to kill the process waiting for the user input (accept certificate dialogue). We could either destroy the process forcibly by updating CliProcessWrapper:
{code:java}
    public void destroyProcess() {
        cliProcess.destroy();
    }
{code}
to 
{code:java}
    public void destroyProcess() {
        cliProcess.destroyForcibly();
    }
{code}
or add {{cliProc.ctrlCAndWaitForClose();}} into finally block just before destroying the process in test case.
ReloadRedirectTestCase#testReloadwithRedirect()
{code:java}
    finally {
        cliProc.ctrlCAndWaitForClose();
        cliProc.destroyProcess();
    }
{code}

see WFCORE-2216 for test log and thread dump 

I'll send a PR for the second option.",2017/02/27 7:38 AM
WFCORE-2330,"JBoss-CLI ""deploy -l"" always returns exit code 1 even when it succeededs.

It looks that DeploymentHandler.listDeployments() always throws CommandFormatException and this causes the ""deploy -l"" command returns exit code 1.

{code:java|title=cli/src/main/java/org/jboss/as/cli/handlers/DeploymentHandler.java}
 55     protected void listDeployments(CommandContext ctx, boolean l) throws CommandFormatException {
 56         if(!l) {
 57             printList(ctx, Util.getDeployments(ctx.getModelControllerClient()), l);
 58             return;
 59         }
 60         final ModelControllerClient client = ctx.getModelControllerClient();
 61         final List<String> names = Util.getDeployments(client);
 62         if(names.isEmpty()) {
 63             return;
 64         }
 65 
 66         final StrictSizeTable table = new StrictSizeTable(names.size());
 67         final List<Property> descriptions = getDeploymentDescriptions(ctx, names).asPropertyList();
 68         for(Property prop : descriptions) {
 69             final ModelNode step = prop.getValue();
 70             if(step.hasDefined(Util.RESULT)) {
 71                 final ModelNode result = step.get(Util.RESULT);
 72                 table.addCell(Util.NAME, result.get(Util.NAME).asString());
 73                 table.addCell(Util.RUNTIME_NAME, result.get(Util.RUNTIME_NAME).asString());
 74                 if(result.has(Util.ENABLED)) {
 75                     table.addCell(Util.ENABLED, result.get(Util.ENABLED).asString());
 76                 }
 77                 if(result.has(Util.STATUS)) {
 78                     table.addCell(Util.STATUS, result.get(Util.STATUS).asString());
 79                 }
 80             }
 81             if(!table.isAtLastRow()) {
 82                 table.nextRow();
 83             }
 84         }
 85         throw new CommandFormatException(table.toString());   // -> CommandFormatException is always thrown. This looks a root cause.
 86     }
{code}

{code:java|title=cli/src/main/java/org/jboss/as/cli/impl/CommandContextImpl.java}
 907     public void handleSafe(String line) {
 908         exitCode = 0;
 909         try {
 910             handle(line);
 911         } catch(Throwable t) {
 912             error(Util.getMessagesFromThrowable(t));   // -> This is invoked when CommandFormatException happened in the above listDeployments. 
 913         }
 914     }
  :
 993     protected void error(String message) {
 994         this.exitCode = 1;
 995         printLine(message);
 996     }
{code}",2017/02/26 8:22 PM
WFCORE-2327,"When RBAC enabled, embed-server froze during start - CLI prompt of started server does not show and need to be interrupted by Ctrl+C.

{code}
bin/jboss-cli.sh
You are disconnected at the moment. Type 'connect' to connect to the server or 'help' for the list of supported commands.
[disconnected /] embed-server --std-out=echo
15:55:41,588 INFO  [org.jboss.modules] (AeshProcess: 1) JBoss Modules version 1.6.0.Beta3
15:55:41,650 INFO  [org.jboss.msc] (AeshProcess: 1) JBoss MSC version 1.2.7.Final
15:55:41,773 INFO  [org.jboss.as] (MSC service thread 1-8) WFLYSRV0049: WildFly Core 3.0.0.Alpha18-SNAPSHOT ""Kenny"" starting
15:55:41,966 INFO  [org.jboss.as.domain.management] (MSC service thread 1-4) WFLYDM0136: Registered OpenSSL provider
15:55:42,302 INFO  [org.jboss.as.controller.management-deprecated] (Controller Boot Thread) WFLYCTL0028: Attribute 'security-realm' in the resource at address '/core-service=management/management-interface=http-interface' is deprecated, and may be removed in future version. See the attribute description in the output of the read-resource-description operation to learn more about the deprecation.
15:55:42,367 INFO  [org.jboss.as.patching] (MSC service thread 1-8) WFLYPAT0050: WildFly cumulative patch ID is: base, one-off patches include: none
15:55:42,386 WARN  [org.jboss.as.domain.management.security] (MSC service thread 1-4) WFLYDM0111: Keystore /home/jkalina/wildfly/wildfly-core/build/target/wildfly-core-3.0.0.Alpha18-SNAPSHOT/standalone/configuration/application.keystore not found, it will be auto generated on first use with a self signed certificate for host localhost
15:55:42,466 INFO  [org.jboss.as.server] (ServerService Thread Pool -- 5) WFLYSRV0212: Resuming server
15:55:42,469 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: WildFly Core 3.0.0.Alpha18-SNAPSHOT ""Kenny"" started in 875ms - Started 37 of 46 services (17 services are lazy, passive or on-demand)
{code}
In this stage it froze and need to be interrupted by Ctrl+C.
{code}
Interrupted while waiting for embedded server to start
[disconnected /]
{code}",2017/02/24 10:00 AM
WFCORE-2320,"It is not possible to connect to previously shutdown domain controller that uses RBAC. If steps to reproduce are followed then the following output is given on slave:

{code}
[Host Controller] 10:47:57,754 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:48:01,756 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:48:10,918 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:48:26,026 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:48:41,047 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:48:56,059 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:49:11,106 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:49:26,133 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:49:41,148 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:49:56,180 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:50:11,202 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:50:26,215 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:50:41,230 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:50:56,264 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:50:56,273 WARN  [org.jboss.as.protocol.connection] (management task-1) WFLYPRT0018: No such request (15) associated with channel Channel ID ce1200c8 (outbound) of Remoting connection 6cf4e35b to /127.0.0.1:9999 of endpoint ""my-local-domain:MANAGEMENT"" <988a70d>
[Host Controller] 10:51:11,275 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:51:11,304 WARN  [org.jboss.as.protocol.connection] (management task-7) WFLYPRT0018: No such request (16) associated with channel Channel ID cabd84e6 (outbound) of Remoting connection 3083f850 to /127.0.0.1:9999 of endpoint ""my-local-domain:MANAGEMENT"" <988a70d>

(...)

Host Controller] 10:52:26,401 INFO  [org.jboss.as.host.controller] (Host Controller Service Threads - 8) WFLYHC0150: Trying to reconnect to master host controller.
[Host Controller] 10:52:40,194 ERROR [org.jboss.as.server] (Host Controller Service Threads - 7) WFLYSRV0216: Error cleaning obsolete content WFLYCTL0313: Unauthorized to execute operation 'read-attribute' for resource '[]' -- ""WFLYCTL0332: Permission denied"" 
[Host Controller] 10:52:40,196 ERROR [org.jboss.as.server] (Host Controller Service Threads - 7) WFLYSRV0216: Error cleaning obsolete content WFLYCTL0031: No operation named 'clean-obsolete-content' exists at address []
{code}

On master instance is given following output after a while:
{code}
[Host Controller] 10:52:59,560 ERROR [org.jboss.as.server] (Host Controller Service Threads - 31) WFLYSRV0216: Error cleaning obsolete content WFLYCTL0313: Unauthorized to execute operation 'read-attribute' for resource '[]' -- ""WFLYCTL0332: Permission denied"" 
[Host Controller] 10:52:59,564 ERROR [org.jboss.as.server] (Host Controller Service Threads - 31) WFLYSRV0216: Error cleaning obsolete content WFLYCTL0031: No operation named 'clean-obsolete-content' exists at address []
{code}

Once the slave instance has been shut down, it is not possible to start it again. See following output:
{code}
[Host Controller] 10:55:34,409 INFO  [org.jboss.as.remoting] (MSC service thread 1-2) WFLYRMT0001: Listening on 127.0.0.1:19999
[Host Controller] 10:55:34,701 WARN  [org.jboss.as.host.controller] (Controller Boot Thread) WFLYHC0001: Could not connect to remote domain controller remote://127.0.0.1:9999: 1-$-WFLYCTL0216: Management resource '[]' not found
[Host Controller] 	at org.jboss.as.host.controller.RemoteDomainConnection$HostControllerConnectRequest.handleRequest(RemoteDomainConnection.java:390)
[Host Controller] 	at org.jboss.as.protocol.mgmt.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:321)
[Host Controller] 	at org.jboss.as.protocol.mgmt.AbstractMessageHandler.handleRequest(AbstractMessageHandler.java:286)
[Host Controller] 	at org.jboss.as.protocol.mgmt.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:234)
[Host Controller] 	at org.jboss.as.protocol.mgmt.ManagementChannelReceiver.handleMessage(ManagementChannelReceiver.java:85)
[Host Controller] 	at org.jboss.remoting3.remote.RemoteConnectionChannel.lambda$handleMessageData$3(RemoteConnectionChannel.java:434)
[Host Controller] 	at org.jboss.remoting3.EndpointImpl$TrackingExecutor.lambda$execute$0(EndpointImpl.java:817)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
[Host Controller] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
[Host Controller] 	at java.lang.Thread.run(Thread.java:745)
[Host Controller] 
[Host Controller] 10:55:34,702 WARN  [org.jboss.as.host.controller] (Controller Boot Thread) WFLYHC0147: No domain controller discovery options remain.
[Host Controller] 10:55:34,702 ERROR [org.jboss.as.host.controller] (Controller Boot Thread) WFLYHC0002: Could not connect to master. Error was: java.lang.IllegalStateException: WFLYHC0120: Tried all domain controller discovery option(s) but unable to connect
[Host Controller] 10:55:34,707 FATAL [org.jboss.as.host.controller] (Controller Boot Thread) WFLYHC0178: Aborting with exit code 99
[Host Controller] 10:55:34,734 INFO  [org.jboss.as] (MSC service thread 1-4) WFLYSRV0050: JBoss EAP 7.1.0.Alpha1 (WildFly Core 3.0.0.Beta2-redhat-1) stopped in 16ms
{code}

Setting priority to blocker since this is a regression against 7.0.0.GA",2017/02/23 5:04 AM
WFCORE-2314,"Calling {{/core-service=management/security-realm=bbb:add(){allow-resource-service-restart=true)}} (notice incorrectly closed allow-resource-service-restart with "")"" instead of ""}"" results in 
{noformat}
[standalone@localhost:9990 /] /core-service=management/security-realm=bbb:add(){allow-resource-service-restart=true)
{
    ""outcome"" => ""failed"",
    ""failure-description"" => ""java.lang.IllegalArgumentException:null""
}
{noformat}
with this message in server.log:
{noformat}
14:20:12,440 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 10) WFLYCTL0403: Unexpected failure during execution of the following operation(s): [{
    ""address"" => [
        (""core-service"" => ""management""),
        (""security-realm"" => ""bbb"")
    ],
    ""operation"" => ""add"",
    ""operation-headers"" => {
        ""allow-resource-service-restart"" => ""true)"",
        ""caller-type"" => ""user"",
        ""access-mechanism"" => ""NATIVE""
    }
}]: java.lang.IllegalArgumentException
	at org.jboss.dmr.StringModelValue.asBoolean(StringModelValue.java:157)
	at org.jboss.dmr.ModelNode.asBoolean(ModelNode.java:267)
	at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:346)
	at org.jboss.as.controller.ModelControllerImpl.lambda$execute$1(ModelControllerImpl.java:240)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:193)
	at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:240)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.doExecute(ModelControllerClientOperationHandler.java:217)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler.access$400(ModelControllerClientOperationHandler.java:137)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:161)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1$1.run(ModelControllerClientOperationHandler.java:157)
	at org.wildfly.security.auth.server.SecurityIdentity.runAs(SecurityIdentity.java:212)
	at org.jboss.as.controller.AccessAuditContext.doAs(AccessAuditContext.java:185)
	at org.jboss.as.controller.remote.ModelControllerClientOperationHandler$ExecuteRequestHandler$1.execute(ModelControllerClientOperationHandler.java:157)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$1.doExecute(ManagementRequestContextImpl.java:70)
	at org.jboss.as.protocol.mgmt.ManagementRequestContextImpl$AsyncTaskRunner.run(ManagementRequestContextImpl.java:160)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
	at org.jboss.threads.JBossThread.run(JBossThread.java:320)

{noformat}

The IllegalArgumentException should point in the message what argument is incorrect and what is wrong. Printing only null doesn't help much.",2017/02/20 10:16 PM
WFCORE-2313,NoData,2017/02/20 9:40 PM
WFCORE-2309,"{{username-load}} attribute of legacy LDAP Realm stop to work. This attribute is used for assigning username from some LDAP entry attribute. In current behavior it seems that it tries to search user in LDAP through value obtained from entry 'username-load' attribute. See JBEAP-8969 for more details.



",2017/02/20 10:36 AM
WFCORE-2301,"Mount point not found exception raised by createTempFileWithAttributes on overlayfs [JDK-8165852], i.e.,

/opt/jboss/bin/jboss-cli.sh --file=/opt/jboss/jboss-config.cli

inside a Docker container running on overlayfs as storage driver

causes (full stack trace below):

{code:java}
java.io.IOException: Mount point not foundImage
    at sun.nio.fs.LinuxFileStore.findMountEntry(LinuxFileStore.java:91)
{code}

triggered by

{code:java}
    at org.jboss.as.controller.persistence.FilePersistenceUtils.createTempFileWithAttributes(FilePersistenceUtils.java:117)
    at org.jboss.as.controller.persistence.FilePersistenceUtils.writeToTempFile(FilePersistenceUtils.java:104)
{code}

due to OpenJDK bug/overlayfs bug.

We acknowledge that this is in fact an OpenJDK AND/OR overlayfs bug. However everything seems to run fine in WildFly except once the backup of the config is triggered, for example by using the cli. Hence WildFly is of limited functionality when the more and more popular overlayfs storage driver is used, and the WildFly team might be interested in providing a workaround on their side since there is no indication the OpenJDK bug will be promptly fixed. We are happy to help in any way, we are still trying to find a workaround on the Java or WildFly side; but we might need insights on why findMountEntry is invoked.

Full Stack Trace:

{code:java}
 java.io.IOException: Mount point not foundImage
         at sun.nio.fs.LinuxFileStore.findMountEntry(LinuxFileStore.java:91)
         at sun.nio.fs.UnixFileStore.<init>(UnixFileStore.java:65)
         at sun.nio.fs.LinuxFileStore.<init>(LinuxFileStore.java:44)
  at sun.nio.fs.LinuxFileSystemProvider.getFileStore(LinuxFileSystemProvider.java:51)
         at sun.nio.fs.LinuxFileSystemProvider.getFileStore(LinuxFileSystemProvider.java:39)
  at sun.nio.fs.UnixFileSystemProvider.getFileStore(UnixFileSystemProvider.java:368)
         at java.nio.file.Files.getFileStore(Files.java:1461)
         at org.jboss.as.controller.persistence.FilePersistenceUtils.getPosixAttributes(FilePersistenceUtils.java:129)
         at org.jboss.as.controller.persistence.FilePersistenceUtils.createTempFileWithAttributes(FilePersistenceUtils.java:117)
         at org.jboss.as.controller.persistence.FilePersistenceUtils.writeToTempFile(FilePersistenceUtils.java:104)
         at org.jboss.as.controller.persistence.ConfigurationFilePersistenceResource.doCommit(ConfigurationFilePersistenceResource.java:55)
         at org.jboss.as.controller.persistence.AbstractFilePersistenceResource.commit(AbstractFilePersistenceResource.java:58)
         at org.jboss.as.controller.ModelControllerImpl$4.commit(ModelControllerImpl.java:781)
         at org.jboss.as.controller.AbstractOperationContext.executeDoneStage(AbstractOperationContext.java:743)
         at org.jboss.as.controller.AbstractOperationContext.processStages(AbstractOperationContext.java:680)
         at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:370)
  at org.jboss.as.controller.OperationContextImpl.executeOperation(OperationContextImpl.java:1344)
  at org.jboss.as.controller.ModelControllerImpl.internalExecute(ModelControllerImpl.java:392)
  at org.jboss.as.controller.ModelControllerImpl.execute(ModelControllerImpl.java:204)
  at org.jboss.as.controller.ModelControllerImpl$3.execute(ModelControllerImpl.java:659)
  at org.jboss.as.controller.ModelControllerImpl$3.execute(ModelControllerImpl.java:649)
  at org.jboss.as.controller.client.helpers.DelegatingModelControllerClient.execute(DelegatingModelControllerClient.java:63)
  at org.jboss.as.cli.embedded.ThreadContextsModelControllerClient.execute(ThreadContextsModelControllerClient.java:59)
  at org.jboss.as.cli.handlers.batch.BatchRunHandler.doHandle(BatchRunHandler.java:91)
  at org.jboss.as.cli.handlers.CommandHandlerWithHelp.handle(CommandHandlerWithHelp.java:88)
  at org.jboss.as.cli.impl.CommandContextImpl.handle(CommandContextImpl.java:776)
  at org.jboss.as.cli.impl.CommandContextImpl.handleSafe(CommandContextImpl.java:799)
  at org.jboss.as.cli.impl.CliLauncher.processFile(CliLauncher.java:334)
  at org.jboss.as.cli.impl.CliLauncher.main(CliLauncher.java:262)
  at org.jboss.as.cli.CommandLineMain.main(CommandLineMain.java:45)
  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
  at java.lang.reflect.Method.invoke(Method.java:498)
  at org.jboss.modules.Module.run(Module.java:329)
  at org.jboss.modules.Main.main(Main.java:507)

{code}


Java Bug Overview:

https://bugs.openjdk.java.net/browse/JDK-8165852

http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/sun/nio/fs/LinuxFileStore.java#91

Wildfly Stack Overflow issue, not solved:

https://stackoverflow.com/questions/41022393/mount-point-not-found

Background Info:

http://mail.openjdk.java.net/pipermail/nio-dev/2016-October/003915.html

A) chroot environment [1]
B) Docker container with overlay and overlay2 storage drivers [2]
C) btrfs file system with an unmounted sub-volume [2]

[1] https://bugs.openjdk.java.net/browse/JDK-8165323 - cannot get FileStore in chroot environment
[2] https://bugs.openjdk.java.net/browse/JDK-8165852 - cannot get FileStore for a file in overlayfs in Docker

Docker file system/storage driver:

https://docs.docker.com/engine/userguide/storagedriver/selectadriver/)

Yum yum-plugin-ovl, similar problem:

https://github.com/CentOS/sig-cloud-instance-images/issues/15",2017/02/15 6:02 PM
WFCORE-2285,NoData,2017/02/10 8:34 AM
WFCORE-2284,"While working on https://github.com/wildfly/wildfly-core/pull/2163 Paul Ferraro noticed that HostSpecifiedPathsTestCase was creating a Resource for which there was no corresponding MRR, which his fix then had to handle. Doing that is wrong so I went to clean it up and found that the tests in this package are using incorrect model structures. So I'll clean that up.",2017/02/09 6:20 PM
WFCORE-2279,"Normally, the read resource operation returns children of a given type in their correct order. However, if the child type has overrides (e.g. type=foo overrides type=*), the read resource operation returns the override children first, followed by the wildcard children in order.  Order should be respected for all children of a given type.",2017/02/08 5:47 PM
WFCORE-2265,"The problematic logic looks to in:
org.jboss.as.subsystem.test.TransformationUtils.modelToResource(...), which will copy resource definition with wildcard overrides into the model twice.",2017/02/04 9:29 PM
WFCORE-2259,"When {{embed-server}} command is used more times in the CLI and a custom {{JBOSS_MODULEPATH}} is configured, then only the first server start uses the correct module path.
The subsequent `embed-server` call results in error:
{code}
Cannot start embedded server: WFLYEMB0022: Cannot invoke 'start' on embedded process: WFLYSRV0118: Determined modules directory does not exist: /tmp/jboss-eap-7.0-no-modules/modules
{code}

Using the  {{JBOSS_MODULEPATH}} environment variable is documented in https://access.redhat.com/documentation/en/red-hat-jboss-enterprise-application-platform/7.0/single/configuration-guide/#define_an_external_jboss_eap_module_directory",2017/02/02 4:31 AM
WFCORE-2258,"In case of securing management interface with ldap in security realm. When nonexistent user is provided, wildfly answers with {{500}} http status code. It is different behaviour compared to wildfly 10.1, which returns {{401}}. I think http status code {{401}} is proper in this situation, because it is client fault (e.g. typo in username) and can be repaired on client side.

{code:title=server.log}
10:49:18,745 TRACE [org.wildfly.security] (management task-10) Handling MechanismInformationCallback
10:49:18,746 TRACE [org.wildfly.security] (management task-10) Handling AvailableRealmsCallback: realms = [ldap-realm]
10:49:18,746 TRACE [org.wildfly.security] (management task-10) Handling RealmCallback: selected = [ldap-realm]
10:49:18,746 TRACE [org.wildfly.security] (management task-10) Handling NameCallback: authenticationName = anil
10:49:18,746 TRACE [org.wildfly.security] (management task-10) Name assigning: [anil], pre-realm rewritten: [anil], realm name: [PLAIN], post realm rewritten: [anil], realm rewritten: [anil]
10:49:18,746 TRACE [org.jboss.as.domain.management.security] (management task-10) Non caching search for 'anil'
10:49:18,746 TRACE [org.jboss.as.domain.management.security] (management task-10) Performing single level search
10:49:18,746 TRACE [org.jboss.as.domain.management.security] (management task-10) Searching for user 'anil' using filter '(uid={0})'.
10:49:18,746 TRACE [org.jboss.as.domain.management.security] (management task-10) Connecting to LDAP with properties ({java.naming.factory.initial=com.sun.jndi.ldap.LdapCtxFactory, java.naming.provider.url=ldap://localhost.localdomain:10389, java.naming.security.principal=uid=admin,ou=system, java.naming.security.credentials=***, java.naming.referral=ignore})
10:49:18,749 WARN  [org.apache.directory.server.core.api.interceptor.context.FilteringOperationContext] (pool-7-thread-1) Requested attribute dn does not exist in the schema, it will be ignored
10:49:18,750 TRACE [org.jboss.as.domain.management.security] (management task-10) User 'anil' not found in directory.
{code} 
",2017/02/02 2:14 AM
WFCORE-2253,"An AD with a default value does not require the user to set it, so configuring it with required = true fka allowNull = false is incorrect. WFCORE-2252 proposes to reject these. This is to clean them up first. 

Note that for any such attributes, if they existed in a previous release a transformer must be written to go along with a change to required=false. Even though they had a default before, the required=true setting made it as if it didn't exist, so this change is the same as adding a default
",2017/01/31 7:17 PM
WFCORE-2251,"ObjectTypeValidator is incorrectly implementing AllowedValuesValidator and should not implement it at all.

The values returned from an AllowedValuesValidator are meant to be an enumeration of the *complete* legal values for the attribute. ObjectTypeValidator is simply returning the legal keys for the fields in the object, which are not complete legal values.

The result of this is any attribute that uses this validator (which all complex objects probably do) will report bogus and unnecessary data in the read-resource-description ""allowed-values"" metadata. Unnecessary because the description of the attribute already includes full details of the fields via the ""value-type"" metadata.

I'm classifying this as minor because the bogus metadata likely does no harm.",2017/01/31 2:03 PM
WFCORE-2250,"2 Threads. Thread1 is polling Aesh console status for its running state, as soon as the state is switched to !running, the CLI exists. 
Ctrl-C is sent to CLI, Aesh command Thread initiates a shutdown, the CLI calls console.stop(). Aesh change running state to be false THEN does some cleanup. If thread1 is scheduled, then CLI exists although cleanup has not yet been operated. leaving an insane TTY.

The fix is to switch to Aesh 0.66.15 in which this bug has been fixed.
",2017/01/31 12:32 PM
WFCORE-2249,"This in ObjectTypeValidator is wrong:

{code}


    @Override
    public void validateParameter(final String parameterName, final ModelNode value) throws OperationFailedException {
        super.validateParameter(parameterName, value);
        if (value.isDefined()) {
            for (String key : value.keys()) {
                if (allowedValues.containsKey(key)) {
                    allowedValues.get(key).getValidator().validateParameter(key, value.get(key));
                } else {
                    throw ROOT_LOGGER.invalidKeyForObjectType(key, parameterName);
                }
            }
        }
    }
{code}

1) It only iterates over the keys in 'value' so if value is missing any required fields that isn't detected.
2) It's not really appropriate to reject keys that are not part of the definition. The management code is meant to be forgiving in such cases.

For now I think I'll just focus on #1. It's debatable whether being forgiving is really ideal in general, and since this particular bit of unforgivingness has been around since at least 2012 I think I'll leave it alone.",2017/01/31 12:10 PM
WFCORE-2248,"*Description of problem:*
DeploymentTestCase fails intermittently

*How reproducible:*
2% on RHEL
15% on slower IPv6 machines

*Actual results:*
StackTrace:
{noformat}
org.junit.ComparisonFailure: service has the wrong value expected:<is [replaced]> but was:<is [new]>
	at org.junit.Assert.assertEquals(Assert.java:115)
	at org.jboss.as.test.deployment.trivial.ServiceActivatorDeploymentUtil.validateProperties(ServiceActivatorDeploymentUtil.java:126)
	at org.jboss.as.test.deployment.trivial.ServiceActivatorDeploymentUtil.validateProperties(ServiceActivatorDeploymentUtil.java:111)
	at org.wildfly.core.test.standalone.mgmt.api.DeploymentTestCase.testDeployments(DeploymentTestCase.java:872)
	at org.wildfly.core.test.standalone.mgmt.api.DeploymentTestCase.testFilesystemDeployment_Auto(DeploymentTestCase.java:453)
{noformat}
Standard output:
{noformat}
&amp#27;[0m13:28:46,781 INFO  [org.jboss.as.server.deployment.scanner] (MSC service thread 1-1) WFLYDS0013: Started FileSystemDeploymentService for directory /mnt/hudson_workspace/workspace/eap-7x-as-testsuite-test-core-rhel/b7cade8d/testsuite/standalone/target/auto-deployments
&amp#27;[0m&amp#27;[0m13:28:46,791 INFO  [org.jboss.as.repository] (DeploymentScanner-threads - 2) WFLYDR0001: Content added at location /mnt/hudson_workspace/workspace/eap-7x-as-testsuite-test-core-rhel/b7cade8d/testsuite/standalone/target/wildfly-core/standalone/data/content/e0/afac1c502e481badbe10f16d5b2a18ef62fe18/content
&amp#27;[0m&amp#27;[0m13:28:46,793 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) WFLYSRV0027: Starting deployment of ""test-deployment.jar"" (runtime-name: ""test-deployment.jar"")
&amp#27;[0m&amp#27;[0m13:28:46,800 INFO  [stdout] (MSC service thread 1-1) Properties found
&amp#27;[0m&amp#27;[0m13:28:46,800 INFO  [stdout] (MSC service thread 1-1) Setting service to is new
&amp#27;[0m&amp#27;[0m13:28:46,803 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) WFLYSRV0010: Deployed ""test-deployment.jar"" (runtime-name : ""test-deployment.jar"")
&amp#27;[0m&amp#27;[0m13:29:07,226 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) WFLYSRV0028: Stopped deployment test-deployment.jar (runtime-name: test-deployment.jar) in 0ms
&amp#27;[0m&amp#27;[0m13:29:07,229 INFO  [org.jboss.as.repository] (management-handler-thread - 4) WFLYDR0002: Content removed from location /mnt/hudson_workspace/workspace/eap-7x-as-testsuite-test-core-rhel/b7cade8d/testsuite/standalone/target/wildfly-core/standalone/data/content/e0/afac1c502e481badbe10f16d5b2a18ef62fe18/content
&amp#27;[0m&amp#27;[0m13:29:07,229 INFO  [org.jboss.as.server] (management-handler-thread - 4) WFLYSRV0009: Undeployed ""test-deployment.jar"" (runtime-name: ""test-deployment.jar"")
&amp#27;[0m
{noformat}

*Expected results:*
No errors",2017/01/31 10:06 AM
WFCORE-2398,"Accessing management interface secured by Kerberos + TLS causes EAP requests from KDC ticket HTTPS/localhost. Which was not necessary in EAP 7.0 and it worked fine with HTTP/localhost service name

{code:title=server.log}
14:20:19,321 TRACE [org.jboss.as.domain.management.security] (management task-7) No mapping for name 'https/localhost.localdomain' to KeytabService, attempting to use host only match.
14:20:19,322 TRACE [org.jboss.as.domain.management.security] (management task-7) Selected KeytabService with principal 'HTTP/localhost.localdomain@JBOSS.ORG' for host 'localhost.localdomain'
14:20:19,322 INFO  [stdout] (management task-7) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
14:20:19,323 INFO  [stdout] (management task-7) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
14:20:19,323 INFO  [stdout] (management task-7) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
14:20:19,323 INFO  [stdout] (management task-7) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
14:20:19,524 WARN  [org.apache.directory.server.protocol.shared.kerberos.StoreUtils] (NioDatagramAcceptor-3) No server entry found for kerberos principal name HTTPS/localhost.localdomain@JBOSS.ORG
14:20:19,524 WARN  [org.apache.directory.server.KERBEROS_LOG] (NioDatagramAcceptor-3) No server entry found for kerberos principal name HTTPS/localhost.localdomain@JBOSS.ORG
14:20:19,524 WARN  [org.apache.directory.server.kerberos.protocol.KerberosProtocolHandler] (NioDatagramAcceptor-3) Server not found in Kerberos database (7)
14:20:19,525 WARN  [org.apache.directory.server.KERBEROS_LOG] (NioDatagramAcceptor-3) Server not found in Kerberos database (7)
14:20:19,528 WARN  [org.apache.http.impl.auth.HttpAuthenticator] (main) NEGOTIATE authentication error: No valid credentials provided (Mechanism level: No valid credentials provided (Mechanism level: Server not found in Kerberos database (7) - Server not found in Kerberos database))
14:20:19,532 TRACE [org.jboss.as.domain.management.security] (management task-9) No mapping for name 'https/localhost.localdomain' to KeytabService, attempting to use host only match.
14:20:19,532 TRACE [org.jboss.as.domain.management.security] (management task-9) Selected KeytabService with principal 'HTTP/localhost.localdomain@JBOSS.ORG' for host 'localhost.localdomain'
14:20:19,533 INFO  [stdout] (management task-9) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
14:20:19,533 INFO  [stdout] (management task-9) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
14:20:19,533 INFO  [stdout] (management task-9) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
14:20:19,533 INFO  [stdout] (management task-9) Found KeyTab /home/mchoma/workspace/git-repositories/tests-ldap-kerberos-eap7/eap7/target/krb/krb.2269988831769483313.keytab for HTTP/localhost.localdomain@JBOSS.ORG
		[Krb5LoginModule]: Entering logout
		[Krb5LoginModule]: logged out Subject
{code}

Also see network dump krb_https_management.pcap in attachement, where TGS-REQ for HTTPS/localhost is captured.
",2017/01/30 8:38 AM
WFCORE-2241,The CLI class offline CommandContext is never terminated. This makes the CommandContext to be referenced from Shutdown Hook and never cleaned.,2017/01/30 4:41 AM
WFCORE-2235,"InterdependentDeploymentTestCase tests deployment handling of a set of interdependent deployments, where some of the dependencies are optional.

The test intermittently fails due to a ModuleLoadException while deploying one of the modules:

https://ci.wildfly.org/viewLog.html?buildId=42957&buildTypeId=WildFlyCore_PullRequest

The most notable bit of info in the log is:

{code}
17:32:08,639 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-2) MSC000001: Failed to start service jboss.module.service.""deployment.interrelated-c.jar"".main: org.jboss.msc.service.StartException in service jboss.module.service.""deployment.interrelated-c.jar"".main: WFLYSRV0179: Failed to load module: deployment.interrelated-c.jar
    at org.jboss.as.server.moduleservice.ModuleLoadService.start(ModuleLoadService.java:91)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:2032)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1955)
    at org.jboss.msc.service.MSCExecutor$1.run(MSCExecutor.java:77)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
    at java.lang.Thread.run(Thread.java:745)
Caused by: org.jboss.modules.ModuleNotFoundException: deployment.interrelated-c.jar
    at org.jboss.modules.ModuleLoader$FutureModule.getModule(ModuleLoader.java:834)
    at org.jboss.modules.ModuleLoader.loadModuleLocal(ModuleLoader.java:472)
    at org.jboss.modules.ModuleLoader.loadModuleLocal(ModuleLoader.java:457)
    at org.jboss.modules.ModuleLoader.preloadModule(ModuleLoader.java:370)
    at org.jboss.as.server.moduleservice.ServiceModuleLoader.preloadModule(ServiceModuleLoader.java:147)
    at org.jboss.modules.ModuleLoader.preloadModule(ModuleLoader.java:387)
    at org.jboss.modules.ModuleLoader.loadModule(ModuleLoader.java:282)
    at org.jboss.modules.ModuleLoader.loadModule(ModuleLoader.java:270)
    at org.jboss.as.server.moduleservice.ModuleLoadService.start(ModuleLoadService.java:68)
    ... 6 more
{code}

The interrelated-c.jar deployment depends (*not optionally*) on interrelated-a.jar.The failure occurs during execution of a management op that redeploys interrelated-a.jar. FWIW, another deployment in the set, interrelated-f.jar, does depend optionally on interrelated-c.jar.

The full stdout output for the failed test in the above linked CI run also includes a dump of all MSC services following the failure. Note though that the failure does not result in MSC not obtaining stability. Inability to reach stability was the initial problem that led to the introduction of this test (see https://github.com/wildfly/wildfly-core/pull/2099.)",2017/01/25 12:38 PM
WFCORE-2351,"There stuck some required service after unsuccessful command for adding CredentialStore with wrong filled relative-to attribute.

*Command with wrong filled relative-to attribute* 
{code}
/subsystem=elytron/credential-store=CredStore108:add(uri=""cr-store://test/cs108.jceks?create.storage=true"",  credential-reference={clear-text=pass123}, relative-to=non.exist.path.resource)
{code}
*You can see this log.*
Especially information about New missing/unsatisfied dependencies:is important and it wouldn't be there.
{code}
16:54:18,809 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 8) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""subsystem"" => ""elytron""),
    (""credential-store"" => ""CredStore108"")
]) - failure description: {
    ""WFLYCTL0412: Required services that are not installed:"" => [""jboss.server.path.\""non.exist.path.resource\""""],
    ""WFLYCTL0180: Services with missing/unavailable dependencies"" => [""org.wildfly.security.credential-store.CredStore108 is missing [jboss.server.path.\""non.exist.path.resource\""]""]
}
16:54:18,810 INFO  [org.jboss.as.controller] (management-handler-thread - 8) WFLYCTL0183: Service status report
WFLYCTL0184:    New missing/unsatisfied dependencies:
      service jboss.server.path.""non.exist.path.resource"" (missing) dependents: [service org.wildfly.security.credential-store.CredStore108] 
{code}

*Now we try process same command without relative-to attribute*
{code}
/subsystem=elytron/credential-store=CredStore108:add(uri=""cr-store://test/cs108.jceks?create.storage=true"",  credential-reference={clear-text=pass123})   
{code}
*Result is success but we can notice this in log:*
{code}
16:55:33,093 INFO  [org.jboss.as.controller] (management-handler-thread - 10) WFLYCTL0183: Service status report
WFLYCTL0185:    Newly corrected services:
      service jboss.server.path.""non.exist.path.resource"" (no longer required)
{code}



",2017/01/25 11:10 AM
WFCORE-2230,Console is not able to connect to management interface.,2017/01/24 3:33 PM
WFCORE-2242,"When we use EAP with Elytron (standalone-elytron.xml configuration file) we aren't able to logout from Web console.

With legacy security realms everything is ok.

*How to reproduce*
* start EAP *standalone.sh -c=standalone-elytron.xml*
* log in to Web console on http://localhost:9990
* invoke logout
You will get this url http://localhost:9990/logout
{code}
404 - Not Found
{code}",2017/01/23 6:39 AM
WFCORE-2225,"It looks like the AS7-6223 functionality was dropped in the move to Remoting 5:

https://github.com/wildfly/wildfly-core/blame/master/protocol/src/main/java/org/jboss/as/protocol/ProtocolConnectionUtils.java#L166

Something needs to be restored or we have a regression.",2017/01/20 4:51 PM
WFCORE-2224,"When enabling RBAC ({{/core-service=management/access=authorization:write-attribute(name=provider, value=rbac)}}), it is not possible to add role mappings:
{code}
[domain@localhost:9990 /] /core-service=management/access=authorization/role-mapping=Maintainer:add()
{
    ""outcome"" => ""failed"",
    ""result"" => undefined,
    ""failure-description"" => {""WFLYDC0074: Operation failed or was rolled back on all servers. Server failures:"" => {""server-group"" => {""main-server-group"" => {""host"" => {""master"" => {
        ""server-one"" => ""WFLYCTL0216: Management resource '[
    (\""core-service\"" => \""management\""),
    (\""access\"" => \""authorization\""),
    (\""role-mapping\"" => \""Maintainer\"")
]' not found"",
        ""server-two"" => ""WFLYCTL0216: Management resource '[
    (\""core-service\"" => \""management\""),
    (\""access\"" => \""authorization\""),
    (\""role-mapping\"" => \""Maintainer\"")
]' not found""
    }}}}}},
    ""rolled-back"" => true,
    ""server-groups"" => {""main-server-group"" => {""host"" => {""master"" => {
        ""server-one"" => {""response"" => {
            ""outcome"" => ""failed"",
            ""failure-description"" => ""WFLYCTL0216: Management resource '[
    (\""core-service\"" => \""management\""),
    (\""access\"" => \""authorization\""),
    (\""role-mapping\"" => \""Maintainer\"")
]' not found"",
            ""rolled-back"" => true
        }},
        ""server-two"" => {""response"" => {
            ""outcome"" => ""failed"",
            ""failure-description"" => ""WFLYCTL0216: Management resource '[
    (\""core-service\"" => \""management\""),
    (\""access\"" => \""authorization\""),
    (\""role-mapping\"" => \""Maintainer\"")
]' not found"",
            ""rolled-back"" => true
        }}
    }}}}
}
{code}",2017/01/20 12:39 PM
WFCORE-2223,"When {{embed-server}} command is used more times in the CLI and a custom {{JBOSS_MODULEPATH}} is configured, then only the first server start uses the correct module path.
The subsequent `embed-server` call results in error:
{code}
Cannot start embedded server: WFLYEMB0022: Cannot invoke 'start' on embedded process: WFLYSRV0118: Determined modules directory does not exist: /tmp/jboss-eap-7.0-no-modules/modules
{code}

Using the  {{JBOSS_MODULEPATH}} environment variable is documented in https://access.redhat.com/documentation/en/red-hat-jboss-enterprise-application-platform/7.0/single/configuration-guide/#define_an_external_jboss_eap_module_directory",2017/01/20 11:18 AM
WFCORE-2216,"reload command should manage to reconnect to a server reconfigured with https management interface.
",2017/01/19 11:33 AM
WFCORE-2215,"The following failure is produced when trying to force replacement of deployments in JBoss EAP 7.1.0.DR10 with high level command:

{code}[domain@localhost:9990 /] deploy ~/testing/eap/7.0.0/jboss-eap-7.0.0.GA-quickstarts/helloworld/target/jboss-helloworld.war --server-groups=main-server-group
[domain@localhost:9990 /] deploy ~/testing/eap/7.0.0/jboss-eap-7.0.0.GA-quickstarts/helloworld/target/jboss-helloworld.war --force                          
{""host-failure-descriptions"" => {""hc1"" => ""WFLYDC0041: A slave domain controller cannot accept deployment content uploads""}}
{code}

This operation is referenced in community documentation: [Application deployment|https://docs.jboss.org/author/display/WFLY/Application+deployment]
This operation works with JBoss EAP 7.0 and 6.4.
",2017/01/19 11:29 AM
WFCORE-2210,Marshalling credential-store (ObjectType) attributes wrongly uses custom attribute marshaller.,2017/01/18 4:13 PM
WFCORE-2203,"Outcome of successful removal of a server controlled by a slave HC in managed domain with multiple hosts lists outcomes of all the steps, polluting the CLI:
{code}    [domain@localhost:9990 /] /host=msimka-t450.brq.redhat.com/server-config=server-one:remove
    {
        ""outcome"" => ""success"",
        ""result"" => {
            ""step-1"" => {""outcome"" => ""success""},
            ""step-2"" => {""outcome"" => ""success""},
            ""step-3"" => {""outcome"" => ""success""},
            ""step-4"" => {""outcome"" => ""success""},
            ""step-5"" => {""outcome"" => ""success""},
            ""step-6"" => {""outcome"" => ""success""},
            ""step-7"" => {""outcome"" => ""success""},
            ""step-8"" => {""outcome"" => ""success""},
            ""step-9"" => {""outcome"" => ""success""},
            ""step-10"" => {""outcome"" => ""success""},
            ""step-11"" => {""outcome"" => ""success""},
            ""step-12"" => {""outcome"" => ""success""},
            ""step-13"" => {""outcome"" => ""success""},
            ""step-14"" => {""outcome"" => ""success""},
            ""step-15"" => {""outcome"" => ""success""},
            ""step-16"" => {""outcome"" => ""success""},
            ""step-17"" => {""outcome"" => ""success""},
            ""step-18"" => {""outcome"" => ""success""},
            ""step-19"" => {""outcome"" => ""success""},
            ""step-20"" => {""outcome"" => ""success""},
            ""step-21"" => {""outcome"" => ""success""},
            ""step-22"" => {""outcome"" => ""success""},
            ""step-23"" => {""outcome"" => ""success""},
            ""step-24"" => {""outcome"" => ""success""},
            ""step-25"" => {""outcome"" => ""success""},
            ""step-26"" => {""outcome"" => ""success""},
            ""step-27"" => {""outcome"" => ""success""},
            ""step-28"" => {""outcome"" => ""success""},
            ""step-29"" => {""outcome"" => ""success""},
            ""step-30"" => {""outcome"" => ""success""},
            ""step-31"" => {""outcome"" => ""success""},
            ""step-32"" => {""outcome"" => ""success""},
            ""step-33"" => {""outcome"" => ""success""},
            ""step-34"" => {""outcome"" => ""success""},
            ""step-35"" => {""outcome"" => ""success""},
            ""step-36"" => {
                ""outcome"" => ""success"",
                ""result"" => undefined
            },
            ""step-37"" => {""outcome"" => ""success""},
            ""step-38"" => {""outcome"" => ""success""},
            ""step-39"" => {""outcome"" => ""success""},
            ""step-40"" => {""outcome"" => ""success""},
            ""step-41"" => {""outcome"" => ""success""},
            ""step-42"" => {""outcome"" => ""success""},
            ""step-43"" => {""outcome"" => ""success""},
            ""step-44"" => {""outcome"" => ""success""},
            ""step-45"" => {""outcome"" => ""success""},
            ""step-46"" => {""outcome"" => ""success""},
            ""step-47"" => {""outcome"" => ""success""},
            ""step-48"" => {""outcome"" => ""success""},
            ""step-49"" => {""outcome"" => ""success""},
            ""step-50"" => {""outcome"" => ""success""},
            ""step-51"" => {""outcome"" => ""success""},
            ""step-52"" => {""outcome"" => ""success""},
            ""step-53"" => {""outcome"" => ""success""},
            ""step-54"" => {""outcome"" => ""success""},
            ""step-55"" => {""outcome"" => ""success""},
            ""step-56"" => {""outcome"" => ""success""},
            ""step-57"" => {""outcome"" => ""success""},
            ""step-58"" => {""outcome"" => ""success""},
            ""step-59"" => {""outcome"" => ""success""},
            ""step-60"" => {""outcome"" => ""success""},
            ""step-61"" => {""outcome"" => ""success""},
            ""step-62"" => {""outcome"" => ""success""},
            ""step-63"" => {""outcome"" => ""success""},
            ""step-64"" => {""outcome"" => ""success""},
            ""step-65"" => {""outcome"" => ""success""},
            ""step-66"" => {""outcome"" => ""success""},
            ""step-67"" => {""outcome"" => ""success""},
            ""step-68"" => {""outcome"" => ""success""},
            ""step-69"" => {""outcome"" => ""success""},
            ""step-70"" => {""outcome"" => ""success""},
            ""step-71"" => {""outcome"" => ""success""},
            ""step-72"" => {""outcome"" => ""success""},
            ""step-73"" => {""outcome"" => ""success""},
            ""step-74"" => {""outcome"" => ""success""},
            ""step-75"" => {""outcome"" => ""success""},
            ""step-76"" => {""outcome"" => ""success""},
            ""step-77"" => {""outcome"" => ""success""},
            ""step-78"" => {""outcome"" => ""success""},
            ""step-79"" => {""outcome"" => ""success""},
            ""step-80"" => {""outcome"" => ""success""},
            ""step-81"" => {""outcome"" => ""success""},
            ""step-82"" => {""outcome"" => ""success""},
            ""step-83"" => {""outcome"" => ""success""},
            ""step-84"" => {""outcome"" => ""success""},
            ""step-85"" => {""outcome"" => ""success""},
            ""step-86"" => {""outcome"" => ""success""},
            ""step-87"" => {""outcome"" => ""success""},
            ""step-88"" => {""outcome"" => ""success""},
            ""step-89"" => {""outcome"" => ""success""},
            ""step-90"" => {""outcome"" => ""success""},
            ""step-91"" => {""outcome"" => ""success""},
            ""step-92"" => {""outcome"" => ""success""},
            ""step-93"" => {""outcome"" => ""success""},
            ""step-94"" => {""outcome"" => ""success""},
            ""step-95"" => {""outcome"" => ""success""},
            ""step-96"" => {""outcome"" => ""success""},
            ""step-97"" => {""outcome"" => ""success""},
            ""step-98"" => {""outcome"" => ""success""},
            ""step-99"" => {""outcome"" => ""success""},
            ""step-100"" => {""outcome"" => ""success""},
            ""step-101"" => {""outcome"" => ""success""},
            ""step-102"" => {""outcome"" => ""success""},
            ""step-103"" => {""outcome"" => ""success""},
            ""step-104"" => {""outcome"" => ""success""},
            ""step-105"" => {""outcome"" => ""success""},
            ""step-106"" => {""outcome"" => ""success""},
            ""step-107"" => {""outcome"" => ""success""},
            ""step-108"" => {""outcome"" => ""success""},
            ""step-109"" => {""outcome"" => ""success""},
            ""step-110"" => {""outcome"" => ""success""},
            ""step-111"" => {""outcome"" => ""success""},
            ""step-112"" => {""outcome"" => ""success""},
            ""step-113"" => {""outcome"" => ""success""},
            ""step-114"" => {""outcome"" => ""success""},
            ""step-115"" => {""outcome"" => ""success""},
            ""step-116"" => {""outcome"" => ""success""},
            ""step-117"" => {""outcome"" => ""success""},
            ""step-118"" => {""outcome"" => ""success""},
            ""step-119"" => {""outcome"" => ""success""},
            ""step-120"" => {""outcome"" => ""success""},
            ""step-121"" => {""outcome"" => ""success""},
            ""step-122"" => {""outcome"" => ""success""},
            ""step-123"" => {""outcome"" => ""success""},
            ""step-124"" => {""outcome"" => ""success""},
            ""step-125"" => {""outcome"" => ""success""},
            ""step-126"" => {""outcome"" => ""success""},
            ""step-127"" => {""outcome"" => ""success""},
            ""step-128"" => {""outcome"" => ""success""},
            ""step-129"" => {""outcome"" => ""success""},
            ""step-130"" => {""outcome"" => ""success""},
            ""step-131"" => {""outcome"" => ""success""},
            ""step-132"" => {""outcome"" => ""success""},
            ""step-133"" => {""outcome"" => ""success""},
            ""step-134"" => {""outcome"" => ""success""},
            ""step-135"" => {""outcome"" => ""success""},
            ""step-136"" => {""outcome"" => ""success""},
            ""step-137"" => {""outcome"" => ""success""},
            ""step-138"" => {""outcome"" => ""success""},
            ""step-139"" => {""outcome"" => ""success""},
            ""step-140"" => {""outcome"" => ""success""},
            ""step-141"" => {""outcome"" => ""success""},
            ""step-142"" => {""outcome"" => ""success""},
            ""step-143"" => {""outcome"" => ""success""},
            ""step-144"" => {""outcome"" => ""success""},
            ""step-145"" => {""outcome"" => ""success""},
            ""step-146"" => {""outcome"" => ""success""},
            ""step-147"" => {""outcome"" => ""success""},
            ""step-148"" => {""outcome"" => ""success""},
            ""step-149"" => {""outcome"" => ""success""},
            ""step-150"" => {""outcome"" => ""success""},
            ""step-151"" => {""outcome"" => ""success""},
            ""step-152"" => {""outcome"" => ""success""},
            ""step-153"" => {""outcome"" => ""success""},
            ""step-154"" => {""outcome"" => ""success""},
            ""step-155"" => {""outcome"" => ""success""},
            ""step-156"" => {""outcome"" => ""success""},
            ""step-157"" => {""outcome"" => ""success""},
            ""step-158"" => {""outcome"" => ""success""},
            ""step-159"" => {""outcome"" => ""success""},
            ""step-160"" => {""outcome"" => ""success""},
            ""step-161"" => {""outcome"" => ""success""},
            ""step-162"" => {""outcome"" => ""success""},
            ""step-163"" => {""outcome"" => ""success""},
            ""step-164"" => {""outcome"" => ""success""},
            ""step-165"" => {""outcome"" => ""success""},
            ""step-166"" => {""outcome"" => ""success""},
            ""step-167"" => {""outcome"" => ""success""},
            ""step-168"" => {""outcome"" => ""success""},
            ""step-169"" => {""outcome"" => ""success""},
            ""step-170"" => {""outcome"" => ""success""},
            ""step-171"" => {""outcome"" => ""success""},
            ""step-172"" => {""outcome"" => ""success""},
            ""step-173"" => {""outcome"" => ""success""},
            ""step-174"" => {""outcome"" => ""success""},
            ""step-175"" => {""outcome"" => ""success""},
            ""step-176"" => {""outcome"" => ""success""},
            ""step-177"" => {""outcome"" => ""success""},
            ""step-178"" => {""outcome"" => ""success""},
            ""step-179"" => {""outcome"" => ""success""},
            ""step-180"" => {""outcome"" => ""success""},
            ""step-181"" => {""outcome"" => ""success""},
            ""step-182"" => {""outcome"" => ""success""},
            ""step-183"" => {""outcome"" => ""success""},
            ""step-184"" => {""outcome"" => ""success""},
            ""step-185"" => {""outcome"" => ""success""},
            ""step-186"" => {""outcome"" => ""success""},
            ""step-187"" => {""outcome"" => ""success""},
            ""step-188"" => {""outcome"" => ""success""},
            ""step-189"" => {""outcome"" => ""success""},
            ""step-190"" => {""outcome"" => ""success""},
            ""step-191"" => {""outcome"" => ""success""},
            ""step-192"" => {""outcome"" => ""success""},
            ""step-193"" => {""outcome"" => ""success""},
            ""step-194"" => {""outcome"" => ""success""},
            ""step-195"" => {""outcome"" => ""success""},
            ""step-196"" => {""outcome"" => ""success""},
            ""step-197"" => {""outcome"" => ""success""},
            ""step-198"" => {""outcome"" => ""success""},
            ""step-199"" => {""outcome"" => ""success""},
            ""step-200"" => {""outcome"" => ""success""},
            ""step-201"" => {""outcome"" => ""success""},
            ""step-202"" => {""outcome"" => ""success""},
            ""step-203"" => {""outcome"" => ""success""},
            ""step-204"" => {""outcome"" => ""success""},
            ""step-205"" => {""outcome"" => ""success""},
            ""step-206"" => {""outcome"" => ""success""},
            ""step-207"" => {""outcome"" => ""success""},
            ""step-208"" => {""outcome"" => ""success""},
            ""step-209"" => {""outcome"" => ""success""},
            ""step-210"" => {""outcome"" => ""success""},
            ""step-211"" => {""outcome"" => ""success""},
            ""step-212"" => {""outcome"" => ""success""},
            ""step-213"" => {""outcome"" => ""success""},
            ""step-214"" => {""outcome"" => ""success""},
            ""step-215"" => {""outcome"" => ""success""},
            ""step-216"" => {""outcome"" => ""success""},
            ""step-217"" => {""outcome"" => ""success""},
            ""step-218"" => {""outcome"" => ""success""},
            ""step-219"" => {""outcome"" => ""success""},
            ""step-220"" => {""outcome"" => ""success""},
            ""step-221"" => {""outcome"" => ""success""},
            ""step-222"" => {""outcome"" => ""success""},
            ""step-223"" => {""outcome"" => ""success""},
            ""step-224"" => {""outcome"" => ""success""},
            ""step-225"" => {""outcome"" => ""success""},
            ""step-226"" => {""outcome"" => ""success""},
            ""step-227"" => {""outcome"" => ""success""},
            ""step-228"" => {""outcome"" => ""success""},
            ""step-229"" => {""outcome"" => ""success""},
            ""step-230"" => {""outcome"" => ""success""},
            ""step-231"" => {""outcome"" => ""success""},
            ""step-232"" => {""outcome"" => ""success""},
            ""step-233"" => {""outcome"" => ""success""},
            ""step-234"" => {""outcome"" => ""success""},
            ""step-235"" => {""outcome"" => ""success""},
            ""step-236"" => {""outcome"" => ""success""},
            ""step-237"" => {""outcome"" => ""success""}
        },
        ""server-groups"" => undefined
    }
{code}

If the server is controlled by the master the response is normal.
Also, if the CLI connects directly to the slave (i.e. not routing through the master) the output is as shown above, so although the problem seems to only be for slaves it doesn't appear to be a result of how the master is processing the slaves response, since the master is not involved when the CLI directly connects to the slave.",2017/01/17 12:59 PM
WFCORE-2199,"If the server is unable to instantiate RuntimeVaultReader, which will be the case for the WildFly Core dist as it doesn't package the org.picketbox module needed by RuntimeVaultReader, then RuntimeExpressionResolver will ignore vault expressions, allowing the superclass to take over and process them. This will be done incorrectly, as the superclass will treat the first ':' in the vault expression as the delimiter between a system property name and the default value, resolving the expression to everything after that first ':'. So

{code}
${VAULT::datasources::password::123AB45CD}
{code}
resolves to
{code}
:datasources::password::123AB45CD
{code}

Minor as the resolved value is unlikely to be useful, so there will be a failure.

Possibly could be treated as an Enhancement.

Fix would be for RuntimeExpressionResolver to check for the vault expression pattern and throw NoSuchItemException if found and not VaultReader is available.",2017/01/16 3:04 PM
WFCORE-2182,"RuntimeVaultReader is throwing SecurityException if it catches a SecurityVaultException from PicketBoxSecurityVault. But the causes of those SecurityVaultException are not really security breaches, they just reflect failed searches, or, less likely, incorrect vault setup.

Converting these into SecurityException, which is a RuntimeException, means the vault lookup will fail the management op that triggered it in a way that overrides rollback-on-runtime-failure=false. But at least in the case of failed searches, this is no different than any other failed attempt to resolve an expression and should be treated as such.

Perhaps the type of the getCause() value from the SecurityVaultException can be used to discriminate behavior between failed searches and other issues, or perhaps the distinction can be ignored.

Here is an example of a failed search using EAP 6:

{code}
12:46:34,830 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 27) JBAS014612: Operation (""enable"") failed - address: ([
    (""subsystem"" => ""datasources""),
    (""data-source"" => ""xyzDS"")
]): java.lang.SecurityException: JBAS013311: Security Exception
        at org.jboss.as.security.vault.RuntimeVaultReader.retrieveFromVault(RuntimeVaultReader.java:115)
        at org.jboss.as.server.RuntimeExpressionResolver.resolvePluggableExpression(RuntimeExpressionResolver.java:45)
        at org.jboss.as.controller.ExpressionResolverImpl.resolveExpressionString(ExpressionResolverImpl.java:319) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.ExpressionResolverImpl.parseAndResolve(ExpressionResolverImpl.java:228) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.ExpressionResolverImpl.resolveExpressionStringRecursively(ExpressionResolverImpl.java:130) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.ExpressionResolverImpl.resolveExpressionsRecursively(ExpressionResolverImpl.java:72) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.ExpressionResolverImpl.resolveExpressions(ExpressionResolverImpl.java:54) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.ModelControllerImpl.resolveExpressions(ModelControllerImpl.java:782) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.OperationContextImpl.resolveExpressions(OperationContextImpl.java:1002) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.ParallelBootOperationContext.resolveExpressions(ParallelBootOperationContext.java:351) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.AttributeDefinition$1.resolveExpressions(AttributeDefinition.java:338) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.AttributeDefinition.resolveValue(AttributeDefinition.java:402) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.AttributeDefinition.resolveModelAttribute(AttributeDefinition.java:361) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.AttributeDefinition.resolveModelAttribute(AttributeDefinition.java:335) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.connector.util.ModelNodeUtil.getResolvedStringIfSetOrGetDefault(ModelNodeUtil.java:33)
        at org.jboss.as.connector.subsystems.datasources.DataSourceModelNodeUtil.from(DataSourceModelNodeUtil.java:151)
        at org.jboss.as.connector.subsystems.datasources.DataSourceEnable.addServices(DataSourceEnable.java:183)
        at org.jboss.as.connector.subsystems.datasources.DataSourceEnable$1.execute(DataSourceEnable.java:102)
        at org.jboss.as.controller.AbstractOperationContext.executeStep(AbstractOperationContext.java:708) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.AbstractOperationContext.doCompleteStep(AbstractOperationContext.java:543) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.AbstractOperationContext.completeStepInternal(AbstractOperationContext.java:338) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.AbstractOperationContext.executeOperation(AbstractOperationContext.java:314) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at org.jboss.as.controller.ParallelBootOperationStepHandler$ParallelBootTask.run(ParallelBootOperationStepHandler.java:355) [jboss-as-controller-7.5.11.Final-redhat-1.jar:7.5.11.Final-redhat-1]
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [rt.jar:1.8.0_111]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [rt.jar:1.8.0_111]
        at java.lang.Thread.run(Thread.java:745) [rt.jar:1.8.0_111]
        at org.jboss.threads.JBossThread.run(JBossThread.java:122) [jboss-threads-2.1.2.Final-redhat-1.jar:2.1.2.Final-redhat-1]
Caused by: org.jboss.security.vault.SecurityVaultException: java.lang.IllegalArgumentException: Null input buffer
        at org.picketbox.plugins.vault.PicketBoxSecurityVault.retrieve(PicketBoxSecurityVault.java:297)
        at org.jboss.as.security.vault.RuntimeVaultReader.getValue(RuntimeVaultReader.java:141)
        at org.jboss.as.security.vault.RuntimeVaultReader.getValueAsString(RuntimeVaultReader.java:123)
        at org.jboss.as.security.vault.RuntimeVaultReader.retrieveFromVault(RuntimeVaultReader.java:113)
        ... 26 more
Caused by: java.lang.IllegalArgumentException: Null input buffer
        at javax.crypto.Cipher.doFinal(Cipher.java:2161) [jce.jar:1.8.0_111]
        at org.picketbox.util.EncryptionUtil.decrypt(EncryptionUtil.java:134)
        at org.picketbox.plugins.vault.PicketBoxSecurityVault.retrieve(PicketBoxSecurityVault.java:293)
        ...
{code}",2017/01/11 7:52 PM
WFCORE-2382,"Doesn't work to define {EXT} command with parameters.
For {CMD} is everything OK.

*You can try it by this command (you must replace path to some real file).*
/subsystem=elytron/credential-store=CredStore011:add(uri=""cr-store://test/cs999.jceks"", credential-reference={type=COMMAND, clear-text=""{EXT}/real/path/to/script/pass-ely.sh par011""})


*Result is this error msg:*
{code}
{
    ""outcome"" => ""failed"",
    ""failure-description"" => {
        ""WFLYCTL0080: Failed services"" => {""org.wildfly.security.credential-store.CredStore011"" => ""org.jboss.msc.service.StartException in service org.wildfly.security.credential-store.CredStore011: WFLYELY00004: Unable to start the service.
    Caused by: java.io.IOException: Cannot run program \""/real/path/to/script/pass-ely.sh par011\"": error=2, No such file or directory
    Caused by: java.io.IOException: error=2, No such file or directory""},
        ""WFLYCTL0412: Required services that are not installed:"" => [""org.wildfly.security.credential-store.CredStore011""],
        ""WFLYCTL0180: Services with missing/unavailable dependencies"" => undefined
    },
    ""rolled-back"" => true
}
{code}",2017/01/11 8:59 AM
WFCORE-2175,"The following operation fails with a {{StringIndexOutOfBoundsException}}

{code}
/host=master/core-service=capability-registry:suggest-capabilities(name=org.wildfly.clustering.jgroups.channel-factory,dependent-address=[(""profile"" => ""full-ha""),(""subsystem"" => ""jgroups"")])
{code}

while similar operations work w/o an error

{code}
/host=master/core-service=capability-registry:suggest-capabilities(name=org.wildfly.batch.job.repository, dependent-address=[(""profile"" => ""full""),   (""subsystem"" => ""batch-jberet"")])
{code}

This is the code which throws the {{StringIndexOutOfBoundsException}}: https://github.com/wildfly/wildfly-core/blob/master/controller/src/main/java/org/jboss/as/controller/CapabilityRegistry.java#L946",2017/01/10 11:43 AM
WFCORE-2174,"AwaiterModelControllerClient can be used by third party, it shouldn't be in impl.
 ",2017/01/10 11:31 AM
WFCORE-2172,"VDX - pretty print gives different message on IBM JDK than on Oracle/OpenJDK for incorrect value of element or unexpected empty element

IBM JDK details:
java version ""1.8.0""
Java(TM) SE Runtime Environment (build pxa6480sr3fp20-20161019_02(SR3 FP20))
IBM J9 VM (build 2.8, JRE 1.8.0 Linux amd64-64 Compressed References 20161013_322271 (JIT enabled, AOT enabled)
J9VM - R28_Java8_SR3_20161013_1635_B322271
JIT  - tr.r14.java.green_20161011_125790
GC   - R28_Java8_SR3_20161013_1635_B322271_CMPRSS
J9CL - 20161013_322271)
JCL - 20161018_01 based on Oracle jdk8u111-b14

Testsuite: https://github.com/jboss-eap-qe/vdx-wildfly-testsuite
Jenkins job: https://jenkins.mw.lab.eng.bos.redhat.com/hudson/view/EAP7/view/EAP7-PrettyPrint/job/eap-7x-pretty-print-smoke-rhel-ibm/

Failing tests:
* JBossWSTestCase#incorrectValueOfModifyWsdlAddressElement
* JBossWSTestCase#modifyWsdlAddressElementWithNoValue
* 4x JBossWSDomainTestCase#modifyWsdlAddressElementWithNoValue*

Run one test for standalone: mvn -Djboss.home=/home/rsvoboda/TESTING/710DR10/jboss-eap-7.1 test -Dtest=$TEST
Run one test for domain: use ^^^ add -Ddomain 

Attached details from tests runs using Oracle and IBM JDK, executed JBossWSTestCase#incorrectValueOfModifyWsdlAddressElement and JBossWSTestCase#modifyWsdlAddressElementWithNoValue tests. -nodocs variants are when I removed docs directory (=> no VDX ) to see raw error messages.

*Preliminary conclusion:*
It seems that for Oracle JDK and OpenJDK VDX removes {{WFLYCTL0097:}} from the caused by error message, but for IBM JDK it is present in the message - e.g. '   ^^^^ ""WFLYCTL0097: Wrong type for 'modify-wsdl-address'. ...'. 
For IBM JDK the {{The primary underlying error message was:}} part is different than for Oracle case.

Lets use case for incorrectValueOfModifyWsdlAddressElement:
Oracle:
{code}
|  387:     <modify-wsdl-address>ttrue</modify-wsdl-address>
|                                ^^^^ Wrong type for 'modify-wsdl-address'. Expected [BOOLEAN] but was
|                                       STRING
|
|  388:   </subsystem>
|  389:   <subsystem xmlns=""urn:jboss:domain:weld:3.0""/>
|  390: </profile>
|
| The primary underlying error message was:
| > ParseError at [row,col]:[387,28]
| > Message: ""WFLYCTL0097: Wrong type for 'modify-wsdl-address'. Expected
| >   [BOOLEAN] but was STRING""
{code}

IBM:
{code}
|  387:     <modify-wsdl-address>ttrue</modify-wsdl-address>
|                                ^^^^ ""WFLYCTL0097: Wrong type for 'modify-wsdl-address'. Expected [BOOLEAN]
|                                       but was STRING""
|
|  388:   </subsystem>
|  389:   <subsystem xmlns=""urn:jboss:domain:weld:3.0""/>
|  390: </profile>
|
| The primary underlying error message was:
| > ""WFLYCTL0097: Wrong type for 'modify-wsdl-address'. Expected [BOOLEAN]
| > but was STRING""
{code}


When I disabled pretty print I got this:
Oracle:
{code}
08:56:10,894 ERROR [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0055: Caught exception during boot: org.jboss.as.controller.persistence.ConfigurationPersistenceException: WFLYCTL0085: Failed to parse configuration
	at org.jboss.as.controller.persistence.XmlConfigurationPersister.load(XmlConfigurationPersister.java:143) [wildfly-controller-3.0.0.Alpha17-redhat-1.jar:3.0.0.Alpha17-redhat-1]
	at org.jboss.as.server.ServerService.boot(ServerService.java:373) [wildfly-server-3.0.0.Alpha17-redhat-1.jar:3.0.0.Alpha17-redhat-1]
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:314) [wildfly-controller-3.0.0.Alpha17-redhat-1.jar:3.0.0.Alpha17-redhat-1]
	at java.lang.Thread.run(Thread.java:745) [rt.jar:1.8.0_91]
Caused by: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[387,28]
Message: ""WFLYCTL0097: Wrong type for 'modify-wsdl-address'. Expected [BOOLEAN] but was STRING""
{code}

IBM:
{code}
08:55:01,335 ERROR [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0055: Caught exception during boot: org.jboss.as.controller.persistence.ConfigurationPersistenceException: WFLYCTL0085: Failed to parse configuration
	at org.jboss.as.controller.persistence.XmlConfigurationPersister.load(XmlConfigurationPersister.java:143) [wildfly-controller-3.0.0.Alpha17-redhat-1.jar:3.0.0.Alpha17-redhat-1]
	at org.jboss.as.server.ServerService.boot(ServerService.java:373) [wildfly-server-3.0.0.Alpha17-redhat-1.jar:3.0.0.Alpha17-redhat-1]
	at org.jboss.as.controller.AbstractControllerService$1.run(AbstractControllerService.java:314) [wildfly-controller-3.0.0.Alpha17-redhat-1.jar:3.0.0.Alpha17-redhat-1]
	at java.lang.Thread.run(Thread.java:785) [vm.jar:1.8.0]
Caused by: javax.xml.stream.XMLStreamException: ""WFLYCTL0097: Wrong type for 'modify-wsdl-address'. Expected [BOOLEAN] but was STRING""
{code}









cc [~tcrawley]",2017/01/10 10:52 AM
WFCORE-2159,"In domain mode the following command assigns error message to values.

{code}
/profile=full-ha/subsystem=io/worker=default:read-resource(include-runtime)
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""io-threads"" => ""WFLYIO006: no metrics available"",
        ""stack-size"" => ""WFLYIO006: no metrics available"",
        ""task-keepalive"" => ""WFLYIO006: no metrics available"",
        ""task-max-threads"" => ""WFLYIO006: no metrics available"",
        ""server"" => undefined
    }
}
{code}

it should show configured values when it is executed on profile

Also, may be related
{code}
/subsystem=io/worker=test123:add(io-threads=11,stack-size=12,task-keepalive=13,task-max-threads=14)
{""outcome"" => ""success""}
[standalone@localhost:9990 /] /subsystem=io/worker=test123:read-resource
{
    ""outcome"" => ""success"",
    ""result"" => {
        ""io-threads"" => undefined,
        ""stack-size"" => undefined,
        ""task-keepalive"" => undefined,
        ""task-max-threads"" => undefined,
        ""server"" => undefined
    }
}
{code}
",2017/01/06 8:35 AM
WFCORE-2157," 21:24:18,013 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 56) WFLYCTL0190: Step
> handler org.jboss.as.server.deployment.DeploymentHandlerUtil$4@6f678cd for operation {""operation"" => ""full-replace-deployment"",""name"" =>
> ""drmk22.ear"",""enabled"" => true,""content"" => [{""hash"" => bytes { 0x40, 0xde, 0xe4, 0x1d, 0xdd, 0xd0, 0xa7, 0x9f, 0xa9, 0x7a, 0x92, 0x84,
> 0xee, 0x92, 0x81, 0xea, 0x5d, 0x7b, 0xa3, 0x2a }}],""operation-headers"" => {""access-mechanism"" => ""NATIVE"",""domain-uuid"" =>
> ""cf11aeb2-70b8-4f64-aa64-67fffd9c8080""},""address"" => [],""runtime-name"" => undefined,""persistent"" => true,""owner"" => undefined} at address []
> failed handling operation rollback -- java.util.NoSuchElementException: No child 'name' exists: java.util.NoSuchElementException: No child
> 'name' exists
>    at org.jboss.dmr.ModelValue.requireChild(ModelValue.java:387)
>    at org.jboss.dmr.ObjectModelValue.requireChild(ObjectModelValue.java:302)
>    at org.jboss.dmr.ModelNode.require(ModelNode.java:875)
>    at org.jboss.as.server.deployment.DeploymentHandlerUtil$4$1.handleResult(DeploymentHandlerUtil.java:331)
>    at org.jboss.as.controller.AbstractOperationContext$Step.invokeResultHandler(AbstractOperationContext.java:1435)
>   at org.jboss.as.controller.AbstractOperationContext$Step.handleResult(AbstractOperationContext.java:1417)
>    at org.jboss.as.controller.AbstractOperationContext$Step.finalizeInternal(AbstractOperationContext.java:1379)",2017/01/06 4:38 AM
WFCORE-2142,NoData,2017/01/02 7:34 AM
WFCORE-2123,"/deployment- is not properly completed for ls,cd,read-attribute and read-operation.
That is due to an invalid completer that does validate the content of the path when parsing it.
",2016/12/15 10:20 AM
WFCORE-2120,NoData,2016/12/14 5:38 AM
WFCORE-2118,"As part of EAP 7.1.0.DR9 and [EAP7-636] there was introduced possibility to define that start/reload/restart operation should end up in suspended mode instead of fully starting immediately.

In standalone mode this is controlled via {{start-mode}} parameter. In case of domain mode there are boolean attributes for each of the start options.

It would be nice to be consistent and also in domain use {{start-mode}} parameter (it can be limited to values making sense only in domain mode)",2016/12/13 7:23 PM
WFCORE-2112,"https://github.com/wildfly/wildfly-core/blob/master/network/src/main/java/org/jboss/as/network/ManagedServerSocketBinding.java#L86
https://github.com/wildfly/wildfly-core/blob/master/protocol/src/main/java/org/jboss/as/protocol/GeneralTimeoutHandler.java#L47

Volatile fields are not synchronized on update.

I think {{AtomicLong}} could be used instead of {{volatile long}} or update should be synchronized.",2016/12/13 6:24 AM
WFCORE-2111,"The javadoc for the copy of AtomicMapFieldUpdater used in core specifies that if putAtomic() returns a value, that the put did not succeed. The transformer and notification registries are full of code checking the return value like https://github.com/kabir/wildfly-core/blob/3396609db1eebf7af382133b7d22fa1828643895/controller/src/main/java/org/jboss/as/controller/registry/GlobalTransformerRegistry.java#L270 : 
{code}
    SubRegistry getOrCreate(final String key) {
        for (;;) {
            final Map<String, SubRegistry> subRegistries = subRegistriesUpdater.get(this);
            SubRegistry registry = subRegistries.get(key);
            if(registry == null) {
                registry = new SubRegistry();
                SubRegistry existing = subRegistriesUpdater.putAtomic(this, key, registry, subRegistries);
                if(existing == null) {
                    return registry;
                } else if (existing != registry) {
                    return existing; // Problematic
                }
            }
            return registry;
        }
    }
{code}
This calling code assumes that if 'existing' is returned and is not the same as the created 'registry' that the put succeeded, and it was added to 'existing'. However, this is not what happens, when 'existing' is returned, its value is actually the same as the 'subRegistries' snapshot, and no insertion has happened.

To clear up the confusion, make AtomicMapFieldUpdater return a boolean where 'true' is returned if the put succeeded, and 'false' when it did not. If 'false' is returned the caller needs to retry the put as implied today.",2016/12/13 4:55 AM
WFCORE-2096,"OperationContextImpl provides impls of ServiceTarget and ServiceBuilder to OSHs. It is valid for those OSHs to pass those (particularly the ServiceTarget) out to other code, e.g. DUPs, which will then use them as a kind of ""subsystem scoped"" target. As opposed, say, to a deployment scoped target that can be obtained from the DeploymentUnitService.

If this is done though, the target and builders continue to hold a ref to the state held by the OperationContext that created them. That state is no longer relevant once the management op is done and retaining a ref to it is a kind of memory leak. Any link back to the OC should be cleared from these objects when the operation is complete.",2016/12/08 11:56 AM
WFCORE-2094,"The HC should be aware if a managed server has a service container that cannot stabilize.

What it will do with this information can evolve over time, but it should at least log it.",2016/12/07 8:06 PM
WFCORE-2089,"Following exception (and probably similar too) will cause wildfly frozing during start. Visible especially during integration tests (which will never ends), but reproducible directly too (see steps).

{code:java}
15:59:37,252 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC000001: Failed to start service org.wildfly.security.security-realm.ManagementRealm: org.jboss.msc.service.StartException in service org.wildfly.security.security-realm.ManagementRealm: WFLYELY00025: Referenced property file is invalid: ELY01006: No realm name found in password property file
	at org.wildfly.extension.elytron.PropertiesRealmDefinition$1$1.get(PropertiesRealmDefinition.java:185)
	at org.wildfly.extension.elytron.PropertiesRealmDefinition$1$1.get(PropertiesRealmDefinition.java:164)
	at org.wildfly.extension.elytron.TrivialService.start(TrivialService.java:53)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1963)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1896)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
{code}

*Update:* This problem with infinite boot will occure everytime the start() method of some service throws StartException(). Not an Elytron problem.
",2016/12/06 10:07 AM
WFCORE-2080,"Currently WildFlyElytronProvider is created dynamicly when needed as it is created in supplier 
to SecurityProviderServerMechanismFactory

example of hot method profiling https://paste.fedoraproject.org/495618/69264714/raw/
which shows that currently provider can be created each time mgmt / remoting request is made",2016/12/02 10:47 AM
WFCORE-2055,"Once WFCORE-2053 is fixed, CoreResourceManagementTestCase.testCannotInvokeManagedSlaveServerOperationsInDomainComposite will fail. This test involves doing two ops in a composite, with the composite addressed to the domain root, while the steps are addressed to a subsystem on an individual server, where the server is managed by a slave HC. The first op is a read, the second is a write.

The op should fail as the write is not allowed.

Test is currently only passing because the WFCORE-2053 problem is producing false positives.",2016/11/28 1:03 PM
WFCORE-2053,"CoreResourceManagementTestCase was broken when it was moved from full to core. A number of tests are testing adds of /host=x/server=y/subsystem=io/worker=default:add but these tests are bogus:

1) The worker already exists in the profile used by the DC.
2) The params passed to the add op are bogus (leftovers from the 'full' test that tested the threads subsystem.

The tests are primarily checking for failures but these issues mean they can be falsely passing; passing due to failures unrelated to what the test is checking.",2016/11/28 12:43 PM
WFCORE-2049,NoData,2016/11/28 7:59 AM
WFCORE-2035,"Enabling RBAC on WildFly is causing authorization failures on reload and it remains in unusable state afterwards. It is not possible to use neither CLI or Web Console thus it is not possible to configure or control server in any way.

{noformat}
2016-11-22 14:43:27,256 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-5) MSC000001: Failed to start service jboss.txn.ArjunaTransactionManager: org.jboss.msc.service.StartException in service jboss.txn.ArjunaTransactionManager: WFLYTX0006: Failed to configure object store browser bean
	at org.jboss.as.txn.service.ArjunaTransactionManagerService.start(ArjunaTransactionManagerService.java:150)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1963)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1896)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: javax.management.JMRuntimeException: WFLYJMX0037: Unauthorized access
	at org.jboss.as.jmx.PluggableMBeanServerImpl.authorizeMBeanOperation(PluggableMBeanServerImpl.java:1211)
	at org.jboss.as.jmx.PluggableMBeanServerImpl.authorizeMBeanOperation(PluggableMBeanServerImpl.java:1197)
	at org.jboss.as.jmx.PluggableMBeanServerImpl.registerMBean(PluggableMBeanServerImpl.java:877)
	at com.arjuna.ats.arjuna.tools.osb.util.JMXServer.registerMBean(JMXServer.java:120)
	at com.arjuna.ats.arjuna.tools.osb.mbean.ObjStoreBrowser.start(ObjStoreBrowser.java:154)
	at org.jboss.as.txn.service.ArjunaTransactionManagerService.start(ArjunaTransactionManagerService.java:148)
	... 5 more
{noformat}

{noformat}
2016-11-22 14:43:27,396 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-7) MSC000001: Failed to start service jboss.ws.config: org.jboss.msc.service.StartException in service jboss.ws.config: javax.management.JMRuntimeException: WFLYJMX0037: Unauthorized access
	at org.jboss.as.webservices.service.ServerConfigService.start(ServerConfigService.java:73)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1963)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1896)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: javax.management.JMRuntimeException: WFLYJMX0037: Unauthorized access
	at org.jboss.as.jmx.PluggableMBeanServerImpl.authorizeMBeanOperation(PluggableMBeanServerImpl.java:1211)
	at org.jboss.as.jmx.PluggableMBeanServerImpl.authorizeMBeanOperation(PluggableMBeanServerImpl.java:1197)
	at org.jboss.as.jmx.PluggableMBeanServerImpl.registerMBean(PluggableMBeanServerImpl.java:877)
	at org.jboss.ws.common.management.AbstractServerConfig.create(AbstractServerConfig.java:343)
	at org.jboss.as.webservices.config.ServerConfigImpl.create(ServerConfigImpl.java:70)
	at org.jboss.as.webservices.service.ServerConfigService.start(ServerConfigService.java:70)
	... 5 more
{noformat}

{noformat}
2016-11-22 14:43:30,434 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-3) MSC000001: Failed to start service org.wildfly.clustering.infinispan.cache-container.web: org.jboss.msc.service.StartException in service org.wildfly.clustering.infinispan.cache-container.web: org.infinispan.commons.CacheException: Failure while registering mbeans
	at org.wildfly.clustering.service.FunctionalValueService.start(FunctionalValueService.java:69)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1963)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1896)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.infinispan.commons.CacheException: Failure while registering mbeans
	at org.infinispan.jmx.ComponentsJmxRegistration.registerMBeans(ComponentsJmxRegistration.java:67)
	at org.infinispan.jmx.AbstractJmxRegistration.registerMBeans(AbstractJmxRegistration.java:38)
	at org.infinispan.jmx.CacheManagerJmxRegistration.start(CacheManagerJmxRegistration.java:41)
	at org.infinispan.manager.DefaultCacheManager.start(DefaultCacheManager.java:657)
	at org.jboss.as.clustering.infinispan.subsystem.CacheContainerBuilder.lambda$build$3(CacheContainerBuilder.java:106)
	at org.wildfly.clustering.service.SuppliedValueService.lambda$new$0(SuppliedValueService.java:42)
	at org.wildfly.clustering.service.FunctionalValueService.start(FunctionalValueService.java:67)
	... 5 more
Caused by: javax.management.JMRuntimeException: WFLYJMX0037: Unauthorized access
	at org.jboss.as.jmx.PluggableMBeanServerImpl.authorizeMBeanOperation(PluggableMBeanServerImpl.java:1211)
	at org.jboss.as.jmx.PluggableMBeanServerImpl.authorizeMBeanOperation(PluggableMBeanServerImpl.java:1197)
	at org.jboss.as.jmx.PluggableMBeanServerImpl.isRegistered(PluggableMBeanServerImpl.java:784)
	at org.infinispan.jmx.JmxUtil.registerMBean(JmxUtil.java:66)
	at org.infinispan.jmx.ComponentsJmxRegistration.registerMBeans(ComponentsJmxRegistration.java:64)
	... 11 more
{noformat}",2016/11/23 7:18 AM
WFCORE-2026,"There is a discrepancy between how 0 is handled.

XSD
{noformat}
        <xs:attribute name=""source-port"" type=""xs:positiveInteger"" use=""optional"">
{noformat}
doesn't allow 0.

MODEL
{noformat}
            .setAllowExpression(true).setValidator(new IntRangeValidator(0, 65535, true, true))
{noformat}
allows 0.

IMPLEMENTATION

{noformat}
    public Integer getAbsoluteSourcePort() {
        if (this.sourcePort == null) {
            return null;
        }
        if (this.fixedSourcePort) {
            return this.sourcePort;
        }
        final int portOffset = this.socketBindingManager.getPortOffset();
        return this.sourcePort + portOffset;
    }
{noformat}
doesn't treat 0 at all, tests for null value only.


Example to reproduce e.g. with modcluster integration in core:

{noformat}
[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=proxy1:add(port=9090,host=127.0.0.1,source-port=0
{
    ""outcome"" => ""success"",
    ""response-headers"" => {""process-state"" => ""reload-required""}
}
[standalone@localhost:9990 /] /subsystem=modcluster/mod-cluster-config=configuration:write-attribute(name=proxies,value=[proxy1])
{
    ""outcome"" => ""success"",
    ""response-headers"" => {
        ""operation-requires-reload"" => true,
        ""process-state"" => ""reload-required""
    }
}
[standalone@localhost:9990 /] :reload
{
    ""outcome"" => ""success"",
    ""result"" => undefined
}
{noformat}

Starting server with 
{noformat}
-Djboss.socket.binding.port-offset=100
{noformat}

yields

{noformat}
20:15:40,471 ERROR [org.jboss.modcluster] (UndertowEventHandlerAdapter - 1) MODCLUSTER000043: Failed to send INFO command to localhost/127.0.0.1:9090: Permission denied (Bind failed)
{noformat}",2016/11/21 2:24 PM
WFCORE-2163,"In case when legacy security-realm for SSL is used together with Elytron authentication in HTTP management interface then server is not started.

I am using following configuration for HTTP management interface (see Steps to Reproduce for more details):
{code}
<http-interface http-authentication-factory=""management-http-authentication"" security-realm=""ManagementRealmHTTPS"">
    <http-upgrade enabled=""true"" sasl-authentication-factory=""management-sasl-authentication""/>
    <socket-binding http=""management-http"" https=""management-https""/>
</http-interface>
{code}

Server is not started and following errors occur in log:
{code}
ERROR [org.jboss.msc.service.fail] (MSC service thread 1-7) MSC000001: Failed to start service org.wildfly.management.http.extensible: org.jboss.msc.service.StartException in service org.wildfly.management.http.extensible: WFLYSRV0083: Failed to start the http-interface service
	at org.jboss.as.server.mgmt.UndertowHttpManagementService.start(UndertowHttpManagementService.java:330)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1963)
	at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1896)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: WFLYDMHTTP0015: No SecurityRealm or SSLContext has been provided.
	at org.jboss.as.domain.http.server.ManagementHttpServer.getSSLContext(ManagementHttpServer.java:225)
	at org.jboss.as.domain.http.server.ManagementHttpServer.create(ManagementHttpServer.java:254)
	at org.jboss.as.domain.http.server.ManagementHttpServer.access$2400(ManagementHttpServer.java:107)
	at org.jboss.as.domain.http.server.ManagementHttpServer$Builder.build(ManagementHttpServer.java:589)
	at org.jboss.as.server.mgmt.UndertowHttpManagementService.start(UndertowHttpManagementService.java:292)
	... 5 more
{code}
and 
{code}
ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""core-service"" => ""management""),
    (""management-interface"" => ""http-interface"")
]) - failure description: {
    ""WFLYCTL0080: Failed services"" => {""org.wildfly.management.http.extensible"" => ""org.jboss.msc.service.StartException in service org.wildfly.management.http.extensible: WFLYSRV0083: Failed to start the http-interface service
    Caused by: java.lang.IllegalStateException: WFLYDMHTTP0015: No SecurityRealm or SSLContext has been provided.""},
    ""WFLYCTL0412: Required services that are not installed:"" => [""org.wildfly.management.http.extensible""],
    ""WFLYCTL0180: Services with missing/unavailable dependencies"" => undefined
}
ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (""add"") failed - address: ([
    (""core-service"" => ""management""),
    (""management-interface"" => ""http-interface"")
]) - failure description: {
    ""WFLYCTL0080: Failed services"" => {""org.wildfly.management.http.extensible"" => ""org.jboss.msc.service.StartException in service org.wildfly.management.http.extensible: WFLYSRV0083: Failed to start the http-interface service
    Caused by: java.lang.IllegalStateException: WFLYDMHTTP0015: No SecurityRealm or SSLContext has been provided.""},
    ""WFLYCTL0412: Required services that are not installed:"" => [""org.wildfly.management.http.extensible""],
    ""WFLYCTL0180: Services with missing/unavailable dependencies"" => undefined
}
{code}

According to comments in EAP7-545 Analysis document [1], when security-realm and http-authentication-factory are specified but no ssl-context is used then it should lead to use legacy security-realm for SSL configuration and http-authentication-factory for authentication.

[1] https://docs.google.com/document/d/1LsS-CGUJSDwGcFUva0g-BF9ZIq0jwx__1e_oJiSEGwI/edit#",2016/11/21 10:48 AM
WFCORE-2022,"To reproduce, invoke:

{noformat}
/subsystem=undertow/server=*/http-listener=*:read-resource-description
{
    ""outcome"" => ""failed"",
    ""result"" => [],
    ""failure-description"" => ""WFLYCTL0030: No resource definition is registered for address [
    (\""subsystem\"" => \""undertow\""),
    (\""server\"" => \""*\"")
]"",
    ""rolled-back"" => true
}
{noformat}

The address is valid but the operation fails at org.jboss.as.controller.operations.global.GlobalOperationHandlers.RegistrationAddressResolver#executeMultiTargetChildren when checking the condition:

{noformat}
 if (path.getKey().equals(RUNNING_SERVER) && path.isWildcard() && newRemaining.size() > 0)
{noformat}

The check was added for WFCORE-948 but makes any multi target operation with a server resource fails (such as Undertow server or messaging-activemq server resources).
",2016/11/21 4:29 AM
